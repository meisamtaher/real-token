import{f as K0,r as Fs,h as ie,i as Kr,j as V0,w as Cl,k as Ol,m as gc,t as ga,o as F0,p as ea,q as B0,s as _i,D as G0,u as W0,N as X,v as J0,x as oc,y as Q0,V as Y0,R as X0,F as Sh,K as Z0,z as em,L as tm,A as Ch,$ as rm,B as im,C as Vs,Z as Oh,J as sm,X as nm,E as vc,_ as Rl,G as Dr,H as am,I as om,M as us,O as $t,U as tr,P as wi,Q as hr,S as cm,T as hs,W as Tl,Y as um,a0 as hm,a1 as lm,a2 as Al,a3 as fm,a4 as Nl,a5 as $l,a6 as ls,a7 as cc,a8 as oa,a9 as fs,aa as pm,ab as ca,ac as dm,ad as gm,ae as vm,af as ta,ag as ym,ah as mm,ai as Vo,aj as Rh,ak as wm,al as _m,am as bm,an as Th,ao as Em,ap as Im,aq as xm,ar as Pm,as as Sm,at as Cm,au as Om,av as Us,aw as Dl,ax as Fo,ay as Rm,az as Tm,aA as Am}from"./index-0aC6Xlgc.js";import{s as Bs,a as va,i as Ah,c as Nm,b as $m,f as yc,p as Dm,J as ni,d as mc,e as wc,g as _c,h as mi,j as si,k as Ks,l as Lm,m as qm,H as Ii}from"./http-EUccMvXZ.js";const zm=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Mm=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,jm=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Um(c,i){if(c==="__proto__"||c==="constructor"&&i&&typeof i=="object"&&"prototype"in i){Hm(c);return}return i}function Hm(c){console.warn(`[destr] Dropping "${c}" key to prevent prototype pollution.`)}function ra(c,i={}){if(typeof c!="string")return c;const r=c.trim();if(c[0]==='"'&&c.at(-1)==='"'&&!c.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!jm.test(c)){if(i.strict)throw new SyntaxError("[destr] Invalid JSON");return c}try{if(zm.test(c)||Mm.test(c)){if(i.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(c,Um)}return JSON.parse(c)}catch(n){if(i.strict)throw n;return c}}function km(c){return!c||typeof c.then!="function"?Promise.resolve(c):c}function Ut(c,...i){try{return km(c(...i))}catch(r){return Promise.reject(r)}}function Km(c){const i=typeof c;return c===null||i!=="object"&&i!=="function"}function Vm(c){const i=Object.getPrototypeOf(c);return!i||i.isPrototypeOf(Object)}function ua(c){if(Km(c))return String(c);if(Vm(c)||Array.isArray(c))return JSON.stringify(c);if(typeof c.toJSON=="function")return ua(c.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Ll(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const uc="base64:";function Fm(c){if(typeof c=="string")return c;Ll();const i=Buffer.from(c).toString("base64");return uc+i}function Bm(c){return typeof c!="string"||!c.startsWith(uc)?c:(Ll(),Buffer.from(c.slice(uc.length),"base64"))}function ur(c){return c?c.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Gm(...c){return ur(c.join(":"))}function ia(c){return c=ur(c),c?c+":":""}const Wm="memory",Jm=()=>{const c=new Map;return{name:Wm,options:{},hasItem(i){return c.has(i)},getItem(i){return c.get(i)??null},getItemRaw(i){return c.get(i)??null},setItem(i,r){c.set(i,r)},setItemRaw(i,r){c.set(i,r)},removeItem(i){c.delete(i)},getKeys(){return Array.from(c.keys())},clear(){c.clear()},dispose(){c.clear()}}};function Qm(c={}){const i={mounts:{"":c.driver||Jm()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=v=>{for(const E of i.mountpoints)if(v.startsWith(E))return{base:E,relativeKey:v.slice(E.length),driver:i.mounts[E]};return{base:"",relativeKey:v,driver:i.mounts[""]}},n=(v,E)=>i.mountpoints.filter(C=>C.startsWith(v)||E&&v.startsWith(C)).map(C=>({relativeBase:v.length>C.length?v.slice(C.length):void 0,mountpoint:C,driver:i.mounts[C]})),a=(v,E)=>{if(i.watching){E=ur(E);for(const C of i.watchListeners)C(v,E)}},l=async()=>{if(!i.watching){i.watching=!0;for(const v in i.mounts)i.unwatch[v]=await Nh(i.mounts[v],a,v)}},d=async()=>{if(i.watching){for(const v in i.unwatch)await i.unwatch[v]();i.unwatch={},i.watching=!1}},y=(v,E,C)=>{const T=new Map,j=D=>{let V=T.get(D.base);return V||(V={driver:D.driver,base:D.base,items:[]},T.set(D.base,V)),V};for(const D of v){const V=typeof D=="string",re=ur(V?D:D.key),ce=V?void 0:D.value,ue=V||!D.options?E:{...E,...D.options},he=r(re);j(he).items.push({key:re,value:ce,relativeKey:he.relativeKey,options:ue})}return Promise.all([...T.values()].map(D=>C(D))).then(D=>D.flat())},w={hasItem(v,E={}){v=ur(v);const{relativeKey:C,driver:T}=r(v);return Ut(T.hasItem,C,E)},getItem(v,E={}){v=ur(v);const{relativeKey:C,driver:T}=r(v);return Ut(T.getItem,C,E).then(j=>ra(j))},getItems(v,E){return y(v,E,C=>C.driver.getItems?Ut(C.driver.getItems,C.items.map(T=>({key:T.relativeKey,options:T.options})),E).then(T=>T.map(j=>({key:Gm(C.base,j.key),value:ra(j.value)}))):Promise.all(C.items.map(T=>Ut(C.driver.getItem,T.relativeKey,T.options).then(j=>({key:T.key,value:ra(j)})))))},getItemRaw(v,E={}){v=ur(v);const{relativeKey:C,driver:T}=r(v);return T.getItemRaw?Ut(T.getItemRaw,C,E):Ut(T.getItem,C,E).then(j=>Bm(j))},async setItem(v,E,C={}){if(E===void 0)return w.removeItem(v);v=ur(v);const{relativeKey:T,driver:j}=r(v);j.setItem&&(await Ut(j.setItem,T,ua(E),C),j.watch||a("update",v))},async setItems(v,E){await y(v,E,async C=>{C.driver.setItems&&await Ut(C.driver.setItems,C.items.map(T=>({key:T.relativeKey,value:ua(T.value),options:T.options})),E),C.driver.setItem&&await Promise.all(C.items.map(T=>Ut(C.driver.setItem,T.relativeKey,ua(T.value),T.options)))})},async setItemRaw(v,E,C={}){if(E===void 0)return w.removeItem(v,C);v=ur(v);const{relativeKey:T,driver:j}=r(v);if(j.setItemRaw)await Ut(j.setItemRaw,T,E,C);else if(j.setItem)await Ut(j.setItem,T,Fm(E),C);else return;j.watch||a("update",v)},async removeItem(v,E={}){typeof E=="boolean"&&(E={removeMeta:E}),v=ur(v);const{relativeKey:C,driver:T}=r(v);T.removeItem&&(await Ut(T.removeItem,C,E),(E.removeMeta||E.removeMata)&&await Ut(T.removeItem,C+"$",E),T.watch||a("remove",v))},async getMeta(v,E={}){typeof E=="boolean"&&(E={nativeOnly:E}),v=ur(v);const{relativeKey:C,driver:T}=r(v),j=Object.create(null);if(T.getMeta&&Object.assign(j,await Ut(T.getMeta,C,E)),!E.nativeOnly){const D=await Ut(T.getItem,C+"$",E).then(V=>ra(V));D&&typeof D=="object"&&(typeof D.atime=="string"&&(D.atime=new Date(D.atime)),typeof D.mtime=="string"&&(D.mtime=new Date(D.mtime)),Object.assign(j,D))}return j},setMeta(v,E,C={}){return this.setItem(v+"$",E,C)},removeMeta(v,E={}){return this.removeItem(v+"$",E)},async getKeys(v,E={}){v=ia(v);const C=n(v,!0);let T=[];const j=[];for(const D of C){const re=(await Ut(D.driver.getKeys,D.relativeBase,E)).map(ce=>D.mountpoint+ur(ce)).filter(ce=>!T.some(ue=>ce.startsWith(ue)));j.push(...re),T=[D.mountpoint,...T.filter(ce=>!ce.startsWith(D.mountpoint))]}return v?j.filter(D=>D.startsWith(v)&&!D.endsWith("$")):j.filter(D=>!D.endsWith("$"))},async clear(v,E={}){v=ia(v),await Promise.all(n(v,!1).map(async C=>{if(C.driver.clear)return Ut(C.driver.clear,C.relativeBase,E);if(C.driver.removeItem){const T=await C.driver.getKeys(C.relativeBase||"",E);return Promise.all(T.map(j=>C.driver.removeItem(j,E)))}}))},async dispose(){await Promise.all(Object.values(i.mounts).map(v=>$h(v)))},async watch(v){return await l(),i.watchListeners.push(v),async()=>{i.watchListeners=i.watchListeners.filter(E=>E!==v),i.watchListeners.length===0&&await d()}},async unwatch(){i.watchListeners=[],await d()},mount(v,E){if(v=ia(v),v&&i.mounts[v])throw new Error(`already mounted at ${v}`);return v&&(i.mountpoints.push(v),i.mountpoints.sort((C,T)=>T.length-C.length)),i.mounts[v]=E,i.watching&&Promise.resolve(Nh(E,a,v)).then(C=>{i.unwatch[v]=C}).catch(console.error),w},async unmount(v,E=!0){v=ia(v),!(!v||!i.mounts[v])&&(i.watching&&v in i.unwatch&&(i.unwatch[v](),delete i.unwatch[v]),E&&await $h(i.mounts[v]),i.mountpoints=i.mountpoints.filter(C=>C!==v),delete i.mounts[v])},getMount(v=""){v=ur(v)+":";const E=r(v);return{driver:E.driver,base:E.base}},getMounts(v="",E={}){return v=ur(v),n(v,E.parents).map(T=>({driver:T.driver,base:T.mountpoint}))}};return w}function Nh(c,i,r){return c.watch?c.watch((n,a)=>i(n,r+a)):()=>{}}async function $h(c){typeof c.dispose=="function"&&await Ut(c.dispose)}function Ui(c){return new Promise((i,r)=>{c.oncomplete=c.onsuccess=()=>i(c.result),c.onabort=c.onerror=()=>r(c.error)})}function ql(c,i){const r=indexedDB.open(c);r.onupgradeneeded=()=>r.result.createObjectStore(i);const n=Ui(r);return(a,l)=>n.then(d=>l(d.transaction(i,a).objectStore(i)))}let Bo;function Gs(){return Bo||(Bo=ql("keyval-store","keyval")),Bo}function Dh(c,i=Gs()){return i("readonly",r=>Ui(r.get(c)))}function Ym(c,i,r=Gs()){return r("readwrite",n=>(n.put(i,c),Ui(n.transaction)))}function Xm(c,i=Gs()){return i("readwrite",r=>(r.delete(c),Ui(r.transaction)))}function Zm(c=Gs()){return c("readwrite",i=>(i.clear(),Ui(i.transaction)))}function ew(c,i){return c.openCursor().onsuccess=function(){this.result&&(i(this.result),this.result.continue())},Ui(c.transaction)}function tw(c=Gs()){return c("readonly",i=>{if(i.getAllKeys)return Ui(i.getAllKeys());const r=[];return ew(i,n=>r.push(n.key)).then(()=>r)})}const rw="idb-keyval";var iw=(c={})=>{const i=c.base&&c.base.length>0?`${c.base}:`:"",r=a=>i+a;let n;return c.dbName&&c.storeName&&(n=ql(c.dbName,c.storeName)),{name:rw,options:c,async hasItem(a){return!(typeof await Dh(r(a),n)>"u")},async getItem(a){return await Dh(r(a),n)??null},setItem(a,l){return Ym(r(a),l,n)},removeItem(a){return Xm(r(a),n)},getKeys(){return tw(n)},clear(){return Zm(n)}}};const sw="WALLET_CONNECT_V2_INDEXED_DB",nw="keyvaluestorage";let aw=class{constructor(){this.indexedDb=Qm({driver:iw({dbName:sw,storeName:nw})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(i=>[i.key,i.value])}async getItem(i){const r=await this.indexedDb.getItem(i);if(r!==null)return r}async setItem(i,r){await this.indexedDb.setItem(i,Bs(r))}async removeItem(i){await this.indexedDb.removeItem(i)}};var Go=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ha={exports:{}};(function(){let c;function i(){}c=i,c.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},c.prototype.setItem=function(r,n){this[r]=String(n)},c.prototype.removeItem=function(r){delete this[r]},c.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},c.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},c.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Go<"u"&&Go.localStorage?ha.exports=Go.localStorage:typeof window<"u"&&window.localStorage?ha.exports=window.localStorage:ha.exports=new i})();function ow(c){var i;return[c[0],va((i=c[1])!=null?i:"")]}let cw=class{constructor(){this.localStorage=ha.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(ow)}async getItem(i){const r=this.localStorage.getItem(i);if(r!==null)return va(r)}async setItem(i,r){this.localStorage.setItem(i,Bs(r))}async removeItem(i){this.localStorage.removeItem(i)}};const uw="wc_storage_version",Lh=1,hw=async(c,i,r)=>{const n=uw,a=await i.getItem(n);if(a&&a>=Lh){r(i);return}const l=await c.getKeys();if(!l.length){r(i);return}const d=[];for(;l.length;){const y=l.shift();if(!y)continue;const w=y.toLowerCase();if(w.includes("wc@")||w.includes("walletconnect")||w.includes("wc_")||w.includes("wallet_connect")){const v=await c.getItem(y);await i.setItem(y,v),d.push(y)}}await i.setItem(n,Lh),r(i),lw(c,d)},lw=async(c,i)=>{i.length&&i.forEach(async r=>{await c.removeItem(r)})};let fw=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const i=new cw;this.storage=i;try{const r=new aw;hw(i,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(i){return await this.initialize(),this.storage.getItem(i)}async setItem(i,r){return await this.initialize(),this.storage.setItem(i,r)}async removeItem(i){return await this.initialize(),this.storage.removeItem(i)}async initialize(){this.initialized||await new Promise(i=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),i())},20)})}};var ps={},$s={},Wo={},Ds={};class Hi{}const pw=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Hi},Symbol.toStringTag,{value:"Module"})),dw=K0(pw);var qh;function gw(){if(qh)return Ds;qh=1,Object.defineProperty(Ds,"__esModule",{value:!0}),Ds.IHeartBeat=void 0;const c=dw;class i extends c.IEvents{constructor(n){super()}}return Ds.IHeartBeat=i,Ds}var zh;function zl(){return zh||(zh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),Fs.__exportStar(gw(),c)}(Wo)),Wo}var Jo={},Mi={},Mh;function vw(){if(Mh)return Mi;Mh=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.HEARTBEAT_EVENTS=Mi.HEARTBEAT_INTERVAL=void 0;const c=ie;return Mi.HEARTBEAT_INTERVAL=c.FIVE_SECONDS,Mi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Mi}var jh;function Ml(){return jh||(jh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),Fs.__exportStar(vw(),c)}(Jo)),Jo}var Uh;function yw(){if(Uh)return $s;Uh=1,Object.defineProperty($s,"__esModule",{value:!0}),$s.HeartBeat=void 0;const c=Fs,i=Kr,r=ie,n=zl(),a=Ml();class l extends n.IHeartBeat{constructor(y){super(y),this.events=new i.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(y==null?void 0:y.interval)||a.HEARTBEAT_INTERVAL}static init(y){return c.__awaiter(this,void 0,void 0,function*(){const w=new l(y);return yield w.init(),w})}init(){return c.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(y,w){this.events.on(y,w)}once(y,w){this.events.once(y,w)}off(y,w){this.events.off(y,w)}removeListener(y,w){this.events.removeListener(y,w)}initialize(){return c.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return $s.HeartBeat=l,$s}(function(c){Object.defineProperty(c,"__esModule",{value:!0});const i=Fs;i.__exportStar(yw(),c),i.__exportStar(zl(),c),i.__exportStar(Ml(),c)})(ps);var Oe={},Qo,Hh;function mw(){if(Hh)return Qo;Hh=1;function c(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Qo=i;function i(r,n,a){var l=a&&a.stringify||c,d=1;if(typeof r=="object"&&r!==null){var y=n.length+d;if(y===1)return r;var w=new Array(y);w[0]=l(r);for(var v=1;v<y;v++)w[v]=l(n[v]);return w.join(" ")}if(typeof r!="string")return r;var E=n.length;if(E===0)return r;for(var C="",T=1-d,j=-1,D=r&&r.length||0,V=0;V<D;){if(r.charCodeAt(V)===37&&V+1<D){switch(j=j>-1?j:0,r.charCodeAt(V+1)){case 100:case 102:if(T>=E||n[T]==null)break;j<V&&(C+=r.slice(j,V)),C+=Number(n[T]),j=V+2,V++;break;case 105:if(T>=E||n[T]==null)break;j<V&&(C+=r.slice(j,V)),C+=Math.floor(Number(n[T])),j=V+2,V++;break;case 79:case 111:case 106:if(T>=E||n[T]===void 0)break;j<V&&(C+=r.slice(j,V));var re=typeof n[T];if(re==="string"){C+="'"+n[T]+"'",j=V+2,V++;break}if(re==="function"){C+=n[T].name||"<anonymous>",j=V+2,V++;break}C+=l(n[T]),j=V+2,V++;break;case 115:if(T>=E)break;j<V&&(C+=r.slice(j,V)),C+=String(n[T]),j=V+2,V++;break;case 37:j<V&&(C+=r.slice(j,V)),C+="%",j=V+2,V++,T--;break}++T}++V}return j===-1?r:(j<D&&(C+=r.slice(j)),C)}return Qo}var Yo,kh;function ww(){if(kh)return Yo;kh=1;const c=mw();Yo=a;const i=pe().console||{},r={mapHttpRequest:D,mapHttpResponse:D,wrapRequestSerializer:V,wrapResponseSerializer:V,wrapErrorSerializer:V,req:D,res:D,err:T};function n($,k){return Array.isArray($)?$.filter(function(ve){return ve!=="!stdSerializers.err"}):$===!0?Object.keys(k):!1}function a($){$=$||{},$.browser=$.browser||{};const k=$.browser.transmit;if(k&&typeof k.send!="function")throw Error("pino: transmit option must have a send function");const W=$.browser.write||i;$.browser.write&&($.browser.asObject=!0);const ve=$.serializers||{},te=n($.browser.serialize,ve);let Ee=$.browser.serialize;Array.isArray($.browser.serialize)&&$.browser.serialize.indexOf("!stdSerializers.err")>-1&&(Ee=!1);const Re=["error","fatal","warn","info","debug","trace"];typeof W=="function"&&(W.error=W.fatal=W.warn=W.info=W.debug=W.trace=W),$.enabled===!1&&($.level="silent");const et=$.level||"info",R=Object.create(W);R.log||(R.log=re),Object.defineProperty(R,"levelVal",{get:je}),Object.defineProperty(R,"level",{get:Te,set:J});const M={transmit:k,serialize:te,asObject:$.browser.asObject,levels:Re,timestamp:j($)};R.levels=a.levels,R.level=et,R.setMaxListeners=R.getMaxListeners=R.emit=R.addListener=R.on=R.prependListener=R.once=R.prependOnceListener=R.removeListener=R.removeAllListeners=R.listeners=R.listenerCount=R.eventNames=R.write=R.flush=re,R.serializers=ve,R._serialize=te,R._stdErrSerialize=Ee,R.child=F,k&&(R._logEvent=C());function je(){return this.level==="silent"?1/0:this.levels.values[this.level]}function Te(){return this._level}function J(K){if(K!=="silent"&&!this.levels.values[K])throw Error("unknown level "+K);this._level=K,l(M,R,"error","log"),l(M,R,"fatal","error"),l(M,R,"warn","error"),l(M,R,"info","log"),l(M,R,"debug","log"),l(M,R,"trace","log")}function F(K,B){if(!K)throw new Error("missing bindings for child Pino");B=B||{},te&&K.serializers&&(B.serializers=K.serializers);const ut=B.serializers;if(te&&ut){var ke=Object.assign({},ve,ut),Lr=$.browser.serialize===!0?Object.keys(ke):te;delete K.serializers,w([K],Lr,ke,this._stdErrSerialize)}function _e(It){this._childLevel=(It._childLevel|0)+1,this.error=v(It,K,"error"),this.fatal=v(It,K,"fatal"),this.warn=v(It,K,"warn"),this.info=v(It,K,"info"),this.debug=v(It,K,"debug"),this.trace=v(It,K,"trace"),ke&&(this.serializers=ke,this._serialize=Lr),k&&(this._logEvent=C([].concat(It._logEvent.bindings,K)))}return _e.prototype=this,new _e(this)}return R}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:ce,epochTime:ue,unixTime:he,isoTime:fe});function l($,k,W,ve){const te=Object.getPrototypeOf(k);k[W]=k.levelVal>k.levels.values[W]?re:te[W]?te[W]:i[W]||i[ve]||re,d($,k,W)}function d($,k,W){!$.transmit&&k[W]===re||(k[W]=function(ve){return function(){const Ee=$.timestamp(),Re=new Array(arguments.length),et=Object.getPrototypeOf&&Object.getPrototypeOf(this)===i?i:this;for(var R=0;R<Re.length;R++)Re[R]=arguments[R];if($.serialize&&!$.asObject&&w(Re,this._serialize,this.serializers,this._stdErrSerialize),$.asObject?ve.call(et,y(this,W,Re,Ee)):ve.apply(et,Re),$.transmit){const M=$.transmit.level||k.level,je=a.levels.values[M],Te=a.levels.values[W];if(Te<je)return;E(this,{ts:Ee,methodLevel:W,methodValue:Te,transmitLevel:M,transmitValue:a.levels.values[$.transmit.level||k.level],send:$.transmit.send,val:k.levelVal},Re)}}}(k[W]))}function y($,k,W,ve){$._serialize&&w(W,$._serialize,$.serializers,$._stdErrSerialize);const te=W.slice();let Ee=te[0];const Re={};ve&&(Re.time=ve),Re.level=a.levels.values[k];let et=($._childLevel|0)+1;if(et<1&&(et=1),Ee!==null&&typeof Ee=="object"){for(;et--&&typeof te[0]=="object";)Object.assign(Re,te.shift());Ee=te.length?c(te.shift(),te):void 0}else typeof Ee=="string"&&(Ee=c(te.shift(),te));return Ee!==void 0&&(Re.msg=Ee),Re}function w($,k,W,ve){for(const te in $)if(ve&&$[te]instanceof Error)$[te]=a.stdSerializers.err($[te]);else if(typeof $[te]=="object"&&!Array.isArray($[te]))for(const Ee in $[te])k&&k.indexOf(Ee)>-1&&Ee in W&&($[te][Ee]=W[Ee]($[te][Ee]))}function v($,k,W){return function(){const ve=new Array(1+arguments.length);ve[0]=k;for(var te=1;te<ve.length;te++)ve[te]=arguments[te-1];return $[W].apply(this,ve)}}function E($,k,W){const ve=k.send,te=k.ts,Ee=k.methodLevel,Re=k.methodValue,et=k.val,R=$._logEvent.bindings;w(W,$._serialize||Object.keys($.serializers),$.serializers,$._stdErrSerialize===void 0?!0:$._stdErrSerialize),$._logEvent.ts=te,$._logEvent.messages=W.filter(function(M){return R.indexOf(M)===-1}),$._logEvent.level.label=Ee,$._logEvent.level.value=Re,ve(Ee,$._logEvent,et),$._logEvent=C(R)}function C($){return{ts:0,messages:[],bindings:$||[],level:{label:"",value:0}}}function T($){const k={type:$.constructor.name,msg:$.message,stack:$.stack};for(const W in $)k[W]===void 0&&(k[W]=$[W]);return k}function j($){return typeof $.timestamp=="function"?$.timestamp:$.timestamp===!1?ce:ue}function D(){return{}}function V($){return $}function re(){}function ce(){return!1}function ue(){return Date.now()}function he(){return Math.round(Date.now()/1e3)}function fe(){return new Date(Date.now()).toISOString()}function pe(){function $(k){return typeof k<"u"&&k}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return $(self)||$(window)||$(this)||{}}}return Yo}var ji={},Kh;function jl(){return Kh||(Kh=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.PINO_CUSTOM_CONTEXT_KEY=ji.PINO_LOGGER_DEFAULTS=void 0,ji.PINO_LOGGER_DEFAULTS={level:"info"},ji.PINO_CUSTOM_CONTEXT_KEY="custom_context"),ji}var er={},Vh;function _w(){if(Vh)return er;Vh=1,Object.defineProperty(er,"__esModule",{value:!0}),er.generateChildLogger=er.formatChildLoggerContext=er.getLoggerContext=er.setBrowserLoggerContext=er.getBrowserLoggerContext=er.getDefaultLoggerOptions=void 0;const c=jl();function i(y){return Object.assign(Object.assign({},y),{level:(y==null?void 0:y.level)||c.PINO_LOGGER_DEFAULTS.level})}er.getDefaultLoggerOptions=i;function r(y,w=c.PINO_CUSTOM_CONTEXT_KEY){return y[w]||""}er.getBrowserLoggerContext=r;function n(y,w,v=c.PINO_CUSTOM_CONTEXT_KEY){return y[v]=w,y}er.setBrowserLoggerContext=n;function a(y,w=c.PINO_CUSTOM_CONTEXT_KEY){let v="";return typeof y.bindings>"u"?v=r(y,w):v=y.bindings().context||"",v}er.getLoggerContext=a;function l(y,w,v=c.PINO_CUSTOM_CONTEXT_KEY){const E=a(y,v);return E.trim()?`${E}/${w}`:w}er.formatChildLoggerContext=l;function d(y,w,v=c.PINO_CUSTOM_CONTEXT_KEY){const E=l(y,w,v),C=y.child({context:E});return n(C,E,v)}return er.generateChildLogger=d,er}(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.pino=void 0;const i=Fs,r=i.__importDefault(ww());Object.defineProperty(c,"pino",{enumerable:!0,get:function(){return r.default}}),i.__exportStar(jl(),c),i.__exportStar(_w(),c)})(Oe);class bw extends Hi{constructor(i){super(),this.opts=i,this.protocol="wc",this.version=2}}class Ew extends Hi{constructor(i,r){super(),this.core=i,this.logger=r,this.records=new Map}}class Iw{constructor(i,r){this.logger=i,this.core=r}}let xw=class extends Hi{constructor(i,r){super(),this.relayer=i,this.logger=r}},Pw=class extends Hi{constructor(i){super()}},Sw=class{constructor(i,r,n,a){this.core=i,this.logger=r,this.name=n}};class Cw extends Hi{constructor(i,r){super(),this.relayer=i,this.logger=r}}let Ow=class extends Hi{constructor(i,r){super(),this.core=i,this.logger=r}},Rw=class{constructor(i,r){this.projectId=i,this.logger=r}},Tw=class{constructor(i){this.opts=i,this.protocol="wc",this.version=2}},Aw=class{constructor(i){this.client=i}};var bc={},Ul={};(function(c){Object.defineProperty(c,"__esModule",{value:!0});var i=V0,r=Cl;c.DIGEST_LENGTH=64,c.BLOCK_SIZE=128;var n=function(){function y(){this.digestLength=c.DIGEST_LENGTH,this.blockSize=c.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return y.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},y.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},y.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},y.prototype.update=function(w,v){if(v===void 0&&(v=w.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var E=0;if(this._bytesHashed+=v,this._bufferLength>0){for(;this._bufferLength<c.BLOCK_SIZE&&v>0;)this._buffer[this._bufferLength++]=w[E++],v--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(v>=this.blockSize&&(E=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,w,E,v),v%=this.blockSize);v>0;)this._buffer[this._bufferLength++]=w[E++],v--;return this},y.prototype.finish=function(w){if(!this._finished){var v=this._bytesHashed,E=this._bufferLength,C=v/536870912|0,T=v<<3,j=v%128<112?128:256;this._buffer[E]=128;for(var D=E+1;D<j-8;D++)this._buffer[D]=0;i.writeUint32BE(C,this._buffer,j-8),i.writeUint32BE(T,this._buffer,j-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,j),this._finished=!0}for(var D=0;D<this.digestLength/8;D++)i.writeUint32BE(this._stateHi[D],w,D*8),i.writeUint32BE(this._stateLo[D],w,D*8+4);return this},y.prototype.digest=function(){var w=new Uint8Array(this.digestLength);return this.finish(w),w},y.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},y.prototype.restoreState=function(w){return this._stateHi.set(w.stateHi),this._stateLo.set(w.stateLo),this._bufferLength=w.bufferLength,w.buffer&&this._buffer.set(w.buffer),this._bytesHashed=w.bytesHashed,this._finished=!1,this},y.prototype.cleanSavedState=function(w){r.wipe(w.stateHi),r.wipe(w.stateLo),w.buffer&&r.wipe(w.buffer),w.bufferLength=0,w.bytesHashed=0},y}();c.SHA512=n;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(y,w,v,E,C,T,j){for(var D=v[0],V=v[1],re=v[2],ce=v[3],ue=v[4],he=v[5],fe=v[6],pe=v[7],$=E[0],k=E[1],W=E[2],ve=E[3],te=E[4],Ee=E[5],Re=E[6],et=E[7],R,M,je,Te,J,F,K,B;j>=128;){for(var ut=0;ut<16;ut++){var ke=8*ut+T;y[ut]=i.readUint32BE(C,ke),w[ut]=i.readUint32BE(C,ke+4)}for(var ut=0;ut<80;ut++){var Lr=D,_e=V,It=re,N=ce,A=ue,S=he,u=fe,b=pe,Z=$,oe=k,me=W,Ae=ve,$e=te,xe=Ee,xt=Re,mt=et;if(R=pe,M=et,J=M&65535,F=M>>>16,K=R&65535,B=R>>>16,R=(ue>>>14|te<<18)^(ue>>>18|te<<14)^(te>>>9|ue<<23),M=(te>>>14|ue<<18)^(te>>>18|ue<<14)^(ue>>>9|te<<23),J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,R=ue&he^~ue&fe,M=te&Ee^~te&Re,J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,R=a[ut*2],M=a[ut*2+1],J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,R=y[ut%16],M=w[ut%16],J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,je=K&65535|B<<16,Te=J&65535|F<<16,R=je,M=Te,J=M&65535,F=M>>>16,K=R&65535,B=R>>>16,R=(D>>>28|$<<4)^($>>>2|D<<30)^($>>>7|D<<25),M=($>>>28|D<<4)^(D>>>2|$<<30)^(D>>>7|$<<25),J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,R=D&V^D&re^V&re,M=$&k^$&W^k&W,J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,b=K&65535|B<<16,mt=J&65535|F<<16,R=N,M=Ae,J=M&65535,F=M>>>16,K=R&65535,B=R>>>16,R=je,M=Te,J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,N=K&65535|B<<16,Ae=J&65535|F<<16,V=Lr,re=_e,ce=It,ue=N,he=A,fe=S,pe=u,D=b,k=Z,W=oe,ve=me,te=Ae,Ee=$e,Re=xe,et=xt,$=mt,ut%16===15)for(var ke=0;ke<16;ke++)R=y[ke],M=w[ke],J=M&65535,F=M>>>16,K=R&65535,B=R>>>16,R=y[(ke+9)%16],M=w[(ke+9)%16],J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,je=y[(ke+1)%16],Te=w[(ke+1)%16],R=(je>>>1|Te<<31)^(je>>>8|Te<<24)^je>>>7,M=(Te>>>1|je<<31)^(Te>>>8|je<<24)^(Te>>>7|je<<25),J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,je=y[(ke+14)%16],Te=w[(ke+14)%16],R=(je>>>19|Te<<13)^(Te>>>29|je<<3)^je>>>6,M=(Te>>>19|je<<13)^(je>>>29|Te<<3)^(Te>>>6|je<<26),J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,y[ke]=K&65535|B<<16,w[ke]=J&65535|F<<16}R=D,M=$,J=M&65535,F=M>>>16,K=R&65535,B=R>>>16,R=v[0],M=E[0],J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,v[0]=D=K&65535|B<<16,E[0]=$=J&65535|F<<16,R=V,M=k,J=M&65535,F=M>>>16,K=R&65535,B=R>>>16,R=v[1],M=E[1],J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,v[1]=V=K&65535|B<<16,E[1]=k=J&65535|F<<16,R=re,M=W,J=M&65535,F=M>>>16,K=R&65535,B=R>>>16,R=v[2],M=E[2],J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,v[2]=re=K&65535|B<<16,E[2]=W=J&65535|F<<16,R=ce,M=ve,J=M&65535,F=M>>>16,K=R&65535,B=R>>>16,R=v[3],M=E[3],J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,v[3]=ce=K&65535|B<<16,E[3]=ve=J&65535|F<<16,R=ue,M=te,J=M&65535,F=M>>>16,K=R&65535,B=R>>>16,R=v[4],M=E[4],J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,v[4]=ue=K&65535|B<<16,E[4]=te=J&65535|F<<16,R=he,M=Ee,J=M&65535,F=M>>>16,K=R&65535,B=R>>>16,R=v[5],M=E[5],J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,v[5]=he=K&65535|B<<16,E[5]=Ee=J&65535|F<<16,R=fe,M=Re,J=M&65535,F=M>>>16,K=R&65535,B=R>>>16,R=v[6],M=E[6],J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,v[6]=fe=K&65535|B<<16,E[6]=Re=J&65535|F<<16,R=pe,M=et,J=M&65535,F=M>>>16,K=R&65535,B=R>>>16,R=v[7],M=E[7],J+=M&65535,F+=M>>>16,K+=R&65535,B+=R>>>16,F+=J>>>16,K+=F>>>16,B+=K>>>16,v[7]=pe=K&65535|B<<16,E[7]=et=J&65535|F<<16,T+=128,j-=128}return T}function d(y){var w=new n;w.update(y);var v=w.digest();return w.clean(),v}c.hash=d})(Ul);(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.convertSecretKeyToX25519=c.convertPublicKeyToX25519=c.verify=c.sign=c.extractPublicKeyFromSecretKey=c.generateKeyPair=c.generateKeyPairFromSeed=c.SEED_LENGTH=c.SECRET_KEY_LENGTH=c.PUBLIC_KEY_LENGTH=c.SIGNATURE_LENGTH=void 0;const i=Ol,r=Ul,n=Cl;c.SIGNATURE_LENGTH=64,c.PUBLIC_KEY_LENGTH=32,c.SECRET_KEY_LENGTH=64,c.SEED_LENGTH=32;function a(N){const A=new Float64Array(16);if(N)for(let S=0;S<N.length;S++)A[S]=N[S];return A}const l=new Uint8Array(32);l[0]=9;const d=a(),y=a([1]),w=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),v=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),E=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),C=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),T=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function j(N,A){for(let S=0;S<16;S++)N[S]=A[S]|0}function D(N){let A=1;for(let S=0;S<16;S++){let u=N[S]+A+65535;A=Math.floor(u/65536),N[S]=u-A*65536}N[0]+=A-1+37*(A-1)}function V(N,A,S){const u=~(S-1);for(let b=0;b<16;b++){const Z=u&(N[b]^A[b]);N[b]^=Z,A[b]^=Z}}function re(N,A){const S=a(),u=a();for(let b=0;b<16;b++)u[b]=A[b];D(u),D(u),D(u);for(let b=0;b<2;b++){S[0]=u[0]-65517;for(let oe=1;oe<15;oe++)S[oe]=u[oe]-65535-(S[oe-1]>>16&1),S[oe-1]&=65535;S[15]=u[15]-32767-(S[14]>>16&1);const Z=S[15]>>16&1;S[14]&=65535,V(u,S,1-Z)}for(let b=0;b<16;b++)N[2*b]=u[b]&255,N[2*b+1]=u[b]>>8}function ce(N,A){let S=0;for(let u=0;u<32;u++)S|=N[u]^A[u];return(1&S-1>>>8)-1}function ue(N,A){const S=new Uint8Array(32),u=new Uint8Array(32);return re(S,N),re(u,A),ce(S,u)}function he(N){const A=new Uint8Array(32);return re(A,N),A[0]&1}function fe(N,A){for(let S=0;S<16;S++)N[S]=A[2*S]+(A[2*S+1]<<8);N[15]&=32767}function pe(N,A,S){for(let u=0;u<16;u++)N[u]=A[u]+S[u]}function $(N,A,S){for(let u=0;u<16;u++)N[u]=A[u]-S[u]}function k(N,A,S){let u,b,Z=0,oe=0,me=0,Ae=0,$e=0,xe=0,xt=0,mt=0,nt=0,Le=0,Je=0,Qe=0,at=0,Ue=0,Ye=0,Ne=0,Ke=0,ht=0,ze=0,Pt=0,Dt=0,Ht=0,kt=0,zt=0,Wt=0,rr=0,qr=0,Jt=0,Vr=0,oi=0,xi=0,lt=S[0],tt=S[1],ft=S[2],pt=S[3],ot=S[4],rt=S[5],St=S[6],Ct=S[7],dt=S[8],Ot=S[9],gt=S[10],wt=S[11],vt=S[12],We=S[13],Rt=S[14],Tt=S[15];u=A[0],Z+=u*lt,oe+=u*tt,me+=u*ft,Ae+=u*pt,$e+=u*ot,xe+=u*rt,xt+=u*St,mt+=u*Ct,nt+=u*dt,Le+=u*Ot,Je+=u*gt,Qe+=u*wt,at+=u*vt,Ue+=u*We,Ye+=u*Rt,Ne+=u*Tt,u=A[1],oe+=u*lt,me+=u*tt,Ae+=u*ft,$e+=u*pt,xe+=u*ot,xt+=u*rt,mt+=u*St,nt+=u*Ct,Le+=u*dt,Je+=u*Ot,Qe+=u*gt,at+=u*wt,Ue+=u*vt,Ye+=u*We,Ne+=u*Rt,Ke+=u*Tt,u=A[2],me+=u*lt,Ae+=u*tt,$e+=u*ft,xe+=u*pt,xt+=u*ot,mt+=u*rt,nt+=u*St,Le+=u*Ct,Je+=u*dt,Qe+=u*Ot,at+=u*gt,Ue+=u*wt,Ye+=u*vt,Ne+=u*We,Ke+=u*Rt,ht+=u*Tt,u=A[3],Ae+=u*lt,$e+=u*tt,xe+=u*ft,xt+=u*pt,mt+=u*ot,nt+=u*rt,Le+=u*St,Je+=u*Ct,Qe+=u*dt,at+=u*Ot,Ue+=u*gt,Ye+=u*wt,Ne+=u*vt,Ke+=u*We,ht+=u*Rt,ze+=u*Tt,u=A[4],$e+=u*lt,xe+=u*tt,xt+=u*ft,mt+=u*pt,nt+=u*ot,Le+=u*rt,Je+=u*St,Qe+=u*Ct,at+=u*dt,Ue+=u*Ot,Ye+=u*gt,Ne+=u*wt,Ke+=u*vt,ht+=u*We,ze+=u*Rt,Pt+=u*Tt,u=A[5],xe+=u*lt,xt+=u*tt,mt+=u*ft,nt+=u*pt,Le+=u*ot,Je+=u*rt,Qe+=u*St,at+=u*Ct,Ue+=u*dt,Ye+=u*Ot,Ne+=u*gt,Ke+=u*wt,ht+=u*vt,ze+=u*We,Pt+=u*Rt,Dt+=u*Tt,u=A[6],xt+=u*lt,mt+=u*tt,nt+=u*ft,Le+=u*pt,Je+=u*ot,Qe+=u*rt,at+=u*St,Ue+=u*Ct,Ye+=u*dt,Ne+=u*Ot,Ke+=u*gt,ht+=u*wt,ze+=u*vt,Pt+=u*We,Dt+=u*Rt,Ht+=u*Tt,u=A[7],mt+=u*lt,nt+=u*tt,Le+=u*ft,Je+=u*pt,Qe+=u*ot,at+=u*rt,Ue+=u*St,Ye+=u*Ct,Ne+=u*dt,Ke+=u*Ot,ht+=u*gt,ze+=u*wt,Pt+=u*vt,Dt+=u*We,Ht+=u*Rt,kt+=u*Tt,u=A[8],nt+=u*lt,Le+=u*tt,Je+=u*ft,Qe+=u*pt,at+=u*ot,Ue+=u*rt,Ye+=u*St,Ne+=u*Ct,Ke+=u*dt,ht+=u*Ot,ze+=u*gt,Pt+=u*wt,Dt+=u*vt,Ht+=u*We,kt+=u*Rt,zt+=u*Tt,u=A[9],Le+=u*lt,Je+=u*tt,Qe+=u*ft,at+=u*pt,Ue+=u*ot,Ye+=u*rt,Ne+=u*St,Ke+=u*Ct,ht+=u*dt,ze+=u*Ot,Pt+=u*gt,Dt+=u*wt,Ht+=u*vt,kt+=u*We,zt+=u*Rt,Wt+=u*Tt,u=A[10],Je+=u*lt,Qe+=u*tt,at+=u*ft,Ue+=u*pt,Ye+=u*ot,Ne+=u*rt,Ke+=u*St,ht+=u*Ct,ze+=u*dt,Pt+=u*Ot,Dt+=u*gt,Ht+=u*wt,kt+=u*vt,zt+=u*We,Wt+=u*Rt,rr+=u*Tt,u=A[11],Qe+=u*lt,at+=u*tt,Ue+=u*ft,Ye+=u*pt,Ne+=u*ot,Ke+=u*rt,ht+=u*St,ze+=u*Ct,Pt+=u*dt,Dt+=u*Ot,Ht+=u*gt,kt+=u*wt,zt+=u*vt,Wt+=u*We,rr+=u*Rt,qr+=u*Tt,u=A[12],at+=u*lt,Ue+=u*tt,Ye+=u*ft,Ne+=u*pt,Ke+=u*ot,ht+=u*rt,ze+=u*St,Pt+=u*Ct,Dt+=u*dt,Ht+=u*Ot,kt+=u*gt,zt+=u*wt,Wt+=u*vt,rr+=u*We,qr+=u*Rt,Jt+=u*Tt,u=A[13],Ue+=u*lt,Ye+=u*tt,Ne+=u*ft,Ke+=u*pt,ht+=u*ot,ze+=u*rt,Pt+=u*St,Dt+=u*Ct,Ht+=u*dt,kt+=u*Ot,zt+=u*gt,Wt+=u*wt,rr+=u*vt,qr+=u*We,Jt+=u*Rt,Vr+=u*Tt,u=A[14],Ye+=u*lt,Ne+=u*tt,Ke+=u*ft,ht+=u*pt,ze+=u*ot,Pt+=u*rt,Dt+=u*St,Ht+=u*Ct,kt+=u*dt,zt+=u*Ot,Wt+=u*gt,rr+=u*wt,qr+=u*vt,Jt+=u*We,Vr+=u*Rt,oi+=u*Tt,u=A[15],Ne+=u*lt,Ke+=u*tt,ht+=u*ft,ze+=u*pt,Pt+=u*ot,Dt+=u*rt,Ht+=u*St,kt+=u*Ct,zt+=u*dt,Wt+=u*Ot,rr+=u*gt,qr+=u*wt,Jt+=u*vt,Vr+=u*We,oi+=u*Rt,xi+=u*Tt,Z+=38*Ke,oe+=38*ht,me+=38*ze,Ae+=38*Pt,$e+=38*Dt,xe+=38*Ht,xt+=38*kt,mt+=38*zt,nt+=38*Wt,Le+=38*rr,Je+=38*qr,Qe+=38*Jt,at+=38*Vr,Ue+=38*oi,Ye+=38*xi,b=1,u=Z+b+65535,b=Math.floor(u/65536),Z=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=me+b+65535,b=Math.floor(u/65536),me=u-b*65536,u=Ae+b+65535,b=Math.floor(u/65536),Ae=u-b*65536,u=$e+b+65535,b=Math.floor(u/65536),$e=u-b*65536,u=xe+b+65535,b=Math.floor(u/65536),xe=u-b*65536,u=xt+b+65535,b=Math.floor(u/65536),xt=u-b*65536,u=mt+b+65535,b=Math.floor(u/65536),mt=u-b*65536,u=nt+b+65535,b=Math.floor(u/65536),nt=u-b*65536,u=Le+b+65535,b=Math.floor(u/65536),Le=u-b*65536,u=Je+b+65535,b=Math.floor(u/65536),Je=u-b*65536,u=Qe+b+65535,b=Math.floor(u/65536),Qe=u-b*65536,u=at+b+65535,b=Math.floor(u/65536),at=u-b*65536,u=Ue+b+65535,b=Math.floor(u/65536),Ue=u-b*65536,u=Ye+b+65535,b=Math.floor(u/65536),Ye=u-b*65536,u=Ne+b+65535,b=Math.floor(u/65536),Ne=u-b*65536,Z+=b-1+37*(b-1),b=1,u=Z+b+65535,b=Math.floor(u/65536),Z=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=me+b+65535,b=Math.floor(u/65536),me=u-b*65536,u=Ae+b+65535,b=Math.floor(u/65536),Ae=u-b*65536,u=$e+b+65535,b=Math.floor(u/65536),$e=u-b*65536,u=xe+b+65535,b=Math.floor(u/65536),xe=u-b*65536,u=xt+b+65535,b=Math.floor(u/65536),xt=u-b*65536,u=mt+b+65535,b=Math.floor(u/65536),mt=u-b*65536,u=nt+b+65535,b=Math.floor(u/65536),nt=u-b*65536,u=Le+b+65535,b=Math.floor(u/65536),Le=u-b*65536,u=Je+b+65535,b=Math.floor(u/65536),Je=u-b*65536,u=Qe+b+65535,b=Math.floor(u/65536),Qe=u-b*65536,u=at+b+65535,b=Math.floor(u/65536),at=u-b*65536,u=Ue+b+65535,b=Math.floor(u/65536),Ue=u-b*65536,u=Ye+b+65535,b=Math.floor(u/65536),Ye=u-b*65536,u=Ne+b+65535,b=Math.floor(u/65536),Ne=u-b*65536,Z+=b-1+37*(b-1),N[0]=Z,N[1]=oe,N[2]=me,N[3]=Ae,N[4]=$e,N[5]=xe,N[6]=xt,N[7]=mt,N[8]=nt,N[9]=Le,N[10]=Je,N[11]=Qe,N[12]=at,N[13]=Ue,N[14]=Ye,N[15]=Ne}function W(N,A){k(N,A,A)}function ve(N,A){const S=a();let u;for(u=0;u<16;u++)S[u]=A[u];for(u=253;u>=0;u--)W(S,S),u!==2&&u!==4&&k(S,S,A);for(u=0;u<16;u++)N[u]=S[u]}function te(N,A){const S=a();let u;for(u=0;u<16;u++)S[u]=A[u];for(u=250;u>=0;u--)W(S,S),u!==1&&k(S,S,A);for(u=0;u<16;u++)N[u]=S[u]}function Ee(N,A){const S=a(),u=a(),b=a(),Z=a(),oe=a(),me=a(),Ae=a(),$e=a(),xe=a();$(S,N[1],N[0]),$(xe,A[1],A[0]),k(S,S,xe),pe(u,N[0],N[1]),pe(xe,A[0],A[1]),k(u,u,xe),k(b,N[3],A[3]),k(b,b,v),k(Z,N[2],A[2]),pe(Z,Z,Z),$(oe,u,S),$(me,Z,b),pe(Ae,Z,b),pe($e,u,S),k(N[0],oe,me),k(N[1],$e,Ae),k(N[2],Ae,me),k(N[3],oe,$e)}function Re(N,A,S){for(let u=0;u<4;u++)V(N[u],A[u],S)}function et(N,A){const S=a(),u=a(),b=a();ve(b,A[2]),k(S,A[0],b),k(u,A[1],b),re(N,u),N[31]^=he(S)<<7}function R(N,A,S){j(N[0],d),j(N[1],y),j(N[2],y),j(N[3],d);for(let u=255;u>=0;--u){const b=S[u/8|0]>>(u&7)&1;Re(N,A,b),Ee(A,N),Ee(N,N),Re(N,A,b)}}function M(N,A){const S=[a(),a(),a(),a()];j(S[0],E),j(S[1],C),j(S[2],y),k(S[3],E,C),R(N,S,A)}function je(N){if(N.length!==c.SEED_LENGTH)throw new Error(`ed25519: seed must be ${c.SEED_LENGTH} bytes`);const A=(0,r.hash)(N);A[0]&=248,A[31]&=127,A[31]|=64;const S=new Uint8Array(32),u=[a(),a(),a(),a()];M(u,A),et(S,u);const b=new Uint8Array(64);return b.set(N),b.set(S,32),{publicKey:S,secretKey:b}}c.generateKeyPairFromSeed=je;function Te(N){const A=(0,i.randomBytes)(32,N),S=je(A);return(0,n.wipe)(A),S}c.generateKeyPair=Te;function J(N){if(N.length!==c.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${c.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(N.subarray(32))}c.extractPublicKeyFromSecretKey=J;const F=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function K(N,A){let S,u,b,Z;for(u=63;u>=32;--u){for(S=0,b=u-32,Z=u-12;b<Z;++b)A[b]+=S-16*A[u]*F[b-(u-32)],S=Math.floor((A[b]+128)/256),A[b]-=S*256;A[b]+=S,A[u]=0}for(S=0,b=0;b<32;b++)A[b]+=S-(A[31]>>4)*F[b],S=A[b]>>8,A[b]&=255;for(b=0;b<32;b++)A[b]-=S*F[b];for(u=0;u<32;u++)A[u+1]+=A[u]>>8,N[u]=A[u]&255}function B(N){const A=new Float64Array(64);for(let S=0;S<64;S++)A[S]=N[S];for(let S=0;S<64;S++)N[S]=0;K(N,A)}function ut(N,A){const S=new Float64Array(64),u=[a(),a(),a(),a()],b=(0,r.hash)(N.subarray(0,32));b[0]&=248,b[31]&=127,b[31]|=64;const Z=new Uint8Array(64);Z.set(b.subarray(32),32);const oe=new r.SHA512;oe.update(Z.subarray(32)),oe.update(A);const me=oe.digest();oe.clean(),B(me),M(u,me),et(Z,u),oe.reset(),oe.update(Z.subarray(0,32)),oe.update(N.subarray(32)),oe.update(A);const Ae=oe.digest();B(Ae);for(let $e=0;$e<32;$e++)S[$e]=me[$e];for(let $e=0;$e<32;$e++)for(let xe=0;xe<32;xe++)S[$e+xe]+=Ae[$e]*b[xe];return K(Z.subarray(32),S),Z}c.sign=ut;function ke(N,A){const S=a(),u=a(),b=a(),Z=a(),oe=a(),me=a(),Ae=a();return j(N[2],y),fe(N[1],A),W(b,N[1]),k(Z,b,w),$(b,b,N[2]),pe(Z,N[2],Z),W(oe,Z),W(me,oe),k(Ae,me,oe),k(S,Ae,b),k(S,S,Z),te(S,S),k(S,S,b),k(S,S,Z),k(S,S,Z),k(N[0],S,Z),W(u,N[0]),k(u,u,Z),ue(u,b)&&k(N[0],N[0],T),W(u,N[0]),k(u,u,Z),ue(u,b)?-1:(he(N[0])===A[31]>>7&&$(N[0],d,N[0]),k(N[3],N[0],N[1]),0)}function Lr(N,A,S){const u=new Uint8Array(32),b=[a(),a(),a(),a()],Z=[a(),a(),a(),a()];if(S.length!==c.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${c.SIGNATURE_LENGTH} bytes`);if(ke(Z,N))return!1;const oe=new r.SHA512;oe.update(S.subarray(0,32)),oe.update(N),oe.update(A);const me=oe.digest();return B(me),R(b,Z,me),M(Z,S.subarray(32)),Ee(b,Z),et(u,b),!ce(S,u)}c.verify=Lr;function _e(N){let A=[a(),a(),a(),a()];if(ke(A,N))throw new Error("Ed25519: invalid public key");let S=a(),u=a(),b=A[1];pe(S,y,b),$(u,y,b),ve(u,u),k(S,S,u);let Z=new Uint8Array(32);return re(Z,S),Z}c.convertPublicKeyToX25519=_e;function It(N){const A=(0,r.hash)(N.subarray(0,32));A[0]&=248,A[31]&=127,A[31]|=64;const S=new Uint8Array(A.subarray(0,32));return(0,n.wipe)(A),S}c.convertSecretKeyToX25519=It})(bc);const Nw="EdDSA",$w="JWT",Hl=".",kl="base64url",Dw="utf8",Lw="utf8",qw=":",zw="did",Mw="key",Fh="base58btc",jw="z",Uw="K36",Hw=32;function fa(c){return ga(gc(Bs(c),Dw),kl)}function Kl(c){const i=gc(Uw,Fh),r=jw+ga(F0([i,c]),Fh);return[zw,Mw,r].join(qw)}function kw(c){return ga(c,kl)}function Kw(c){return gc([fa(c.header),fa(c.payload)].join(Hl),Lw)}function Vw(c){return[fa(c.header),fa(c.payload),kw(c.signature)].join(Hl)}function Bh(c=Ol.randomBytes(Hw)){return bc.generateKeyPairFromSeed(c)}async function Fw(c,i,r,n,a=ie.fromMiliseconds(Date.now())){const l={alg:Nw,typ:$w},d=Kl(n.publicKey),y=a+r,w={iss:d,sub:c,aud:i,iat:a,exp:y},v=Kw({header:l,payload:w}),E=bc.sign(n.secretKey,v);return Vw({header:l,payload:w,signature:E})}const Bw=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Gw=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Gh=c=>c.split("?")[0],Wh=10,Ww=Bw();class Jw{constructor(i){if(this.url=i,this.events=new Kr.EventEmitter,this.registering=!1,!Ah(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);this.url=i}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){return new Promise((i,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),i()},this.socket.close()})}async send(i,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Bs(i))}catch(n){this.onError(i.id,n)}}register(i=this.url){if(!Ah(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,a)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),a(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=i,this.registering=!0,new Promise((r,n)=>{const a=Nm.isReactNative()?void 0:{rejectUnauthorized:!$m(i)},l=new Ww(i,[],a);Gw()?l.onerror=d=>{const y=d;n(this.emitError(y.error))}:l.on("error",d=>{n(this.emitError(d))}),l.onopen=()=>{this.onOpen(l),r(l)}})}onOpen(i){i.onmessage=r=>this.onPayload(r),i.onclose=r=>this.onClose(r),this.socket=i,this.registering=!1,this.events.emit("open")}onClose(i){this.socket=void 0,this.registering=!1,this.events.emit("close",i)}onPayload(i){if(typeof i.data>"u")return;const r=typeof i.data=="string"?va(i.data):i.data;this.events.emit("payload",r)}onError(i,r){const n=this.parseError(r),a=n.message||n.toString(),l=yc(i,a);this.events.emit("payload",l)}parseError(i,r=this.url){return Dm(i,Gh(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Wh&&this.events.setMaxListeners(Wh)}emitError(i){const r=this.parseError(new Error((i==null?void 0:i.message)||`WebSocket connection failed for host: ${Gh(this.url)}`));return this.events.emit("register_error",r),r}}var pa={exports:{}};pa.exports;(function(c,i){var r=200,n="__lodash_hash_undefined__",a=1,l=2,d=9007199254740991,y="[object Arguments]",w="[object Array]",v="[object AsyncFunction]",E="[object Boolean]",C="[object Date]",T="[object Error]",j="[object Function]",D="[object GeneratorFunction]",V="[object Map]",re="[object Number]",ce="[object Null]",ue="[object Object]",he="[object Promise]",fe="[object Proxy]",pe="[object RegExp]",$="[object Set]",k="[object String]",W="[object Symbol]",ve="[object Undefined]",te="[object WeakMap]",Ee="[object ArrayBuffer]",Re="[object DataView]",et="[object Float32Array]",R="[object Float64Array]",M="[object Int8Array]",je="[object Int16Array]",Te="[object Int32Array]",J="[object Uint8Array]",F="[object Uint8ClampedArray]",K="[object Uint16Array]",B="[object Uint32Array]",ut=/[\\^$.*+?()[\]{}|]/g,ke=/^\[object .+?Constructor\]$/,Lr=/^(?:0|[1-9]\d*)$/,_e={};_e[et]=_e[R]=_e[M]=_e[je]=_e[Te]=_e[J]=_e[F]=_e[K]=_e[B]=!0,_e[y]=_e[w]=_e[Ee]=_e[E]=_e[Re]=_e[C]=_e[T]=_e[j]=_e[V]=_e[re]=_e[ue]=_e[pe]=_e[$]=_e[k]=_e[te]=!1;var It=typeof ea=="object"&&ea&&ea.Object===Object&&ea,N=typeof self=="object"&&self&&self.Object===Object&&self,A=It||N||Function("return this")(),S=i&&!i.nodeType&&i,u=S&&!0&&c&&!c.nodeType&&c,b=u&&u.exports===S,Z=b&&It.process,oe=function(){try{return Z&&Z.binding&&Z.binding("util")}catch{}}(),me=oe&&oe.isTypedArray;function Ae(g,I){for(var U=-1,Q=g==null?0:g.length,Fe=0,de=[];++U<Q;){var Xe=g[U];I(Xe,U,g)&&(de[Fe++]=Xe)}return de}function $e(g,I){for(var U=-1,Q=I.length,Fe=g.length;++U<Q;)g[Fe+U]=I[U];return g}function xe(g,I){for(var U=-1,Q=g==null?0:g.length;++U<Q;)if(I(g[U],U,g))return!0;return!1}function xt(g,I){for(var U=-1,Q=Array(g);++U<g;)Q[U]=I(U);return Q}function mt(g){return function(I){return g(I)}}function nt(g,I){return g.has(I)}function Le(g,I){return g==null?void 0:g[I]}function Je(g){var I=-1,U=Array(g.size);return g.forEach(function(Q,Fe){U[++I]=[Fe,Q]}),U}function Qe(g,I){return function(U){return g(I(U))}}function at(g){var I=-1,U=Array(g.size);return g.forEach(function(Q){U[++I]=Q}),U}var Ue=Array.prototype,Ye=Function.prototype,Ne=Object.prototype,Ke=A["__core-js_shared__"],ht=Ye.toString,ze=Ne.hasOwnProperty,Pt=function(){var g=/[^.]+$/.exec(Ke&&Ke.keys&&Ke.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),Dt=Ne.toString,Ht=RegExp("^"+ht.call(ze).replace(ut,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kt=b?A.Buffer:void 0,zt=A.Symbol,Wt=A.Uint8Array,rr=Ne.propertyIsEnumerable,qr=Ue.splice,Jt=zt?zt.toStringTag:void 0,Vr=Object.getOwnPropertySymbols,oi=kt?kt.isBuffer:void 0,xi=Qe(Object.keys,Object),lt=lr(A,"DataView"),tt=lr(A,"Map"),ft=lr(A,"Promise"),pt=lr(A,"Set"),ot=lr(A,"WeakMap"),rt=lr(Object,"create"),St=Br(lt),Ct=Br(tt),dt=Br(ft),Ot=Br(pt),gt=Br(ot),wt=zt?zt.prototype:void 0,vt=wt?wt.valueOf:void 0;function We(g){var I=-1,U=g==null?0:g.length;for(this.clear();++I<U;){var Q=g[I];this.set(Q[0],Q[1])}}function Rt(){this.__data__=rt?rt(null):{},this.size=0}function Tt(g){var I=this.has(g)&&delete this.__data__[g];return this.size-=I?1:0,I}function wa(g){var I=this.__data__;if(rt){var U=I[g];return U===n?void 0:U}return ze.call(I,g)?I[g]:void 0}function _a(g){var I=this.__data__;return rt?I[g]!==void 0:ze.call(I,g)}function ba(g,I){var U=this.__data__;return this.size+=this.has(g)?0:1,U[g]=rt&&I===void 0?n:I,this}We.prototype.clear=Rt,We.prototype.delete=Tt,We.prototype.get=wa,We.prototype.has=_a,We.prototype.set=ba;function yr(g){var I=-1,U=g==null?0:g.length;for(this.clear();++I<U;){var Q=g[I];this.set(Q[0],Q[1])}}function Ea(){this.__data__=[],this.size=0}function Ia(g){var I=this.__data__,U=Pi(I,g);if(U<0)return!1;var Q=I.length-1;return U==Q?I.pop():qr.call(I,U,1),--this.size,!0}function xa(g){var I=this.__data__,U=Pi(I,g);return U<0?void 0:I[U][1]}function Pa(g){return Pi(this.__data__,g)>-1}function Sa(g,I){var U=this.__data__,Q=Pi(U,g);return Q<0?(++this.size,U.push([g,I])):U[Q][1]=I,this}yr.prototype.clear=Ea,yr.prototype.delete=Ia,yr.prototype.get=xa,yr.prototype.has=Pa,yr.prototype.set=Sa;function Fr(g){var I=-1,U=g==null?0:g.length;for(this.clear();++I<U;){var Q=g[I];this.set(Q[0],Q[1])}}function Ki(){this.size=0,this.__data__={hash:new We,map:new(tt||yr),string:new We}}function Ca(g){var I=ci(this,g).delete(g);return this.size-=I?1:0,I}function Vi(g){return ci(this,g).get(g)}function Oa(g){return ci(this,g).has(g)}function Ra(g,I){var U=ci(this,g),Q=U.size;return U.set(g,I),this.size+=U.size==Q?0:1,this}Fr.prototype.clear=Ki,Fr.prototype.delete=Ca,Fr.prototype.get=Vi,Fr.prototype.has=Oa,Fr.prototype.set=Ra;function Fi(g){var I=-1,U=g==null?0:g.length;for(this.__data__=new Fr;++I<U;)this.add(g[I])}function Js(g){return this.__data__.set(g,n),this}function Qs(g){return this.__data__.has(g)}Fi.prototype.add=Fi.prototype.push=Js,Fi.prototype.has=Qs;function Cr(g){var I=this.__data__=new yr(g);this.size=I.size}function Ta(){this.__data__=new yr,this.size=0}function Aa(g){var I=this.__data__,U=I.delete(g);return this.size=I.size,U}function Na(g){return this.__data__.get(g)}function $a(g){return this.__data__.has(g)}function Ys(g,I){var U=this.__data__;if(U instanceof yr){var Q=U.__data__;if(!tt||Q.length<r-1)return Q.push([g,I]),this.size=++U.size,this;U=this.__data__=new Fr(Q)}return U.set(g,I),this.size=U.size,this}Cr.prototype.clear=Ta,Cr.prototype.delete=Aa,Cr.prototype.get=Na,Cr.prototype.has=$a,Cr.prototype.set=Ys;function Xs(g,I){var U=Wi(g),Q=!U&&ln(g),Fe=!U&&!Q&&vs(g),de=!U&&!Q&&!Fe&&dn(g),Xe=U||Q||Fe||de,At=Xe?xt(g.length,String):[],Se=At.length;for(var Be in g)(I||ze.call(g,Be))&&!(Xe&&(Be=="length"||Fe&&(Be=="offset"||Be=="parent")||de&&(Be=="buffer"||Be=="byteLength"||Be=="byteOffset")||an(Be,Se)))&&At.push(Be);return At}function Pi(g,I){for(var U=g.length;U--;)if(hn(g[U][0],I))return U;return-1}function ds(g,I,U){var Q=I(g);return Wi(g)?Q:$e(Q,U(g))}function Si(g){return g==null?g===void 0?ve:ce:Jt&&Jt in Object(g)?sn(g):qa(g)}function gs(g){return Oi(g)&&Si(g)==y}function Ci(g,I,U,Q,Fe){return g===I?!0:g==null||I==null||!Oi(g)&&!Oi(I)?g!==g&&I!==I:Zs(g,I,U,Q,Ci,Fe)}function Zs(g,I,U,Q,Fe,de){var Xe=Wi(g),At=Wi(I),Se=Xe?w:zr(g),Be=At?w:zr(I);Se=Se==y?ue:Se,Be=Be==y?ue:Be;var _t=Se==ue,ir=Be==ue,Nt=Se==Be;if(Nt&&vs(g)){if(!vs(I))return!1;Xe=!0,_t=!1}if(Nt&&!_t)return de||(de=new Cr),Xe||dn(g)?Bi(g,I,U,Q,Fe,de):La(g,I,Se,U,Q,Fe,de);if(!(U&a)){var Ze=_t&&ze.call(g,"__wrapped__"),Qt=ir&&ze.call(I,"__wrapped__");if(Ze||Qt){var Or=Ze?g.value():g,mr=Qt?I.value():I;return de||(de=new Cr),Fe(Or,mr,U,Q,de)}}return Nt?(de||(de=new Cr),rn(g,I,U,Q,Fe,de)):!1}function Da(g){if(!pn(g)||cn(g))return!1;var I=Ji(g)?Ht:ke;return I.test(Br(g))}function en(g){return Oi(g)&&fn(g.length)&&!!_e[Si(g)]}function tn(g){if(!un(g))return xi(g);var I=[];for(var U in Object(g))ze.call(g,U)&&U!="constructor"&&I.push(U);return I}function Bi(g,I,U,Q,Fe,de){var Xe=U&a,At=g.length,Se=I.length;if(At!=Se&&!(Xe&&Se>At))return!1;var Be=de.get(g);if(Be&&de.get(I))return Be==I;var _t=-1,ir=!0,Nt=U&l?new Fi:void 0;for(de.set(g,I),de.set(I,g);++_t<At;){var Ze=g[_t],Qt=I[_t];if(Q)var Or=Xe?Q(Qt,Ze,_t,I,g,de):Q(Ze,Qt,_t,g,I,de);if(Or!==void 0){if(Or)continue;ir=!1;break}if(Nt){if(!xe(I,function(mr,Mr){if(!nt(Nt,Mr)&&(Ze===mr||Fe(Ze,mr,U,Q,de)))return Nt.push(Mr)})){ir=!1;break}}else if(!(Ze===Qt||Fe(Ze,Qt,U,Q,de))){ir=!1;break}}return de.delete(g),de.delete(I),ir}function La(g,I,U,Q,Fe,de,Xe){switch(U){case Re:if(g.byteLength!=I.byteLength||g.byteOffset!=I.byteOffset)return!1;g=g.buffer,I=I.buffer;case Ee:return!(g.byteLength!=I.byteLength||!de(new Wt(g),new Wt(I)));case E:case C:case re:return hn(+g,+I);case T:return g.name==I.name&&g.message==I.message;case pe:case k:return g==I+"";case V:var At=Je;case $:var Se=Q&a;if(At||(At=at),g.size!=I.size&&!Se)return!1;var Be=Xe.get(g);if(Be)return Be==I;Q|=l,Xe.set(g,I);var _t=Bi(At(g),At(I),Q,Fe,de,Xe);return Xe.delete(g),_t;case W:if(vt)return vt.call(g)==vt.call(I)}return!1}function rn(g,I,U,Q,Fe,de){var Xe=U&a,At=Gi(g),Se=At.length,Be=Gi(I),_t=Be.length;if(Se!=_t&&!Xe)return!1;for(var ir=Se;ir--;){var Nt=At[ir];if(!(Xe?Nt in I:ze.call(I,Nt)))return!1}var Ze=de.get(g);if(Ze&&de.get(I))return Ze==I;var Qt=!0;de.set(g,I),de.set(I,g);for(var Or=Xe;++ir<Se;){Nt=At[ir];var mr=g[Nt],Mr=I[Nt];if(Q)var ys=Xe?Q(Mr,mr,Nt,I,g,de):Q(mr,Mr,Nt,g,I,de);if(!(ys===void 0?mr===Mr||Fe(mr,Mr,U,Q,de):ys)){Qt=!1;break}Or||(Or=Nt=="constructor")}if(Qt&&!Or){var Ri=g.constructor,Mt=I.constructor;Ri!=Mt&&"constructor"in g&&"constructor"in I&&!(typeof Ri=="function"&&Ri instanceof Ri&&typeof Mt=="function"&&Mt instanceof Mt)&&(Qt=!1)}return de.delete(g),de.delete(I),Qt}function Gi(g){return ds(g,ja,nn)}function ci(g,I){var U=g.__data__;return on(I)?U[typeof I=="string"?"string":"hash"]:U.map}function lr(g,I){var U=Le(g,I);return Da(U)?U:void 0}function sn(g){var I=ze.call(g,Jt),U=g[Jt];try{g[Jt]=void 0;var Q=!0}catch{}var Fe=Dt.call(g);return Q&&(I?g[Jt]=U:delete g[Jt]),Fe}var nn=Vr?function(g){return g==null?[]:(g=Object(g),Ae(Vr(g),function(I){return rr.call(g,I)}))}:Ve,zr=Si;(lt&&zr(new lt(new ArrayBuffer(1)))!=Re||tt&&zr(new tt)!=V||ft&&zr(ft.resolve())!=he||pt&&zr(new pt)!=$||ot&&zr(new ot)!=te)&&(zr=function(g){var I=Si(g),U=I==ue?g.constructor:void 0,Q=U?Br(U):"";if(Q)switch(Q){case St:return Re;case Ct:return V;case dt:return he;case Ot:return $;case gt:return te}return I});function an(g,I){return I=I??d,!!I&&(typeof g=="number"||Lr.test(g))&&g>-1&&g%1==0&&g<I}function on(g){var I=typeof g;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?g!=="__proto__":g===null}function cn(g){return!!Pt&&Pt in g}function un(g){var I=g&&g.constructor,U=typeof I=="function"&&I.prototype||Ne;return g===U}function qa(g){return Dt.call(g)}function Br(g){if(g!=null){try{return ht.call(g)}catch{}try{return g+""}catch{}}return""}function hn(g,I){return g===I||g!==g&&I!==I}var ln=gs(function(){return arguments}())?gs:function(g){return Oi(g)&&ze.call(g,"callee")&&!rr.call(g,"callee")},Wi=Array.isArray;function za(g){return g!=null&&fn(g.length)&&!Ji(g)}var vs=oi||He;function Ma(g,I){return Ci(g,I)}function Ji(g){if(!pn(g))return!1;var I=Si(g);return I==j||I==D||I==v||I==fe}function fn(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=d}function pn(g){var I=typeof g;return g!=null&&(I=="object"||I=="function")}function Oi(g){return g!=null&&typeof g=="object"}var dn=me?mt(me):en;function ja(g){return za(g)?Xs(g):tn(g)}function Ve(){return[]}function He(){return!1}c.exports=Ma})(pa,pa.exports);var Qw=pa.exports;const Yw=B0(Qw);var Xw={};function Zw(c,i){if(c.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var a=0;a<c.length;a++){var l=c.charAt(a),d=l.charCodeAt(0);if(r[d]!==255)throw new TypeError(l+" is ambiguous");r[d]=a}var y=c.length,w=c.charAt(0),v=Math.log(y)/Math.log(256),E=Math.log(256)/Math.log(y);function C(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var V=0,re=0,ce=0,ue=D.length;ce!==ue&&D[ce]===0;)ce++,V++;for(var he=(ue-ce)*E+1>>>0,fe=new Uint8Array(he);ce!==ue;){for(var pe=D[ce],$=0,k=he-1;(pe!==0||$<re)&&k!==-1;k--,$++)pe+=256*fe[k]>>>0,fe[k]=pe%y>>>0,pe=pe/y>>>0;if(pe!==0)throw new Error("Non-zero carry");re=$,ce++}for(var W=he-re;W!==he&&fe[W]===0;)W++;for(var ve=w.repeat(V);W<he;++W)ve+=c.charAt(fe[W]);return ve}function T(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var V=0;if(D[V]!==" "){for(var re=0,ce=0;D[V]===w;)re++,V++;for(var ue=(D.length-V)*v+1>>>0,he=new Uint8Array(ue);D[V];){var fe=r[D.charCodeAt(V)];if(fe===255)return;for(var pe=0,$=ue-1;(fe!==0||pe<ce)&&$!==-1;$--,pe++)fe+=y*he[$]>>>0,he[$]=fe%256>>>0,fe=fe/256>>>0;if(fe!==0)throw new Error("Non-zero carry");ce=pe,V++}if(D[V]!==" "){for(var k=ue-ce;k!==ue&&he[k]===0;)k++;for(var W=new Uint8Array(re+(ue-k)),ve=re;k!==ue;)W[ve++]=he[k++];return W}}}function j(D){var V=T(D);if(V)return V;throw new Error(`Non-${i} character`)}return{encode:C,decodeUnsafe:T,decode:j}}var e_=Zw,t_=e_;const Vl=c=>{if(c instanceof Uint8Array&&c.constructor.name==="Uint8Array")return c;if(c instanceof ArrayBuffer)return new Uint8Array(c);if(ArrayBuffer.isView(c))return new Uint8Array(c.buffer,c.byteOffset,c.byteLength);throw new Error("Unknown type, must be binary type")},r_=c=>new TextEncoder().encode(c),i_=c=>new TextDecoder().decode(c);class s_{constructor(i,r,n){this.name=i,this.prefix=r,this.baseEncode=n}encode(i){if(i instanceof Uint8Array)return`${this.prefix}${this.baseEncode(i)}`;throw Error("Unknown type, must be binary type")}}class n_{constructor(i,r,n){if(this.name=i,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(i){if(typeof i=="string"){if(i.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(i)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(i.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(i){return Fl(this,i)}}class a_{constructor(i){this.decoders=i}or(i){return Fl(this,i)}decode(i){const r=i[0],n=this.decoders[r];if(n)return n.decode(i);throw RangeError(`Unable to decode multibase string ${JSON.stringify(i)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Fl=(c,i)=>new a_({...c.decoders||{[c.prefix]:c},...i.decoders||{[i.prefix]:i}});class o_{constructor(i,r,n,a){this.name=i,this.prefix=r,this.baseEncode=n,this.baseDecode=a,this.encoder=new s_(i,r,n),this.decoder=new n_(i,r,a)}encode(i){return this.encoder.encode(i)}decode(i){return this.decoder.decode(i)}}const ya=({name:c,prefix:i,encode:r,decode:n})=>new o_(c,i,r,n),Ws=({prefix:c,name:i,alphabet:r})=>{const{encode:n,decode:a}=t_(r,i);return ya({prefix:c,name:i,encode:n,decode:l=>Vl(a(l))})},c_=(c,i,r,n)=>{const a={};for(let E=0;E<i.length;++E)a[i[E]]=E;let l=c.length;for(;c[l-1]==="=";)--l;const d=new Uint8Array(l*r/8|0);let y=0,w=0,v=0;for(let E=0;E<l;++E){const C=a[c[E]];if(C===void 0)throw new SyntaxError(`Non-${n} character`);w=w<<r|C,y+=r,y>=8&&(y-=8,d[v++]=255&w>>y)}if(y>=r||255&w<<8-y)throw new SyntaxError("Unexpected end of data");return d},u_=(c,i,r)=>{const n=i[i.length-1]==="=",a=(1<<r)-1;let l="",d=0,y=0;for(let w=0;w<c.length;++w)for(y=y<<8|c[w],d+=8;d>r;)d-=r,l+=i[a&y>>d];if(d&&(l+=i[a&y<<r-d]),n)for(;l.length*r&7;)l+="=";return l},Vt=({name:c,prefix:i,bitsPerChar:r,alphabet:n})=>ya({prefix:i,name:c,encode(a){return u_(a,n,r)},decode(a){return c_(a,n,r,c)}}),h_=ya({prefix:"\0",name:"identity",encode:c=>i_(c),decode:c=>r_(c)});var l_=Object.freeze({__proto__:null,identity:h_});const f_=Vt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var p_=Object.freeze({__proto__:null,base2:f_});const d_=Vt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var g_=Object.freeze({__proto__:null,base8:d_});const v_=Ws({prefix:"9",name:"base10",alphabet:"0123456789"});var y_=Object.freeze({__proto__:null,base10:v_});const m_=Vt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),w_=Vt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var __=Object.freeze({__proto__:null,base16:m_,base16upper:w_});const b_=Vt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),E_=Vt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),I_=Vt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),x_=Vt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),P_=Vt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),S_=Vt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),C_=Vt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),O_=Vt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),R_=Vt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var T_=Object.freeze({__proto__:null,base32:b_,base32upper:E_,base32pad:I_,base32padupper:x_,base32hex:P_,base32hexupper:S_,base32hexpad:C_,base32hexpadupper:O_,base32z:R_});const A_=Ws({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),N_=Ws({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var $_=Object.freeze({__proto__:null,base36:A_,base36upper:N_});const D_=Ws({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),L_=Ws({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var q_=Object.freeze({__proto__:null,base58btc:D_,base58flickr:L_});const z_=Vt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),M_=Vt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),j_=Vt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),U_=Vt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var H_=Object.freeze({__proto__:null,base64:z_,base64pad:M_,base64url:j_,base64urlpad:U_});const Bl=Array.from(""),k_=Bl.reduce((c,i,r)=>(c[r]=i,c),[]),K_=Bl.reduce((c,i,r)=>(c[i.codePointAt(0)]=r,c),[]);function V_(c){return c.reduce((i,r)=>(i+=k_[r],i),"")}function F_(c){const i=[];for(const r of c){const n=K_[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);i.push(n)}return new Uint8Array(i)}const B_=ya({prefix:"",name:"base256emoji",encode:V_,decode:F_});var G_=Object.freeze({__proto__:null,base256emoji:B_}),W_=Gl,Jh=128,J_=127,Q_=~J_,Y_=Math.pow(2,31);function Gl(c,i,r){i=i||[],r=r||0;for(var n=r;c>=Y_;)i[r++]=c&255|Jh,c/=128;for(;c&Q_;)i[r++]=c&255|Jh,c>>>=7;return i[r]=c|0,Gl.bytes=r-n+1,i}var X_=hc,Z_=128,Qh=127;function hc(c,n){var r=0,n=n||0,a=0,l=n,d,y=c.length;do{if(l>=y)throw hc.bytes=0,new RangeError("Could not decode varint");d=c[l++],r+=a<28?(d&Qh)<<a:(d&Qh)*Math.pow(2,a),a+=7}while(d>=Z_);return hc.bytes=l-n,r}var e1=Math.pow(2,7),t1=Math.pow(2,14),r1=Math.pow(2,21),i1=Math.pow(2,28),s1=Math.pow(2,35),n1=Math.pow(2,42),a1=Math.pow(2,49),o1=Math.pow(2,56),c1=Math.pow(2,63),u1=function(c){return c<e1?1:c<t1?2:c<r1?3:c<i1?4:c<s1?5:c<n1?6:c<a1?7:c<o1?8:c<c1?9:10},h1={encode:W_,decode:X_,encodingLength:u1},Wl=h1;const Yh=(c,i,r=0)=>(Wl.encode(c,i,r),i),Xh=c=>Wl.encodingLength(c),lc=(c,i)=>{const r=i.byteLength,n=Xh(c),a=n+Xh(r),l=new Uint8Array(a+r);return Yh(c,l,0),Yh(r,l,n),l.set(i,a),new l1(c,r,i,l)};class l1{constructor(i,r,n,a){this.code=i,this.size=r,this.digest=n,this.bytes=a}}const Jl=({name:c,code:i,encode:r})=>new f1(c,i,r);class f1{constructor(i,r,n){this.name=i,this.code=r,this.encode=n}digest(i){if(i instanceof Uint8Array){const r=this.encode(i);return r instanceof Uint8Array?lc(this.code,r):r.then(n=>lc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Ql=c=>async i=>new Uint8Array(await crypto.subtle.digest(c,i)),p1=Jl({name:"sha2-256",code:18,encode:Ql("SHA-256")}),d1=Jl({name:"sha2-512",code:19,encode:Ql("SHA-512")});var g1=Object.freeze({__proto__:null,sha256:p1,sha512:d1});const Yl=0,v1="identity",Xl=Vl,y1=c=>lc(Yl,Xl(c)),m1={code:Yl,name:v1,encode:Xl,digest:y1};var w1=Object.freeze({__proto__:null,identity:m1});new TextEncoder,new TextDecoder;const Zh={...l_,...p_,...g_,...y_,...__,...T_,...$_,...q_,...H_,...G_};({...g1,...w1});function Zl(c){return globalThis.Buffer!=null?new Uint8Array(c.buffer,c.byteOffset,c.byteLength):c}function _1(c=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Zl(globalThis.Buffer.allocUnsafe(c)):new Uint8Array(c)}function ef(c,i,r,n){return{name:c,prefix:i,encoder:{name:c,prefix:i,encode:r},decoder:{decode:n}}}const el=ef("utf8","u",c=>"u"+new TextDecoder("utf8").decode(c),c=>new TextEncoder().encode(c.substring(1))),Xo=ef("ascii","a",c=>{let i="a";for(let r=0;r<c.length;r++)i+=String.fromCharCode(c[r]);return i},c=>{c=c.substring(1);const i=_1(c.length);for(let r=0;r<c.length;r++)i[r]=c.charCodeAt(r);return i}),b1={utf8:el,"utf-8":el,hex:Zh.base16,latin1:Xo,ascii:Xo,binary:Xo,...Zh};function E1(c,i="utf8"){const r=b1[i];if(!r)throw new Error(`Unsupported encoding "${i}"`);return(i==="utf8"||i==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Zl(globalThis.Buffer.from(c,"utf-8")):r.decoder.decode(`${r.prefix}${c}`)}const tf="wc",I1=2,Ec="core",bi=`${tf}@2:${Ec}:`,x1={name:Ec,logger:"error"},P1={database:":memory:"},S1="crypto",tl="client_ed25519_seed",C1=ie.ONE_DAY,O1="keychain",R1="0.3",T1="messages",A1="0.3",N1=ie.SIX_HOURS,$1="publisher",rf="irn",D1="error",sf="wss://relay.walletconnect.com",rl="wss://relay.walletconnect.org",L1="relayer",Gt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},q1="_subscription",ri={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},z1=ie.ONE_SECOND,M1="2.10.2",j1=1e4,U1="0.3",H1="WALLETCONNECT_CLIENT_ID",$r={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},k1="subscription",K1="0.3",V1=ie.FIVE_SECONDS*1e3,F1="pairing",B1="0.3",Ls={wc_pairingDelete:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:0},res:{ttl:ie.ONE_DAY,prompt:!1,tag:0}}},Hs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},kr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},G1="history",W1="0.3",J1="expirer",Sr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Q1="0.3",Zo="verify-api",la="https://verify.walletconnect.com",il="https://verify.walletconnect.org";class Y1{constructor(i,r){this.core=i,this.logger=r,this.keychain=new Map,this.name=O1,this.version=R1,this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,a)=>{this.isInitialized(),this.keychain.set(n,a),await this.persist()},this.get=n=>{this.isInitialized();const a=this.keychain.get(n);if(typeof a>"u"){const{message:l}=X("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(l)}return a},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=i,this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(i){await this.core.storage.setItem(this.storageKey,Nl(i))}async getKeyChain(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?$l(i):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}}class X1{constructor(i,r,n){this.core=i,this.logger=r,this.name=S1,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),l=Bh(a);return Kl(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=J0();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const l=await this.getClientSeed(),d=Bh(l),y=oc();return await Fw(y,a,C1,d)},this.generateSharedKey=(a,l,d)=>{this.isInitialized();const y=this.getPrivateKey(a),w=Q0(y,l);return this.setSymKey(w,d)},this.setSymKey=async(a,l)=>{this.isInitialized();const d=l||Y0(a);return await this.keychain.set(d,a),d},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,l,d)=>{this.isInitialized();const y=X0(d),w=Bs(l);if(Sh(y)){const T=y.senderPublicKey,j=y.receiverPublicKey;a=await this.generateSharedKey(T,j)}const v=this.getSymKey(a),{type:E,senderPublicKey:C}=y;return Z0({type:E,symKey:v,message:w,senderPublicKey:C})},this.decode=async(a,l,d)=>{this.isInitialized();const y=em(l,d);if(Sh(y)){const w=y.receiverPublicKey,v=y.senderPublicKey;a=await this.generateSharedKey(w,v)}try{const w=this.getSymKey(a),v=tm({symKey:w,encoded:l});return va(v)}catch(w){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(w)}},this.getPayloadType=a=>{const l=Ch(a);return rm(l.type)},this.getPayloadSenderPublicKey=a=>{const l=Ch(a);return l.senderPublicKey?ga(l.senderPublicKey,im):void 0},this.core=i,this.logger=Oe.generateChildLogger(r,this.name),this.keychain=n||new Y1(this.core,this.logger)}get context(){return Oe.getLoggerContext(this.logger)}async setPrivateKey(i,r){return await this.keychain.set(i,r),i}getPrivateKey(i){return this.keychain.get(i)}async getClientSeed(){let i="";try{i=this.keychain.get(tl)}catch{i=oc(),await this.keychain.set(tl,i)}return E1(i,"base16")}getSymKey(i){return this.keychain.get(i)}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Z1 extends Iw{constructor(i,r){super(i,r),this.logger=i,this.core=r,this.messages=new Map,this.name=T1,this.version=A1,this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,a)=>{this.isInitialized();const l=ls(a);let d=this.messages.get(n);return typeof d>"u"&&(d={}),typeof d[l]<"u"||(d[l]=a,this.messages.set(n,d),await this.persist()),l},this.get=n=>{this.isInitialized();let a=this.messages.get(n);return typeof a>"u"&&(a={}),a},this.has=(n,a)=>{this.isInitialized();const l=this.get(n),d=ls(a);return typeof l[d]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Oe.generateChildLogger(i,this.name),this.core=r}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(i){await this.core.storage.setItem(this.storageKey,Nl(i))}async getRelayerMessages(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?$l(i):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}}class eb extends xw{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.events=new Kr.EventEmitter,this.name=$1,this.queue=new Map,this.publishTimeout=ie.toMiliseconds(ie.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,a,l)=>{var d;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:l}});try{const y=(l==null?void 0:l.ttl)||N1,w=cc(l),v=(l==null?void 0:l.prompt)||!1,E=(l==null?void 0:l.tag)||0,C=(l==null?void 0:l.id)||Lm().toString(),T={topic:n,message:a,opts:{ttl:y,relay:w,prompt:v,tag:E,id:C}},j=setTimeout(()=>this.queue.set(C,T),this.publishTimeout);try{await await Vs(this.rpcPublish(n,a,y,w,v,E,C),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(C),this.relayer.events.emit(Gt.publish,T)}catch(D){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(d=l==null?void 0:l.internal)!=null&&d.throwOnFailedPublish)throw this.removeRequestFromQueue(C),D;return}finally{clearTimeout(j)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:l}})}catch(y){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(y),y}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.relayer=i,this.logger=Oe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Oe.getLoggerContext(this.logger)}rpcPublish(i,r,n,a,l,d,y){var w,v,E,C;const T={method:oa(a.protocol).publish,params:{topic:i,message:r,ttl:n,prompt:l,tag:d},id:y};return _i((w=T.params)==null?void 0:w.prompt)&&((v=T.params)==null||delete v.prompt),_i((E=T.params)==null?void 0:E.tag)&&((C=T.params)==null||delete C.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:T}),this.relayer.request(T)}removeRequestFromQueue(i){this.queue.delete(i)}checkQueue(){this.queue.forEach(async i=>{const{topic:r,message:n,opts:a}=i;await this.publish(r,n,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(ps.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Gt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Gt.message_ack,i=>{this.removeRequestFromQueue(i.id.toString())})}}class tb{constructor(){this.map=new Map,this.set=(i,r)=>{const n=this.get(i);this.exists(i,r)||this.map.set(i,[...n,r])},this.get=i=>this.map.get(i)||[],this.exists=(i,r)=>this.get(i).includes(r),this.delete=(i,r)=>{if(typeof r>"u"){this.map.delete(i);return}if(!this.map.has(i))return;const n=this.get(i);if(!this.exists(i,r))return;const a=n.filter(l=>l!==r);if(!a.length){this.map.delete(i);return}this.map.set(i,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var rb=Object.defineProperty,ib=Object.defineProperties,sb=Object.getOwnPropertyDescriptors,sl=Object.getOwnPropertySymbols,nb=Object.prototype.hasOwnProperty,ab=Object.prototype.propertyIsEnumerable,nl=(c,i,r)=>i in c?rb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,qs=(c,i)=>{for(var r in i||(i={}))nb.call(i,r)&&nl(c,r,i[r]);if(sl)for(var r of sl(i))ab.call(i,r)&&nl(c,r,i[r]);return c},ec=(c,i)=>ib(c,sb(i));class ob extends Cw{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.subscriptions=new Map,this.topicMap=new tb,this.events=new Kr.EventEmitter,this.name=k1,this.version=K1,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=bi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}});try{const l=cc(a),d={topic:n,relay:l};this.pending.set(n,d);const y=await this.rpcSubscribe(n,l);return this.onSubscribe(y,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}}),y}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(n,a.id,a):await this.unsubscribeByTopic(n,a)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((a,l)=>{const d=new ie.Watch;d.start(this.pendingSubscriptionWatchLabel);const y=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(y),d.stop(this.pendingSubscriptionWatchLabel),a(!0)),d.elapsed(this.pendingSubscriptionWatchLabel)>=V1&&(clearInterval(y),d.stop(this.pendingSubscriptionWatchLabel),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=i,this.logger=Oe.generateChildLogger(r,this.name),this.clientId=""}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(i,r){let n=!1;try{n=this.getSubscription(i).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(i,r){const n=this.topicMap.get(i);await Promise.all(n.map(async a=>await this.unsubscribeById(i,a,r)))}async unsubscribeById(i,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:n}});try{const a=cc(n);await this.rpcUnsubscribe(i,r,a);const l=tr("USER_DISCONNECTED",`${this.name}, ${i}`);await this.onUnsubscribe(i,r,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:n}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(i,r){const n={method:oa(r.protocol).subscribe,params:{topic:i}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Vs(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Gt.connection_stalled)}return ls(i+this.clientId)}async rpcBatchSubscribe(i){if(!i.length)return;const r=i[0].relay,n={method:oa(r.protocol).batchSubscribe,params:{topics:i.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Vs(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Gt.connection_stalled)}}rpcUnsubscribe(i,r,n){const a={method:oa(n.protocol).unsubscribe,params:{topic:i,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(i,r){this.setSubscription(i,ec(qs({},r),{id:i})),this.pending.delete(r.topic)}onBatchSubscribe(i){i.length&&i.forEach(r=>{this.setSubscription(r.id,qs({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(i,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,i)&&this.deleteSubscription(r,n),await this.relayer.messages.del(i)}async setRelayerSubscriptions(i){await this.relayer.core.storage.setItem(this.storageKey,i)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(i,r){this.subscriptions.has(i)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:i,subscription:r}),this.addSubscription(i,r))}addSubscription(i,r){this.subscriptions.set(i,qs({},r)),this.topicMap.set(r.topic,i),this.events.emit($r.created,r)}getSubscription(i){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:i});const r=this.subscriptions.get(i);if(!r){const{message:n}=X("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(n)}return r}deleteSubscription(i,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:i,reason:r});const n=this.getSubscription(i);this.subscriptions.delete(i),this.topicMap.delete(n.topic,i),this.events.emit($r.deleted,ec(qs({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit($r.sync)}async reset(){if(this.cached.length){const i=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<i;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit($r.resubscribed)}async restore(){try{const i=await this.getRelayerSubscriptions();if(typeof i>"u"||!i.length)return;if(this.subscriptions.size){const{message:r}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(i){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(i)}}async batchSubscribe(i){if(!i.length)return;const r=await this.rpcBatchSubscribe(i);fs(r)&&this.onBatchSubscribe(r.map((n,a)=>ec(qs({},i[a]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const i=[];this.pending.forEach(r=>{i.push(r)}),await this.batchSubscribe(i)}registerEventListeners(){this.relayer.core.heartbeat.on(ps.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Gt.connect,async()=>{await this.onConnect()}),this.relayer.on(Gt.disconnect,()=>{this.onDisconnect()}),this.events.on($r.created,async i=>{const r=$r.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()}),this.events.on($r.deleted,async i=>{const r=$r.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}async restartToComplete(){this.restartInProgress&&await new Promise(i=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),i())},this.pollingInterval)})}}var cb=Object.defineProperty,al=Object.getOwnPropertySymbols,ub=Object.prototype.hasOwnProperty,hb=Object.prototype.propertyIsEnumerable,ol=(c,i,r)=>i in c?cb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,lb=(c,i)=>{for(var r in i||(i={}))ub.call(i,r)&&ol(c,r,i[r]);if(al)for(var r of al(i))hb.call(i,r)&&ol(c,r,i[r]);return c};class fb extends Pw{constructor(i){super(i),this.protocol="wc",this.version=2,this.events=new Kr.EventEmitter,this.name=L1,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Gt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Gt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(ri.payload,this.onPayloadHandler),this.provider.on(ri.connect,this.onConnectHandler),this.provider.on(ri.disconnect,this.onDisconnectHandler),this.provider.on(ri.error,this.onProviderErrorHandler)},this.core=i.core,this.logger=typeof i.logger<"u"&&typeof i.logger!="string"?Oe.generateChildLogger(i.logger,this.name):Oe.pino(Oe.getDefaultLoggerOptions({level:i.logger||D1})),this.messages=new Z1(this.logger,i.core),this.subscriber=new ob(this,this.logger),this.publisher=new eb(this,this.logger),this.relayUrl=(i==null?void 0:i.relayUrl)||sf,this.projectId=i.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${rl}...`),await this.restartTransport(rl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},j1)}get context(){return Oe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(i,r,n){this.isInitialized(),await this.publisher.publish(i,r,n),await this.recordMessageEvent({topic:i,message:r,publishedAt:Date.now()})}async subscribe(i,r){var n;this.isInitialized();let a=((n=this.subscriber.topicMap.get(i))==null?void 0:n[0])||"";if(a)return a;let l;const d=y=>{y.topic===i&&(this.subscriber.off($r.created,d),l())};return await Promise.all([new Promise(y=>{l=y,this.subscriber.on($r.created,d)}),new Promise(async y=>{a=await this.subscriber.subscribe(i,r),y()})]),a}async unsubscribe(i,r){this.isInitialized(),await this.subscriber.unsubscribe(i,r)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Vs(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(i){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){i&&i!==this.relayUrl&&(this.relayUrl=i,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once($r.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await Vs(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){n(a);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(ri.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(i){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=i||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Oh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(i){return this.staleConnectionErrors.some(r=>i.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const i=await this.core.crypto.signJWT(this.relayUrl);this.provider=new ni(new Jw(sm({sdkVersion:M1,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:i,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(i){const{topic:r,message:n}=i;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(i){const{topic:r,message:n}=i;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,n);return a&&this.logger.debug(`Ignoring duplicate message: ${n}`),a}async onProviderPayload(i){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:i}),mc(i)){if(!i.method.endsWith(q1))return;const r=i.params,{topic:n,message:a,publishedAt:l}=r.data,d={topic:n,message:a,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(lb({type:"event",event:r.id},d)),this.events.emit(r.id,d),await this.acknowledgePayload(i),await this.onMessageEvent(d)}else wc(i)&&this.events.emit(Gt.message_ack,i)}async onMessageEvent(i){await this.shouldIgnoreMessageEvent(i)||(this.events.emit(Gt.message,i),await this.recordMessageEvent(i))}async acknowledgePayload(i){const r=_c(i.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(ri.payload,this.onPayloadHandler),this.provider.off(ri.connect,this.onConnectHandler),this.provider.off(ri.disconnect,this.onDisconnectHandler),this.provider.off(ri.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Gt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let i=await Oh();nm(async r=>{this.initialized&&i!==r&&(i=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Gt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(i=>this.logger.error(i))},ie.toMiliseconds(z1)))}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(i=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),i())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var pb=Object.defineProperty,cl=Object.getOwnPropertySymbols,db=Object.prototype.hasOwnProperty,gb=Object.prototype.propertyIsEnumerable,ul=(c,i,r)=>i in c?pb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,hl=(c,i)=>{for(var r in i||(i={}))db.call(i,r)&&ul(c,r,i[r]);if(cl)for(var r of cl(i))gb.call(i,r)&&ul(c,r,i[r]);return c};class ma extends Sw{constructor(i,r,n,a=bi,l=void 0){super(i,r,n,a),this.core=i,this.logger=r,this.name=n,this.map=new Map,this.version=U1,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!_i(d)?this.map.set(this.getKey(d),d):G0(d)?this.map.set(d.id,d):W0(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,y)=>{this.isInitialized(),this.map.has(d)?await this.update(d,y):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:y}),this.map.set(d,y),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(y=>Object.keys(d).every(w=>Yw(y[w],d[w]))):this.values),this.update=async(d,y)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:y});const w=hl(hl({},this.getData(d)),y);this.map.set(d,w),await this.persist()},this.delete=async(d,y)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:y}),this.map.delete(d),await this.persist())},this.logger=Oe.generateChildLogger(r,this.name),this.storagePrefix=a,this.getKey=l}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(i){await this.core.storage.setItem(this.storageKey,i)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(i){const r=this.map.get(i);if(!r){const{message:n}=X("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const i=await this.getDataStore();if(typeof i>"u"||!i.length)return;if(this.map.size){const{message:r}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(i){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(i)}}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}}class vb{constructor(i,r){this.core=i,this.logger=r,this.name=F1,this.version=B1,this.events=new vc,this.initialized=!1,this.storagePrefix=bi,this.ignoredPayloadTypes=[Rl],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=oc(),a=await this.core.crypto.setSymKey(n),l=Dr(ie.FIVE_MINUTES),d={protocol:rf},y={topic:a,expiry:l,relay:d,active:!1},w=am({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:n,relay:d});return await this.pairings.set(a,y),await this.core.relayer.subscribe(a),this.core.expirer.set(a,l),{topic:a,uri:w}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:a,symKey:l,relay:d}=om(n.uri);let y;if(this.pairings.keys.includes(a)&&(y=this.pairings.get(a),y.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(l,a),await this.core.relayer.subscribe(a,{relay:d}));const w=Dr(ie.FIVE_MINUTES),v={topic:a,relay:d,expiry:w,active:!1};return await this.pairings.set(a,v),this.core.expirer.set(a,w),n.activatePairing&&await this.activate({topic:a}),this.events.emit(Hs.create,v),v},this.activate=async({topic:n})=>{this.isInitialized();const a=Dr(ie.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:a}),this.core.expirer.set(n,a)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:a}=n;if(this.pairings.keys.includes(a)){const l=await this.sendRequest(a,"wc_pairingPing",{}),{done:d,resolve:y,reject:w}=us();this.events.once($t("pairing_ping",l),({error:v})=>{v?w(v):y()}),await d()}},this.updateExpiry=async({topic:n,expiry:a})=>{this.isInitialized(),await this.pairings.update(n,{expiry:a})},this.updateMetadata=async({topic:n,metadata:a})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:a}=n;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",tr("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(n,a,l)=>{const d=Ks(a,l),y=await this.core.crypto.encode(n,d),w=Ls[a].req;return this.core.history.set(n,d),this.core.relayer.publish(n,y,w),d.id},this.sendResult=async(n,a,l)=>{const d=_c(n,l),y=await this.core.crypto.encode(a,d),w=await this.core.history.get(a,n),v=Ls[w.request.method].res;await this.core.relayer.publish(a,y,v),await this.core.history.resolve(d)},this.sendError=async(n,a,l)=>{const d=yc(n,l),y=await this.core.crypto.encode(a,d),w=await this.core.history.get(a,n),v=Ls[w.request.method]?Ls[w.request.method].res:Ls.unregistered_method.res;await this.core.relayer.publish(a,y,v),await this.core.history.resolve(d)},this.deletePairing=async(n,a)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,tr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),a?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(a=>wi(a.expiry));await Promise.all(n.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=n=>{const{topic:a,payload:l}=n;switch(l.method){case"wc_pairingPing":return this.onPairingPingRequest(a,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,l);default:return this.onUnknownRpcMethodRequest(a,l)}},this.onRelayEventResponse=async n=>{const{topic:a,payload:l}=n,d=(await this.core.history.get(a,l.id)).request.method;switch(d){case"wc_pairingPing":return this.onPairingPingResponse(a,l);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(n,a)=>{const{id:l}=a;try{this.isValidPing({topic:n}),await this.sendResult(l,n,!0),this.events.emit(Hs.ping,{id:l,topic:n})}catch(d){await this.sendError(l,n,d),this.logger.error(d)}},this.onPairingPingResponse=(n,a)=>{const{id:l}=a;setTimeout(()=>{mi(a)?this.events.emit($t("pairing_ping",l),{}):si(a)&&this.events.emit($t("pairing_ping",l),{error:a.error})},500)},this.onPairingDeleteRequest=async(n,a)=>{const{id:l}=a;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Hs.delete,{id:l,topic:n})}catch(d){await this.sendError(l,n,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(n,a)=>{const{id:l,method:d}=a;try{if(this.registeredMethods.includes(d))return;const y=tr("WC_METHOD_UNSUPPORTED",d);await this.sendError(l,n,y),this.logger.error(y)}catch(y){await this.sendError(l,n,y),this.logger.error(y)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(tr("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!hr(n)){const{message:a}=X("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(a)}if(!cm(n.uri)){const{message:a}=X("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(a)}},this.isValidPing=async n=>{if(!hr(n)){const{message:l}=X("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(l)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidDisconnect=async n=>{if(!hr(n)){const{message:l}=X("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(l)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async n=>{if(!hs(n,!1)){const{message:a}=X("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(a)}if(!this.pairings.keys.includes(n)){const{message:a}=X("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(a)}if(wi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:a}=X("EXPIRED",`pairing topic: ${n}`);throw new Error(a)}},this.core=i,this.logger=Oe.generateChildLogger(r,this.name),this.pairings=new ma(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Oe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}registerRelayerEvents(){this.core.relayer.on(Gt.message,async i=>{const{topic:r,message:n}=i;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const a=await this.core.crypto.decode(r,n);try{mc(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):wc(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(l){this.logger.error(l)}})}registerExpirerEvents(){this.core.expirer.on(Sr.expired,async i=>{const{topic:r}=Tl(i.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Hs.expire,{topic:r}))})}}class yb extends Ew{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.records=new Map,this.events=new Kr.EventEmitter,this.name=G1,this.version=W1,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,a,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:a,chainId:l}),this.records.has(a.id))return;const d={id:a.id,topic:n,request:{method:a.method,params:a.params||null},chainId:l,expiry:Dr(ie.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(kr.created,d)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const a=await this.getRecord(n.id);typeof a.response>"u"&&(a.response=si(n)?{error:n.error}:{result:n.result},this.records.set(a.id,a),this.events.emit(kr.updated,a))},this.get=async(n,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:a}),await this.getRecord(a)),this.delete=(n,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(l=>{if(l.topic===n){if(typeof a<"u"&&l.id!==a)return;this.records.delete(l.id),this.events.emit(kr.deleted,l)}})},this.exists=async(n,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===n:!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const i=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:Ks(r.request.method,r.request.params,r.id),chainId:r.chainId};return i.push(n)}),i}async setJsonRpcRecords(i){await this.core.storage.setItem(this.storageKey,i)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(i){this.isInitialized();const r=this.records.get(i);if(!r){const{message:n}=X("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(kr.sync)}async restore(){try{const i=await this.getJsonRpcRecords();if(typeof i>"u"||!i.length)return;if(this.records.size){const{message:r}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}}registerEventListeners(){this.events.on(kr.created,i=>{const r=kr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(kr.updated,i=>{const r=kr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(kr.deleted,i=>{const r=kr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.core.heartbeat.on(ps.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(i=>{ie.toMiliseconds(i.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${i.id}`),this.delete(i.topic,i.id))})}catch(i){this.logger.warn(i)}}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}}class mb extends Ow{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.expirations=new Map,this.events=new Kr.EventEmitter,this.name=J1,this.version=Q1,this.cached=[],this.initialized=!1,this.storagePrefix=bi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const a=this.formatTarget(n);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(n,a)=>{this.isInitialized();const l=this.formatTarget(n),d={target:l,expiry:a};this.expirations.set(l,d),this.checkExpiry(l,d),this.events.emit(Sr.created,{target:l,expiration:d})},this.get=n=>{this.isInitialized();const a=this.formatTarget(n);return this.getExpiration(a)},this.del=n=>{if(this.isInitialized(),this.has(n)){const a=this.formatTarget(n),l=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Sr.deleted,{target:a,expiration:l})}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=Oe.generateChildLogger(r,this.name)}get context(){return Oe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(i){if(typeof i=="string")return um(i);if(typeof i=="number")return hm(i);const{message:r}=X("UNKNOWN_TYPE",`Target type: ${typeof i}`);throw new Error(r)}async setExpirations(i){await this.core.storage.setItem(this.storageKey,i)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Sr.sync)}async restore(){try{const i=await this.getExpirations();if(typeof i>"u"||!i.length)return;if(this.expirations.size){const{message:r}=X("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(i){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(i)}}getExpiration(i){const r=this.expirations.get(i);if(!r){const{message:n}=X("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(i,r){const{expiry:n}=r;ie.toMiliseconds(n)-Date.now()<=0&&this.expire(i,r)}expire(i,r){this.expirations.delete(i),this.events.emit(Sr.expired,{target:i,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((i,r)=>this.checkExpiry(r,i))}registerEventListeners(){this.core.heartbeat.on(ps.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Sr.created,i=>{const r=Sr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Sr.expired,i=>{const r=Sr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Sr.deleted,i=>{const r=Sr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}}}class wb extends Rw{constructor(i,r){super(i,r),this.projectId=i,this.logger=r,this.name=Zo,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async()=>{if(this.verifyDisabled||lm()||!Al())return;const n=la;this.verifyUrl!==n&&this.removeIframe(),this.verifyUrl=n;try{await this.createIframe()}catch(a){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(a)}if(!this.initialized){this.removeIframe(),this.verifyUrl=il;try{await this.createIframe()}catch(a){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(a),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const a=(n==null?void 0:n.verifyUrl)||la;let l;try{l=await this.fetchAttestation(n.attestationId,a)}catch(d){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${a}`),this.logger.info(d),l=await this.fetchAttestation(n.attestationId,il)}return l},this.fetchAttestation=async(n,a)=>{this.logger.info(`resolving attestation: ${n} from url: ${a}`);const l=this.startAbortTimer(ie.ONE_SECOND*2),d=await fetch(`${a}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(l),d.status===200?await d.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const a=l=>{l.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),n())};await Promise.race([new Promise(l=>{if(document.getElementById(Zo))return l();window.addEventListener("message",a);const d=document.createElement("iframe");d.id=Zo,d.src=`${this.verifyUrl}/${this.projectId}`,d.style.display="none",document.body.append(d),this.iframe=d,n=l}),new Promise((l,d)=>setTimeout(()=>{window.removeEventListener("message",a),d("verify iframe load timeout")},ie.toMiliseconds(ie.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=Oe.generateChildLogger(r,this.name),this.verifyUrl=la,this.abortController=new AbortController,this.isDevEnv=fm()&&Xw.IS_VITEST}get context(){return Oe.getLoggerContext(this.logger)}startAbortTimer(i){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ie.toMiliseconds(i))}}var _b=Object.defineProperty,ll=Object.getOwnPropertySymbols,bb=Object.prototype.hasOwnProperty,Eb=Object.prototype.propertyIsEnumerable,fl=(c,i,r)=>i in c?_b(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,pl=(c,i)=>{for(var r in i||(i={}))bb.call(i,r)&&fl(c,r,i[r]);if(ll)for(var r of ll(i))Eb.call(i,r)&&fl(c,r,i[r]);return c};class Ic extends bw{constructor(i){super(i),this.protocol=tf,this.version=I1,this.name=Ec,this.events=new Kr.EventEmitter,this.initialized=!1,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.projectId=i==null?void 0:i.projectId,this.relayUrl=(i==null?void 0:i.relayUrl)||sf,this.customStoragePrefix=i!=null&&i.customStoragePrefix?`:${i.customStoragePrefix}`:"";const r=typeof(i==null?void 0:i.logger)<"u"&&typeof(i==null?void 0:i.logger)!="string"?i.logger:Oe.pino(Oe.getDefaultLoggerOptions({level:(i==null?void 0:i.logger)||x1.logger}));this.logger=Oe.generateChildLogger(r,this.name),this.heartbeat=new ps.HeartBeat,this.crypto=new X1(this,this.logger,i==null?void 0:i.keychain),this.history=new yb(this,this.logger),this.expirer=new mb(this,this.logger),this.storage=i!=null&&i.storage?i.storage:new fw(pl(pl({},P1),i==null?void 0:i.storageOptions)),this.relayer=new fb({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new vb(this,this.logger),this.verify=new wb(this.projectId||"",this.logger)}static async init(i){const r=new Ic(i);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(H1,n),r}get context(){return Oe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(i){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,i),this.logger.error(i.message),i}}}const Ib=Ic,nf="wc",af=2,of="client",xc=`${nf}@${af}:${of}:`,tc={name:of,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},dl="WALLETCONNECT_DEEPLINK_CHOICE",xb="proposal",cf="Proposal expired",Pb="session",sa=ie.SEVEN_DAYS,Sb="engine",zs={wc_sessionPropose:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1115}}},rc={min:ie.FIVE_MINUTES,max:ie.SEVEN_DAYS},ii={idle:"IDLE",active:"ACTIVE"},Cb="request",Ob=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Rb=Object.defineProperty,Tb=Object.defineProperties,Ab=Object.getOwnPropertyDescriptors,gl=Object.getOwnPropertySymbols,Nb=Object.prototype.hasOwnProperty,$b=Object.prototype.propertyIsEnumerable,vl=(c,i,r)=>i in c?Rb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,cr=(c,i)=>{for(var r in i||(i={}))Nb.call(i,r)&&vl(c,r,i[r]);if(gl)for(var r of gl(i))$b.call(i,r)&&vl(c,r,i[r]);return c},Ms=(c,i)=>Tb(c,Ab(i));class Db extends Aw{constructor(i){super(i),this.name=Sb,this.events=new vc,this.initialized=!1,this.ignoredPayloadTypes=[Rl],this.requestQueue={state:ii.idle,queue:[]},this.sessionRequestQueue={state:ii.idle,queue:[]},this.requestQueueDelay=ie.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(zs)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ie.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=Ms(cr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:a,requiredNamespaces:l,optionalNamespaces:d,sessionProperties:y,relays:w}=n;let v=a,E,C=!1;if(v&&(C=this.client.core.pairing.pairings.get(v).active),!v||!C){const{topic:he,uri:fe}=await this.client.core.pairing.create();v=he,E=fe}const T=await this.client.core.crypto.generateKeyPair(),j=cr({requiredNamespaces:l,optionalNamespaces:d,relays:w??[{protocol:rf}],proposer:{publicKey:T,metadata:this.client.metadata}},y&&{sessionProperties:y}),{reject:D,resolve:V,done:re}=us(ie.FIVE_MINUTES,cf);if(this.events.once($t("session_connect"),async({error:he,session:fe})=>{if(he)D(he);else if(fe){fe.self.publicKey=T;const pe=Ms(cr({},fe),{requiredNamespaces:fe.requiredNamespaces,optionalNamespaces:fe.optionalNamespaces});await this.client.session.set(fe.topic,pe),await this.setExpiry(fe.topic,fe.expiry),v&&await this.client.core.pairing.updateMetadata({topic:v,metadata:fe.peer.metadata}),V(pe)}}),!v){const{message:he}=X("NO_MATCHING_KEY",`connect() pairing topic: ${v}`);throw new Error(he)}const ce=await this.sendRequest({topic:v,method:"wc_sessionPropose",params:j}),ue=Dr(ie.FIVE_MINUTES);return await this.setProposal(ce,cr({id:ce,expiry:ue},j)),{uri:E,approval:re}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:a,namespaces:l,sessionProperties:d}=r,y=this.client.proposal.get(n);let{pairingTopic:w,proposer:v,requiredNamespaces:E,optionalNamespaces:C}=y;w=w||"",ca(E)||(E=dm(l,"approve()"));const T=await this.client.core.crypto.generateKeyPair(),j=v.publicKey,D=await this.client.core.crypto.generateSharedKey(T,j);w&&n&&(await this.client.core.pairing.updateMetadata({topic:w,metadata:v.metadata}),await this.sendResult({id:n,topic:w,result:{relay:{protocol:a??"irn"},responderPublicKey:T}}),await this.client.proposal.delete(n,tr("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:w}));const V=cr({relay:{protocol:a??"irn"},namespaces:l,requiredNamespaces:E,optionalNamespaces:C,pairingTopic:w,controller:{publicKey:T,metadata:this.client.metadata},expiry:Dr(sa)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(D),await this.sendRequest({topic:D,method:"wc_sessionSettle",params:V,throwOnFailedPublish:!0});const re=Ms(cr({},V),{topic:D,pairingTopic:w,acknowledged:!1,self:V.controller,peer:{publicKey:v.publicKey,metadata:v.metadata},controller:T});return await this.client.session.set(D,re),await this.setExpiry(D,Dr(sa)),{topic:D,acknowledged:()=>new Promise(ce=>setTimeout(()=>ce(this.client.session.get(D)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:a}=r,{pairingTopic:l}=this.client.proposal.get(n);l&&(await this.sendError(n,l,a),await this.client.proposal.delete(n,tr("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:a}=r,l=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:d,resolve:y,reject:w}=us();return this.events.once($t("session_update",l),({error:v})=>{v?w(v):y()}),await this.client.session.update(n,{namespaces:a}),{acknowledged:d}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,a=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:l,resolve:d,reject:y}=us();return this.events.once($t("session_extend",a),({error:w})=>{w?y(w):d()}),await this.setExpiry(n,Dr(sa)),{acknowledged:l}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:a,topic:l,expiry:d}=r,y=qm(),{done:w,resolve:v,reject:E}=us(d,"Request expired. Please try again.");return this.events.once($t("session_request",y),({error:C,result:T})=>{C?E(C):v(T)}),await Promise.all([new Promise(async C=>{await this.sendRequest({clientRpcId:y,topic:l,method:"wc_sessionRequest",params:{request:a,chainId:n},expiry:d,throwOnFailedPublish:!0}).catch(T=>E(T)),this.client.events.emit("session_request_sent",{topic:l,request:a,chainId:n,id:y}),C()}),new Promise(async C=>{const T=await this.client.core.storage.getItem(dl);gm({id:y,topic:l,wcDeepLink:T}),C()}),w()]).then(C=>C[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:a}=r,{id:l}=a;mi(a)?await this.sendResult({id:l,topic:n,result:a.result,throwOnFailedPublish:!0}):si(a)&&await this.sendError(l,n,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const a=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:l,resolve:d,reject:y}=us();this.events.once($t("session_ping",a),({error:w})=>{w?y(w):d()}),await l()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:a,chainId:l}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:a,chainId:l}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:tr("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>vm(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(l=>{var d,y;return((d=l.peerMetadata)==null?void 0:d.url)&&((y=l.peerMetadata)==null?void 0:y.url)===r.peer.metadata.url&&l.topic&&l.topic!==n.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(l=>this.client.core.pairing.disconnect({topic:l.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,tr("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(dl).catch(l=>this.client.logger.warn(l))},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,tr("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(l=>l.id!==r),a&&(this.sessionRequestQueue.state=ii.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=zs.wc_sessionRequest.req.ttl,{id:a,topic:l,params:d,verifyContext:y}=r;await this.client.pendingRequest.set(a,{id:a,topic:l,params:d,verifyContext:y}),n&&this.client.core.expirer.set(a,Dr(n))},this.sendRequest=async r=>{const{topic:n,method:a,params:l,expiry:d,relayRpcId:y,clientRpcId:w,throwOnFailedPublish:v}=r,E=Ks(a,l,w);if(Al()&&Ob.includes(a)){const j=ls(JSON.stringify(E));this.client.core.verify.register({attestationId:j})}const C=await this.client.core.crypto.encode(n,E),T=zs[a].req;return d&&(T.ttl=d),y&&(T.id=y),this.client.core.history.set(n,E),v?(T.internal=Ms(cr({},T.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,C,T)):this.client.core.relayer.publish(n,C,T).catch(j=>this.client.logger.error(j)),E.id},this.sendResult=async r=>{const{id:n,topic:a,result:l,throwOnFailedPublish:d}=r,y=_c(n,l),w=await this.client.core.crypto.encode(a,y),v=await this.client.core.history.get(a,n),E=zs[v.request.method].res;d?(E.internal=Ms(cr({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,w,E)):this.client.core.relayer.publish(a,w,E).catch(C=>this.client.logger.error(C)),await this.client.core.history.resolve(y)},this.sendError=async(r,n,a)=>{const l=yc(r,a),d=await this.client.core.crypto.encode(n,l),y=await this.client.core.history.get(n,r),w=zs[y.request.method].res;this.client.core.relayer.publish(n,d,w),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(a=>{wi(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{wi(a.expiry)&&n.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...n.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ii.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ii.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=ii.idle},this.processRequest=r=>{const{topic:n,payload:a}=r,l=a.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(n,a);case"wc_sessionSettle":return this.onSessionSettleRequest(n,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,a);case"wc_sessionExtend":return this.onSessionExtendRequest(n,a);case"wc_sessionPing":return this.onSessionPingRequest(n,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,a);case"wc_sessionRequest":return this.onSessionRequest(n,a);case"wc_sessionEvent":return this.onSessionEventRequest(n,a);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:a}=r,l=(await this.client.core.history.get(n,a.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(n,a);case"wc_sessionSettle":return this.onSessionSettleResponse(n,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,a);case"wc_sessionExtend":return this.onSessionExtendResponse(n,a);case"wc_sessionPing":return this.onSessionPingResponse(n,a);case"wc_sessionRequest":return this.onSessionRequestResponse(n,a);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:a}=X("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,n)=>{const{params:a,id:l}=n;try{this.isValidConnect(cr({},n.params));const d=Dr(ie.FIVE_MINUTES),y=cr({id:l,pairingTopic:r,expiry:d},a);await this.setProposal(l,y);const w=ls(JSON.stringify(n)),v=await this.getVerifyContext(w,y.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:y,verifyContext:v})}catch(d){await this.sendError(l,r,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(r,n)=>{const{id:a}=n;if(mi(n)){const{result:l}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const d=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const y=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:y});const w=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:w});const v=await this.client.core.crypto.generateSharedKey(y,w);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:v});const E=await this.client.core.relayer.subscribe(v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:E}),await this.client.core.pairing.activate({topic:r})}else si(n)&&(await this.client.proposal.delete(a,tr("USER_DISCONNECTED")),this.events.emit($t("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:a,params:l}=n;try{this.isValidSessionSettleRequest(l);const{relay:d,controller:y,expiry:w,namespaces:v,requiredNamespaces:E,optionalNamespaces:C,sessionProperties:T,pairingTopic:j}=n.params,D=cr({topic:r,relay:d,expiry:w,namespaces:v,acknowledged:!0,pairingTopic:j,requiredNamespaces:E,optionalNamespaces:C,controller:y.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:y.publicKey,metadata:y.metadata}},T&&{sessionProperties:T});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit($t("session_connect"),{session:D}),this.cleanupDuplicatePairings(D)}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(r,n)=>{const{id:a}=n;mi(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit($t("session_approve",a),{})):si(n)&&(await this.client.session.delete(r,tr("USER_DISCONNECTED")),this.events.emit($t("session_approve",a),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:a,id:l}=n;try{const d=`${r}_session_update`,y=ta.get(d);if(y&&this.isRequestOutOfSync(y,l)){this.client.logger.info(`Discarding out of sync request - ${l}`);return}this.isValidUpdate(cr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:l,topic:r,result:!0}),this.client.events.emit("session_update",{id:l,topic:r,params:a}),ta.set(d,l)}catch(d){await this.sendError(l,r,d),this.client.logger.error(d)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:a}=n;mi(n)?this.events.emit($t("session_update",a),{}):si(n)&&this.events.emit($t("session_update",a),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:a}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Dr(sa)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(r,n)=>{const{id:a}=n;mi(n)?this.events.emit($t("session_extend",a),{}):si(n)&&this.events.emit($t("session_extend",a),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:a}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(l){await this.sendError(a,r,l),this.client.logger.error(l)}},this.onSessionPingResponse=(r,n)=>{const{id:a}=n;setTimeout(()=>{mi(n)?this.events.emit($t("session_ping",a),{}):si(n)&&this.events.emit($t("session_ping",a),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:a}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(Gt.publish,async()=>{l(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(l){this.client.logger.error(l)}},this.onSessionRequest=async(r,n)=>{const{id:a,params:l}=n;try{this.isValidRequest(cr({topic:r},l));const d=ls(JSON.stringify(Ks("wc_sessionRequest",l,a))),y=this.client.session.get(r),w=await this.getVerifyContext(d,y.peer.metadata),v={id:a,topic:r,params:l,verifyContext:w};await this.setPendingSessionRequest(v),this.addSessionRequestToSessionRequestQueue(v),this.processSessionRequestQueue()}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(r,n)=>{const{id:a}=n;mi(n)?this.events.emit($t("session_request",a),{result:n.result}):si(n)&&this.events.emit($t("session_request",a),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:a,params:l}=n;try{const d=`${r}_session_event_${l.event.name}`,y=ta.get(d);if(y&&this.isRequestOutOfSync(y,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(cr({topic:r},l)),this.client.events.emit("session_event",{id:a,topic:r,params:l}),ta.set(d,a)}catch(d){await this.sendError(a,r,d),this.client.logger.error(d)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ii.idle,this.processSessionRequestQueue()},ie.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ii.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ii.active,this.client.events.emit("session_request",r)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=r=>{if(r.active)return;const n=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,Ks("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer},n.id))},this.isValidConnect=async r=>{if(!hr(r)){const{message:w}=X("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(w)}const{pairingTopic:n,requiredNamespaces:a,optionalNamespaces:l,sessionProperties:d,relays:y}=r;if(_i(n)||await this.isValidPairingTopic(n),!ym(y,!0)){const{message:w}=X("MISSING_OR_INVALID",`connect() relays: ${y}`);throw new Error(w)}!_i(a)&&ca(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!_i(l)&&ca(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),_i(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(r,n)=>{const a=mm(r,"connect()",n);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!hr(r))throw new Error(X("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:a,relayProtocol:l,sessionProperties:d}=r;await this.isValidProposalId(n);const y=this.client.proposal.get(n),w=Vo(a,"approve()");if(w)throw new Error(w.message);const v=Rh(y.requiredNamespaces,a,"approve()");if(v)throw new Error(v.message);if(!hs(l,!0)){const{message:E}=X("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(E)}_i(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async r=>{if(!hr(r)){const{message:l}=X("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(l)}const{id:n,reason:a}=r;if(await this.isValidProposalId(n),!wm(a)){const{message:l}=X("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidSessionSettleRequest=r=>{if(!hr(r)){const{message:v}=X("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(v)}const{relay:n,controller:a,namespaces:l,expiry:d}=r;if(!_m(n)){const{message:v}=X("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(v)}const y=bm(a,"onSessionSettleRequest()");if(y)throw new Error(y.message);const w=Vo(l,"onSessionSettleRequest()");if(w)throw new Error(w.message);if(wi(d)){const{message:v}=X("EXPIRED","onSessionSettleRequest()");throw new Error(v)}},this.isValidUpdate=async r=>{if(!hr(r)){const{message:w}=X("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(w)}const{topic:n,namespaces:a}=r;await this.isValidSessionTopic(n);const l=this.client.session.get(n),d=Vo(a,"update()");if(d)throw new Error(d.message);const y=Rh(l.requiredNamespaces,a,"update()");if(y)throw new Error(y.message)},this.isValidExtend=async r=>{if(!hr(r)){const{message:a}=X("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!hr(r)){const{message:w}=X("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(w)}const{topic:n,request:a,chainId:l,expiry:d}=r;await this.isValidSessionTopic(n);const{namespaces:y}=this.client.session.get(n);if(!Th(y,l)){const{message:w}=X("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(w)}if(!Em(a)){const{message:w}=X("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(w)}if(!Im(y,l,a.method)){const{message:w}=X("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(w)}if(d&&!xm(d,rc)){const{message:w}=X("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${rc.min} and ${rc.max}`);throw new Error(w)}},this.isValidRespond=async r=>{if(!hr(r)){const{message:l}=X("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(l)}const{topic:n,response:a}=r;if(await this.isValidSessionTopic(n),!Pm(a)){const{message:l}=X("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(l)}},this.isValidPing=async r=>{if(!hr(r)){const{message:a}=X("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!hr(r)){const{message:y}=X("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(y)}const{topic:n,event:a,chainId:l}=r;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!Th(d,l)){const{message:y}=X("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(y)}if(!Sm(a)){const{message:y}=X("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(y)}if(!Cm(d,l,a.name)){const{message:y}=X("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(y)}},this.isValidDisconnect=async r=>{if(!hr(r)){const{message:a}=X("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const a={verified:{verifyUrl:n.verifyUrl||la,validation:"UNKNOWN",origin:n.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});l&&(a.verified.origin=l.origin,a.verified.isScam=l.isScam,a.verified.validation=l.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.info(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(a=>{if(!hs(a,!1)){const{message:l}=X("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(l)}})}}async isInitialized(){if(!this.initialized){const{message:i}=X("NOT_INITIALIZED",this.name);throw new Error(i)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Gt.message,async i=>{const{topic:r,message:n}=i;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const a=await this.client.core.crypto.decode(r,n);try{mc(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):wc(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(l){this.client.logger.error(l)}})}registerExpirerEvents(){this.client.core.expirer.on(Sr.expired,async i=>{const{topic:r,id:n}=Tl(i.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,X("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Hs.create,i=>this.onPairingCreated(i))}isValidPairingTopic(i){if(!hs(i,!1)){const{message:r}=X("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(i)){const{message:r}=X("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(r)}if(wi(this.client.core.pairing.pairings.get(i).expiry)){const{message:r}=X("EXPIRED",`pairing topic: ${i}`);throw new Error(r)}}async isValidSessionTopic(i){if(!hs(i,!1)){const{message:r}=X("MISSING_OR_INVALID",`session topic should be a string: ${i}`);throw new Error(r)}if(!this.client.session.keys.includes(i)){const{message:r}=X("NO_MATCHING_KEY",`session topic doesn't exist: ${i}`);throw new Error(r)}if(wi(this.client.session.get(i).expiry)){await this.deleteSession(i);const{message:r}=X("EXPIRED",`session topic: ${i}`);throw new Error(r)}}async isValidSessionOrPairingTopic(i){if(this.client.session.keys.includes(i))await this.isValidSessionTopic(i);else if(this.client.core.pairing.pairings.keys.includes(i))this.isValidPairingTopic(i);else if(hs(i,!1)){const{message:r}=X("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${i}`);throw new Error(r)}else{const{message:r}=X("MISSING_OR_INVALID",`session or pairing topic should be a string: ${i}`);throw new Error(r)}}async isValidProposalId(i){if(!Om(i)){const{message:r}=X("MISSING_OR_INVALID",`proposal id should be a number: ${i}`);throw new Error(r)}if(!this.client.proposal.keys.includes(i)){const{message:r}=X("NO_MATCHING_KEY",`proposal id doesn't exist: ${i}`);throw new Error(r)}if(wi(this.client.proposal.get(i).expiry)){await this.deleteProposal(i);const{message:r}=X("EXPIRED",`proposal id: ${i}`);throw new Error(r)}}}class Lb extends ma{constructor(i,r){super(i,r,xb,xc),this.core=i,this.logger=r}}class qb extends ma{constructor(i,r){super(i,r,Pb,xc),this.core=i,this.logger=r}}class zb extends ma{constructor(i,r){super(i,r,Cb,xc,n=>n.id),this.core=i,this.logger=r}}let Mb=class uf extends Tw{constructor(i){super(i),this.protocol=nf,this.version=af,this.name=tc.name,this.events=new Kr.EventEmitter,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(a){throw this.logger.error(a.message),a}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(a){throw this.logger.error(a.message),a}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(a){throw this.logger.error(a.message),a}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(a){throw this.logger.error(a.message),a}},this.update=async n=>{try{return await this.engine.update(n)}catch(a){throw this.logger.error(a.message),a}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(a){throw this.logger.error(a.message),a}},this.request=async n=>{try{return await this.engine.request(n)}catch(a){throw this.logger.error(a.message),a}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(a){throw this.logger.error(a.message),a}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(a){throw this.logger.error(a.message),a}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(a){throw this.logger.error(a.message),a}},this.find=n=>{try{return this.engine.find(n)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(i==null?void 0:i.name)||tc.name,this.metadata=(i==null?void 0:i.metadata)||pm();const r=typeof(i==null?void 0:i.logger)<"u"&&typeof(i==null?void 0:i.logger)!="string"?i.logger:Oe.pino(Oe.getDefaultLoggerOptions({level:(i==null?void 0:i.logger)||tc.logger}));this.core=(i==null?void 0:i.core)||new Ib(i),this.logger=Oe.generateChildLogger(r,this.name),this.session=new qb(this.core,this.logger),this.proposal=new Lb(this.core,this.logger),this.pendingRequest=new zb(this.core,this.logger),this.engine=new Db(this)}static async init(i){const r=new uf(i);return await r.initialize(),r}get context(){return Oe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(i){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(i.message),i}}};const yl="error",jb="wss://relay.walletconnect.com",Ub="wc",Hb="universal_provider",ml=`${Ub}@2:${Hb}:`,kb="https://rpc.walletconnect.com/v1/",ai={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var js=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(c,i){(function(){var r,n="4.17.21",a=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",y="Invalid `variable` option passed into `_.template`",w="__lodash_hash_undefined__",v=500,E="__lodash_placeholder__",C=1,T=2,j=4,D=1,V=2,re=1,ce=2,ue=4,he=8,fe=16,pe=32,$=64,k=128,W=256,ve=512,te=30,Ee="...",Re=800,et=16,R=1,M=2,je=3,Te=1/0,J=9007199254740991,F=17976931348623157e292,K=NaN,B=4294967295,ut=B-1,ke=B>>>1,Lr=[["ary",k],["bind",re],["bindKey",ce],["curry",he],["curryRight",fe],["flip",ve],["partial",pe],["partialRight",$],["rearg",W]],_e="[object Arguments]",It="[object Array]",N="[object AsyncFunction]",A="[object Boolean]",S="[object Date]",u="[object DOMException]",b="[object Error]",Z="[object Function]",oe="[object GeneratorFunction]",me="[object Map]",Ae="[object Number]",$e="[object Null]",xe="[object Object]",xt="[object Promise]",mt="[object Proxy]",nt="[object RegExp]",Le="[object Set]",Je="[object String]",Qe="[object Symbol]",at="[object Undefined]",Ue="[object WeakMap]",Ye="[object WeakSet]",Ne="[object ArrayBuffer]",Ke="[object DataView]",ht="[object Float32Array]",ze="[object Float64Array]",Pt="[object Int8Array]",Dt="[object Int16Array]",Ht="[object Int32Array]",kt="[object Uint8Array]",zt="[object Uint8ClampedArray]",Wt="[object Uint16Array]",rr="[object Uint32Array]",qr=/\b__p \+= '';/g,Jt=/\b(__p \+=) '' \+/g,Vr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,oi=/&(?:amp|lt|gt|quot|#39);/g,xi=/[&<>"']/g,lt=RegExp(oi.source),tt=RegExp(xi.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ot=/<%=([\s\S]+?)%>/g,rt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,St=/^\w*$/,Ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,Ot=RegExp(dt.source),gt=/^\s+/,wt=/\s/,vt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,We=/\{\n\/\* \[wrapped with (.+)\] \*/,Rt=/,? & /,Tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,wa=/[()=,{}\[\]\/\s]/,_a=/\\(\\)?/g,ba=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yr=/\w*$/,Ea=/^[-+]0x[0-9a-f]+$/i,Ia=/^0b[01]+$/i,xa=/^\[object .+?Constructor\]$/,Pa=/^0o[0-7]+$/i,Sa=/^(?:0|[1-9]\d*)$/,Fr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ki=/($^)/,Ca=/['\n\r\u2028\u2029\\]/g,Vi="\\ud800-\\udfff",Oa="\\u0300-\\u036f",Ra="\\ufe20-\\ufe2f",Fi="\\u20d0-\\u20ff",Js=Oa+Ra+Fi,Qs="\\u2700-\\u27bf",Cr="a-z\\xdf-\\xf6\\xf8-\\xff",Ta="\\xac\\xb1\\xd7\\xf7",Aa="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Na="\\u2000-\\u206f",$a=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ys="A-Z\\xc0-\\xd6\\xd8-\\xde",Xs="\\ufe0e\\ufe0f",Pi=Ta+Aa+Na+$a,ds="[']",Si="["+Vi+"]",gs="["+Pi+"]",Ci="["+Js+"]",Zs="\\d+",Da="["+Qs+"]",en="["+Cr+"]",tn="[^"+Vi+Pi+Zs+Qs+Cr+Ys+"]",Bi="\\ud83c[\\udffb-\\udfff]",La="(?:"+Ci+"|"+Bi+")",rn="[^"+Vi+"]",Gi="(?:\\ud83c[\\udde6-\\uddff]){2}",ci="[\\ud800-\\udbff][\\udc00-\\udfff]",lr="["+Ys+"]",sn="\\u200d",nn="(?:"+en+"|"+tn+")",zr="(?:"+lr+"|"+tn+")",an="(?:"+ds+"(?:d|ll|m|re|s|t|ve))?",on="(?:"+ds+"(?:D|LL|M|RE|S|T|VE))?",cn=La+"?",un="["+Xs+"]?",qa="(?:"+sn+"(?:"+[rn,Gi,ci].join("|")+")"+un+cn+")*",Br="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",hn="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ln=un+cn+qa,Wi="(?:"+[Da,Gi,ci].join("|")+")"+ln,za="(?:"+[rn+Ci+"?",Ci,Gi,ci,Si].join("|")+")",vs=RegExp(ds,"g"),Ma=RegExp(Ci,"g"),Ji=RegExp(Bi+"(?="+Bi+")|"+za+ln,"g"),fn=RegExp([lr+"?"+en+"+"+an+"(?="+[gs,lr,"$"].join("|")+")",zr+"+"+on+"(?="+[gs,lr+nn,"$"].join("|")+")",lr+"?"+nn+"+"+an,lr+"+"+on,hn,Br,Zs,Wi].join("|"),"g"),pn=RegExp("["+sn+Vi+Js+Xs+"]"),Oi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,dn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ja=-1,Ve={};Ve[ht]=Ve[ze]=Ve[Pt]=Ve[Dt]=Ve[Ht]=Ve[kt]=Ve[zt]=Ve[Wt]=Ve[rr]=!0,Ve[_e]=Ve[It]=Ve[Ne]=Ve[A]=Ve[Ke]=Ve[S]=Ve[b]=Ve[Z]=Ve[me]=Ve[Ae]=Ve[xe]=Ve[nt]=Ve[Le]=Ve[Je]=Ve[Ue]=!1;var He={};He[_e]=He[It]=He[Ne]=He[Ke]=He[A]=He[S]=He[ht]=He[ze]=He[Pt]=He[Dt]=He[Ht]=He[me]=He[Ae]=He[xe]=He[nt]=He[Le]=He[Je]=He[Qe]=He[kt]=He[zt]=He[Wt]=He[rr]=!0,He[b]=He[Z]=He[Ue]=!1;var g={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},I={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},U={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Q={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Fe=parseFloat,de=parseInt,Xe=typeof js=="object"&&js&&js.Object===Object&&js,At=typeof self=="object"&&self&&self.Object===Object&&self,Se=Xe||At||Function("return this")(),Be=i&&!i.nodeType&&i,_t=Be&&!0&&c&&!c.nodeType&&c,ir=_t&&_t.exports===Be,Nt=ir&&Xe.process,Ze=function(){try{var x=_t&&_t.require&&_t.require("util").types;return x||Nt&&Nt.binding&&Nt.binding("util")}catch{}}(),Qt=Ze&&Ze.isArrayBuffer,Or=Ze&&Ze.isDate,mr=Ze&&Ze.isMap,Mr=Ze&&Ze.isRegExp,ys=Ze&&Ze.isSet,Ri=Ze&&Ze.isTypedArray;function Mt(x,L,O){switch(O.length){case 0:return x.call(L);case 1:return x.call(L,O[0]);case 2:return x.call(L,O[0],O[1]);case 3:return x.call(L,O[0],O[1],O[2])}return x.apply(L,O)}function ff(x,L,O,Y){for(var le=-1,De=x==null?0:x.length;++le<De;){var Lt=x[le];L(Y,Lt,O(Lt),x)}return Y}function wr(x,L){for(var O=-1,Y=x==null?0:x.length;++O<Y&&L(x[O],O,x)!==!1;);return x}function pf(x,L){for(var O=x==null?0:x.length;O--&&L(x[O],O,x)!==!1;);return x}function Cc(x,L){for(var O=-1,Y=x==null?0:x.length;++O<Y;)if(!L(x[O],O,x))return!1;return!0}function ui(x,L){for(var O=-1,Y=x==null?0:x.length,le=0,De=[];++O<Y;){var Lt=x[O];L(Lt,O,x)&&(De[le++]=Lt)}return De}function gn(x,L){var O=x==null?0:x.length;return!!O&&Qi(x,L,0)>-1}function Ua(x,L,O){for(var Y=-1,le=x==null?0:x.length;++Y<le;)if(O(L,x[Y]))return!0;return!1}function it(x,L){for(var O=-1,Y=x==null?0:x.length,le=Array(Y);++O<Y;)le[O]=L(x[O],O,x);return le}function hi(x,L){for(var O=-1,Y=L.length,le=x.length;++O<Y;)x[le+O]=L[O];return x}function Ha(x,L,O,Y){var le=-1,De=x==null?0:x.length;for(Y&&De&&(O=x[++le]);++le<De;)O=L(O,x[le],le,x);return O}function df(x,L,O,Y){var le=x==null?0:x.length;for(Y&&le&&(O=x[--le]);le--;)O=L(O,x[le],le,x);return O}function ka(x,L){for(var O=-1,Y=x==null?0:x.length;++O<Y;)if(L(x[O],O,x))return!0;return!1}var gf=Ka("length");function vf(x){return x.split("")}function yf(x){return x.match(Tt)||[]}function Oc(x,L,O){var Y;return O(x,function(le,De,Lt){if(L(le,De,Lt))return Y=De,!1}),Y}function vn(x,L,O,Y){for(var le=x.length,De=O+(Y?1:-1);Y?De--:++De<le;)if(L(x[De],De,x))return De;return-1}function Qi(x,L,O){return L===L?Rf(x,L,O):vn(x,Rc,O)}function mf(x,L,O,Y){for(var le=O-1,De=x.length;++le<De;)if(Y(x[le],L))return le;return-1}function Rc(x){return x!==x}function Tc(x,L){var O=x==null?0:x.length;return O?Fa(x,L)/O:K}function Ka(x){return function(L){return L==null?r:L[x]}}function Va(x){return function(L){return x==null?r:x[L]}}function Ac(x,L,O,Y,le){return le(x,function(De,Lt,Ge){O=Y?(Y=!1,De):L(O,De,Lt,Ge)}),O}function wf(x,L){var O=x.length;for(x.sort(L);O--;)x[O]=x[O].value;return x}function Fa(x,L){for(var O,Y=-1,le=x.length;++Y<le;){var De=L(x[Y]);De!==r&&(O=O===r?De:O+De)}return O}function Ba(x,L){for(var O=-1,Y=Array(x);++O<x;)Y[O]=L(O);return Y}function _f(x,L){return it(L,function(O){return[O,x[O]]})}function Nc(x){return x&&x.slice(0,qc(x)+1).replace(gt,"")}function fr(x){return function(L){return x(L)}}function Ga(x,L){return it(L,function(O){return x[O]})}function ms(x,L){return x.has(L)}function $c(x,L){for(var O=-1,Y=x.length;++O<Y&&Qi(L,x[O],0)>-1;);return O}function Dc(x,L){for(var O=x.length;O--&&Qi(L,x[O],0)>-1;);return O}function bf(x,L){for(var O=x.length,Y=0;O--;)x[O]===L&&++Y;return Y}var Ef=Va(g),If=Va(I);function xf(x){return"\\"+Q[x]}function Pf(x,L){return x==null?r:x[L]}function Yi(x){return pn.test(x)}function Sf(x){return Oi.test(x)}function Cf(x){for(var L,O=[];!(L=x.next()).done;)O.push(L.value);return O}function Wa(x){var L=-1,O=Array(x.size);return x.forEach(function(Y,le){O[++L]=[le,Y]}),O}function Lc(x,L){return function(O){return x(L(O))}}function li(x,L){for(var O=-1,Y=x.length,le=0,De=[];++O<Y;){var Lt=x[O];(Lt===L||Lt===E)&&(x[O]=E,De[le++]=O)}return De}function yn(x){var L=-1,O=Array(x.size);return x.forEach(function(Y){O[++L]=Y}),O}function Of(x){var L=-1,O=Array(x.size);return x.forEach(function(Y){O[++L]=[Y,Y]}),O}function Rf(x,L,O){for(var Y=O-1,le=x.length;++Y<le;)if(x[Y]===L)return Y;return-1}function Tf(x,L,O){for(var Y=O+1;Y--;)if(x[Y]===L)return Y;return Y}function Xi(x){return Yi(x)?Nf(x):gf(x)}function Rr(x){return Yi(x)?$f(x):vf(x)}function qc(x){for(var L=x.length;L--&&wt.test(x.charAt(L)););return L}var Af=Va(U);function Nf(x){for(var L=Ji.lastIndex=0;Ji.test(x);)++L;return L}function $f(x){return x.match(Ji)||[]}function Df(x){return x.match(fn)||[]}var Lf=function x(L){L=L==null?Se:Zi.defaults(Se.Object(),L,Zi.pick(Se,dn));var O=L.Array,Y=L.Date,le=L.Error,De=L.Function,Lt=L.Math,Ge=L.Object,Ja=L.RegExp,qf=L.String,_r=L.TypeError,mn=O.prototype,zf=De.prototype,es=Ge.prototype,wn=L["__core-js_shared__"],_n=zf.toString,Me=es.hasOwnProperty,Mf=0,zc=function(){var e=/[^.]+$/.exec(wn&&wn.keys&&wn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),bn=es.toString,jf=_n.call(Ge),Uf=Se._,Hf=Ja("^"+_n.call(Me).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),En=ir?L.Buffer:r,fi=L.Symbol,In=L.Uint8Array,Mc=En?En.allocUnsafe:r,xn=Lc(Ge.getPrototypeOf,Ge),jc=Ge.create,Uc=es.propertyIsEnumerable,Pn=mn.splice,Hc=fi?fi.isConcatSpreadable:r,ws=fi?fi.iterator:r,Ti=fi?fi.toStringTag:r,Sn=function(){try{var e=Li(Ge,"defineProperty");return e({},"",{}),e}catch{}}(),kf=L.clearTimeout!==Se.clearTimeout&&L.clearTimeout,Kf=Y&&Y.now!==Se.Date.now&&Y.now,Vf=L.setTimeout!==Se.setTimeout&&L.setTimeout,Cn=Lt.ceil,On=Lt.floor,Qa=Ge.getOwnPropertySymbols,Ff=En?En.isBuffer:r,kc=L.isFinite,Bf=mn.join,Gf=Lc(Ge.keys,Ge),qt=Lt.max,Ft=Lt.min,Wf=Y.now,Jf=L.parseInt,Kc=Lt.random,Qf=mn.reverse,Ya=Li(L,"DataView"),_s=Li(L,"Map"),Xa=Li(L,"Promise"),ts=Li(L,"Set"),bs=Li(L,"WeakMap"),Es=Li(Ge,"create"),Rn=bs&&new bs,rs={},Yf=qi(Ya),Xf=qi(_s),Zf=qi(Xa),ep=qi(ts),tp=qi(bs),Tn=fi?fi.prototype:r,Is=Tn?Tn.valueOf:r,Vc=Tn?Tn.toString:r;function f(e){if(yt(e)&&!ge(e)&&!(e instanceof Pe)){if(e instanceof br)return e;if(Me.call(e,"__wrapped__"))return Fu(e)}return new br(e)}var is=function(){function e(){}return function(t){if(!ct(t))return{};if(jc)return jc(t);e.prototype=t;var s=new e;return e.prototype=r,s}}();function An(){}function br(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=r}f.templateSettings={escape:ft,evaluate:pt,interpolate:ot,variable:"",imports:{_:f}},f.prototype=An.prototype,f.prototype.constructor=f,br.prototype=is(An.prototype),br.prototype.constructor=br;function Pe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=B,this.__views__=[]}function rp(){var e=new Pe(this.__wrapped__);return e.__actions__=sr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=sr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=sr(this.__views__),e}function ip(){if(this.__filtered__){var e=new Pe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function sp(){var e=this.__wrapped__.value(),t=this.__dir__,s=ge(e),o=t<0,h=s?e.length:0,p=vd(0,h,this.__views__),m=p.start,_=p.end,P=_-m,q=o?_:m-1,z=this.__iteratees__,H=z.length,G=0,ee=Ft(P,this.__takeCount__);if(!s||!o&&h==P&&ee==P)return du(e,this.__actions__);var ne=[];e:for(;P--&&G<ee;){q+=t;for(var we=-1,ae=e[q];++we<H;){var Ie=z[we],Ce=Ie.iteratee,gr=Ie.type,Zt=Ce(ae);if(gr==M)ae=Zt;else if(!Zt){if(gr==R)continue e;break e}}ne[G++]=ae}return ne}Pe.prototype=is(An.prototype),Pe.prototype.constructor=Pe;function Ai(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var o=e[t];this.set(o[0],o[1])}}function np(){this.__data__=Es?Es(null):{},this.size=0}function ap(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function op(e){var t=this.__data__;if(Es){var s=t[e];return s===w?r:s}return Me.call(t,e)?t[e]:r}function cp(e){var t=this.__data__;return Es?t[e]!==r:Me.call(t,e)}function up(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Es&&t===r?w:t,this}Ai.prototype.clear=np,Ai.prototype.delete=ap,Ai.prototype.get=op,Ai.prototype.has=cp,Ai.prototype.set=up;function Gr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var o=e[t];this.set(o[0],o[1])}}function hp(){this.__data__=[],this.size=0}function lp(e){var t=this.__data__,s=Nn(t,e);if(s<0)return!1;var o=t.length-1;return s==o?t.pop():Pn.call(t,s,1),--this.size,!0}function fp(e){var t=this.__data__,s=Nn(t,e);return s<0?r:t[s][1]}function pp(e){return Nn(this.__data__,e)>-1}function dp(e,t){var s=this.__data__,o=Nn(s,e);return o<0?(++this.size,s.push([e,t])):s[o][1]=t,this}Gr.prototype.clear=hp,Gr.prototype.delete=lp,Gr.prototype.get=fp,Gr.prototype.has=pp,Gr.prototype.set=dp;function Wr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var o=e[t];this.set(o[0],o[1])}}function gp(){this.size=0,this.__data__={hash:new Ai,map:new(_s||Gr),string:new Ai}}function vp(e){var t=Vn(this,e).delete(e);return this.size-=t?1:0,t}function yp(e){return Vn(this,e).get(e)}function mp(e){return Vn(this,e).has(e)}function wp(e,t){var s=Vn(this,e),o=s.size;return s.set(e,t),this.size+=s.size==o?0:1,this}Wr.prototype.clear=gp,Wr.prototype.delete=vp,Wr.prototype.get=yp,Wr.prototype.has=mp,Wr.prototype.set=wp;function Ni(e){var t=-1,s=e==null?0:e.length;for(this.__data__=new Wr;++t<s;)this.add(e[t])}function _p(e){return this.__data__.set(e,w),this}function bp(e){return this.__data__.has(e)}Ni.prototype.add=Ni.prototype.push=_p,Ni.prototype.has=bp;function Tr(e){var t=this.__data__=new Gr(e);this.size=t.size}function Ep(){this.__data__=new Gr,this.size=0}function Ip(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}function xp(e){return this.__data__.get(e)}function Pp(e){return this.__data__.has(e)}function Sp(e,t){var s=this.__data__;if(s instanceof Gr){var o=s.__data__;if(!_s||o.length<a-1)return o.push([e,t]),this.size=++s.size,this;s=this.__data__=new Wr(o)}return s.set(e,t),this.size=s.size,this}Tr.prototype.clear=Ep,Tr.prototype.delete=Ip,Tr.prototype.get=xp,Tr.prototype.has=Pp,Tr.prototype.set=Sp;function Fc(e,t){var s=ge(e),o=!s&&zi(e),h=!s&&!o&&yi(e),p=!s&&!o&&!h&&os(e),m=s||o||h||p,_=m?Ba(e.length,qf):[],P=_.length;for(var q in e)(t||Me.call(e,q))&&!(m&&(q=="length"||h&&(q=="offset"||q=="parent")||p&&(q=="buffer"||q=="byteLength"||q=="byteOffset")||Xr(q,P)))&&_.push(q);return _}function Bc(e){var t=e.length;return t?e[uo(0,t-1)]:r}function Cp(e,t){return Fn(sr(e),$i(t,0,e.length))}function Op(e){return Fn(sr(e))}function Za(e,t,s){(s!==r&&!Ar(e[t],s)||s===r&&!(t in e))&&Jr(e,t,s)}function xs(e,t,s){var o=e[t];(!(Me.call(e,t)&&Ar(o,s))||s===r&&!(t in e))&&Jr(e,t,s)}function Nn(e,t){for(var s=e.length;s--;)if(Ar(e[s][0],t))return s;return-1}function Rp(e,t,s,o){return pi(e,function(h,p,m){t(o,h,s(h),m)}),o}function Gc(e,t){return e&&Ur(t,jt(t),e)}function Tp(e,t){return e&&Ur(t,ar(t),e)}function Jr(e,t,s){t=="__proto__"&&Sn?Sn(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}function eo(e,t){for(var s=-1,o=t.length,h=O(o),p=e==null;++s<o;)h[s]=p?r:Lo(e,t[s]);return h}function $i(e,t,s){return e===e&&(s!==r&&(e=e<=s?e:s),t!==r&&(e=e>=t?e:t)),e}function Er(e,t,s,o,h,p){var m,_=t&C,P=t&T,q=t&j;if(s&&(m=h?s(e,o,h,p):s(e)),m!==r)return m;if(!ct(e))return e;var z=ge(e);if(z){if(m=md(e),!_)return sr(e,m)}else{var H=Bt(e),G=H==Z||H==oe;if(yi(e))return yu(e,_);if(H==xe||H==_e||G&&!h){if(m=P||G?{}:qu(e),!_)return P?od(e,Tp(m,e)):ad(e,Gc(m,e))}else{if(!He[H])return h?e:{};m=wd(e,H,_)}}p||(p=new Tr);var ee=p.get(e);if(ee)return ee;p.set(e,m),lh(e)?e.forEach(function(ae){m.add(Er(ae,t,s,ae,e,p))}):uh(e)&&e.forEach(function(ae,Ie){m.set(Ie,Er(ae,t,s,Ie,e,p))});var ne=q?P?bo:_o:P?ar:jt,we=z?r:ne(e);return wr(we||e,function(ae,Ie){we&&(Ie=ae,ae=e[Ie]),xs(m,Ie,Er(ae,t,s,Ie,e,p))}),m}function Ap(e){var t=jt(e);return function(s){return Wc(s,e,t)}}function Wc(e,t,s){var o=s.length;if(e==null)return!o;for(e=Ge(e);o--;){var h=s[o],p=t[h],m=e[h];if(m===r&&!(h in e)||!p(m))return!1}return!0}function Jc(e,t,s){if(typeof e!="function")throw new _r(d);return As(function(){e.apply(r,s)},t)}function Ps(e,t,s,o){var h=-1,p=gn,m=!0,_=e.length,P=[],q=t.length;if(!_)return P;s&&(t=it(t,fr(s))),o?(p=Ua,m=!1):t.length>=a&&(p=ms,m=!1,t=new Ni(t));e:for(;++h<_;){var z=e[h],H=s==null?z:s(z);if(z=o||z!==0?z:0,m&&H===H){for(var G=q;G--;)if(t[G]===H)continue e;P.push(z)}else p(t,H,o)||P.push(z)}return P}var pi=Eu(jr),Qc=Eu(ro,!0);function Np(e,t){var s=!0;return pi(e,function(o,h,p){return s=!!t(o,h,p),s}),s}function $n(e,t,s){for(var o=-1,h=e.length;++o<h;){var p=e[o],m=t(p);if(m!=null&&(_===r?m===m&&!dr(m):s(m,_)))var _=m,P=p}return P}function $p(e,t,s,o){var h=e.length;for(s=ye(s),s<0&&(s=-s>h?0:h+s),o=o===r||o>h?h:ye(o),o<0&&(o+=h),o=s>o?0:ph(o);s<o;)e[s++]=t;return e}function Yc(e,t){var s=[];return pi(e,function(o,h,p){t(o,h,p)&&s.push(o)}),s}function Kt(e,t,s,o,h){var p=-1,m=e.length;for(s||(s=bd),h||(h=[]);++p<m;){var _=e[p];t>0&&s(_)?t>1?Kt(_,t-1,s,o,h):hi(h,_):o||(h[h.length]=_)}return h}var to=Iu(),Xc=Iu(!0);function jr(e,t){return e&&to(e,t,jt)}function ro(e,t){return e&&Xc(e,t,jt)}function Dn(e,t){return ui(t,function(s){return Zr(e[s])})}function Di(e,t){t=gi(t,e);for(var s=0,o=t.length;e!=null&&s<o;)e=e[Hr(t[s++])];return s&&s==o?e:r}function Zc(e,t,s){var o=t(e);return ge(e)?o:hi(o,s(e))}function Yt(e){return e==null?e===r?at:$e:Ti&&Ti in Ge(e)?gd(e):Od(e)}function io(e,t){return e>t}function Dp(e,t){return e!=null&&Me.call(e,t)}function Lp(e,t){return e!=null&&t in Ge(e)}function qp(e,t,s){return e>=Ft(t,s)&&e<qt(t,s)}function so(e,t,s){for(var o=s?Ua:gn,h=e[0].length,p=e.length,m=p,_=O(p),P=1/0,q=[];m--;){var z=e[m];m&&t&&(z=it(z,fr(t))),P=Ft(z.length,P),_[m]=!s&&(t||h>=120&&z.length>=120)?new Ni(m&&z):r}z=e[0];var H=-1,G=_[0];e:for(;++H<h&&q.length<P;){var ee=z[H],ne=t?t(ee):ee;if(ee=s||ee!==0?ee:0,!(G?ms(G,ne):o(q,ne,s))){for(m=p;--m;){var we=_[m];if(!(we?ms(we,ne):o(e[m],ne,s)))continue e}G&&G.push(ne),q.push(ee)}}return q}function zp(e,t,s,o){return jr(e,function(h,p,m){t(o,s(h),p,m)}),o}function Ss(e,t,s){t=gi(t,e),e=Uu(e,t);var o=e==null?e:e[Hr(xr(t))];return o==null?r:Mt(o,e,s)}function eu(e){return yt(e)&&Yt(e)==_e}function Mp(e){return yt(e)&&Yt(e)==Ne}function jp(e){return yt(e)&&Yt(e)==S}function Cs(e,t,s,o,h){return e===t?!0:e==null||t==null||!yt(e)&&!yt(t)?e!==e&&t!==t:Up(e,t,s,o,Cs,h)}function Up(e,t,s,o,h,p){var m=ge(e),_=ge(t),P=m?It:Bt(e),q=_?It:Bt(t);P=P==_e?xe:P,q=q==_e?xe:q;var z=P==xe,H=q==xe,G=P==q;if(G&&yi(e)){if(!yi(t))return!1;m=!0,z=!1}if(G&&!z)return p||(p=new Tr),m||os(e)?$u(e,t,s,o,h,p):pd(e,t,P,s,o,h,p);if(!(s&D)){var ee=z&&Me.call(e,"__wrapped__"),ne=H&&Me.call(t,"__wrapped__");if(ee||ne){var we=ee?e.value():e,ae=ne?t.value():t;return p||(p=new Tr),h(we,ae,s,o,p)}}return G?(p||(p=new Tr),dd(e,t,s,o,h,p)):!1}function Hp(e){return yt(e)&&Bt(e)==me}function no(e,t,s,o){var h=s.length,p=h,m=!o;if(e==null)return!p;for(e=Ge(e);h--;){var _=s[h];if(m&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++h<p;){_=s[h];var P=_[0],q=e[P],z=_[1];if(m&&_[2]){if(q===r&&!(P in e))return!1}else{var H=new Tr;if(o)var G=o(q,z,P,e,t,H);if(!(G===r?Cs(z,q,D|V,o,H):G))return!1}}return!0}function tu(e){if(!ct(e)||Id(e))return!1;var t=Zr(e)?Hf:xa;return t.test(qi(e))}function kp(e){return yt(e)&&Yt(e)==nt}function Kp(e){return yt(e)&&Bt(e)==Le}function Vp(e){return yt(e)&&Yn(e.length)&&!!Ve[Yt(e)]}function ru(e){return typeof e=="function"?e:e==null?or:typeof e=="object"?ge(e)?nu(e[0],e[1]):su(e):xh(e)}function ao(e){if(!Ts(e))return Gf(e);var t=[];for(var s in Ge(e))Me.call(e,s)&&s!="constructor"&&t.push(s);return t}function Fp(e){if(!ct(e))return Cd(e);var t=Ts(e),s=[];for(var o in e)o=="constructor"&&(t||!Me.call(e,o))||s.push(o);return s}function oo(e,t){return e<t}function iu(e,t){var s=-1,o=nr(e)?O(e.length):[];return pi(e,function(h,p,m){o[++s]=t(h,p,m)}),o}function su(e){var t=Io(e);return t.length==1&&t[0][2]?Mu(t[0][0],t[0][1]):function(s){return s===e||no(s,e,t)}}function nu(e,t){return Po(e)&&zu(t)?Mu(Hr(e),t):function(s){var o=Lo(s,e);return o===r&&o===t?qo(s,e):Cs(t,o,D|V)}}function Ln(e,t,s,o,h){e!==t&&to(t,function(p,m){if(h||(h=new Tr),ct(p))Bp(e,t,m,s,Ln,o,h);else{var _=o?o(Co(e,m),p,m+"",e,t,h):r;_===r&&(_=p),Za(e,m,_)}},ar)}function Bp(e,t,s,o,h,p,m){var _=Co(e,s),P=Co(t,s),q=m.get(P);if(q){Za(e,s,q);return}var z=p?p(_,P,s+"",e,t,m):r,H=z===r;if(H){var G=ge(P),ee=!G&&yi(P),ne=!G&&!ee&&os(P);z=P,G||ee||ne?ge(_)?z=_:bt(_)?z=sr(_):ee?(H=!1,z=yu(P,!0)):ne?(H=!1,z=mu(P,!0)):z=[]:Ns(P)||zi(P)?(z=_,zi(_)?z=dh(_):(!ct(_)||Zr(_))&&(z=qu(P))):H=!1}H&&(m.set(P,z),h(z,P,o,p,m),m.delete(P)),Za(e,s,z)}function au(e,t){var s=e.length;if(s)return t+=t<0?s:0,Xr(t,s)?e[t]:r}function ou(e,t,s){t.length?t=it(t,function(p){return ge(p)?function(m){return Di(m,p.length===1?p[0]:p)}:p}):t=[or];var o=-1;t=it(t,fr(se()));var h=iu(e,function(p,m,_){var P=it(t,function(q){return q(p)});return{criteria:P,index:++o,value:p}});return wf(h,function(p,m){return nd(p,m,s)})}function Gp(e,t){return cu(e,t,function(s,o){return qo(e,o)})}function cu(e,t,s){for(var o=-1,h=t.length,p={};++o<h;){var m=t[o],_=Di(e,m);s(_,m)&&Os(p,gi(m,e),_)}return p}function Wp(e){return function(t){return Di(t,e)}}function co(e,t,s,o){var h=o?mf:Qi,p=-1,m=t.length,_=e;for(e===t&&(t=sr(t)),s&&(_=it(e,fr(s)));++p<m;)for(var P=0,q=t[p],z=s?s(q):q;(P=h(_,z,P,o))>-1;)_!==e&&Pn.call(_,P,1),Pn.call(e,P,1);return e}function uu(e,t){for(var s=e?t.length:0,o=s-1;s--;){var h=t[s];if(s==o||h!==p){var p=h;Xr(h)?Pn.call(e,h,1):fo(e,h)}}return e}function uo(e,t){return e+On(Kc()*(t-e+1))}function Jp(e,t,s,o){for(var h=-1,p=qt(Cn((t-e)/(s||1)),0),m=O(p);p--;)m[o?p:++h]=e,e+=s;return m}function ho(e,t){var s="";if(!e||t<1||t>J)return s;do t%2&&(s+=e),t=On(t/2),t&&(e+=e);while(t);return s}function be(e,t){return Oo(ju(e,t,or),e+"")}function Qp(e){return Bc(cs(e))}function Yp(e,t){var s=cs(e);return Fn(s,$i(t,0,s.length))}function Os(e,t,s,o){if(!ct(e))return e;t=gi(t,e);for(var h=-1,p=t.length,m=p-1,_=e;_!=null&&++h<p;){var P=Hr(t[h]),q=s;if(P==="__proto__"||P==="constructor"||P==="prototype")return e;if(h!=m){var z=_[P];q=o?o(z,P,_):r,q===r&&(q=ct(z)?z:Xr(t[h+1])?[]:{})}xs(_,P,q),_=_[P]}return e}var hu=Rn?function(e,t){return Rn.set(e,t),e}:or,Xp=Sn?function(e,t){return Sn(e,"toString",{configurable:!0,enumerable:!1,value:Mo(t),writable:!0})}:or;function Zp(e){return Fn(cs(e))}function Ir(e,t,s){var o=-1,h=e.length;t<0&&(t=-t>h?0:h+t),s=s>h?h:s,s<0&&(s+=h),h=t>s?0:s-t>>>0,t>>>=0;for(var p=O(h);++o<h;)p[o]=e[o+t];return p}function ed(e,t){var s;return pi(e,function(o,h,p){return s=t(o,h,p),!s}),!!s}function qn(e,t,s){var o=0,h=e==null?o:e.length;if(typeof t=="number"&&t===t&&h<=ke){for(;o<h;){var p=o+h>>>1,m=e[p];m!==null&&!dr(m)&&(s?m<=t:m<t)?o=p+1:h=p}return h}return lo(e,t,or,s)}function lo(e,t,s,o){var h=0,p=e==null?0:e.length;if(p===0)return 0;t=s(t);for(var m=t!==t,_=t===null,P=dr(t),q=t===r;h<p;){var z=On((h+p)/2),H=s(e[z]),G=H!==r,ee=H===null,ne=H===H,we=dr(H);if(m)var ae=o||ne;else q?ae=ne&&(o||G):_?ae=ne&&G&&(o||!ee):P?ae=ne&&G&&!ee&&(o||!we):ee||we?ae=!1:ae=o?H<=t:H<t;ae?h=z+1:p=z}return Ft(p,ut)}function lu(e,t){for(var s=-1,o=e.length,h=0,p=[];++s<o;){var m=e[s],_=t?t(m):m;if(!s||!Ar(_,P)){var P=_;p[h++]=m===0?0:m}}return p}function fu(e){return typeof e=="number"?e:dr(e)?K:+e}function pr(e){if(typeof e=="string")return e;if(ge(e))return it(e,pr)+"";if(dr(e))return Vc?Vc.call(e):"";var t=e+"";return t=="0"&&1/e==-Te?"-0":t}function di(e,t,s){var o=-1,h=gn,p=e.length,m=!0,_=[],P=_;if(s)m=!1,h=Ua;else if(p>=a){var q=t?null:ld(e);if(q)return yn(q);m=!1,h=ms,P=new Ni}else P=t?[]:_;e:for(;++o<p;){var z=e[o],H=t?t(z):z;if(z=s||z!==0?z:0,m&&H===H){for(var G=P.length;G--;)if(P[G]===H)continue e;t&&P.push(H),_.push(z)}else h(P,H,s)||(P!==_&&P.push(H),_.push(z))}return _}function fo(e,t){return t=gi(t,e),e=Uu(e,t),e==null||delete e[Hr(xr(t))]}function pu(e,t,s,o){return Os(e,t,s(Di(e,t)),o)}function zn(e,t,s,o){for(var h=e.length,p=o?h:-1;(o?p--:++p<h)&&t(e[p],p,e););return s?Ir(e,o?0:p,o?p+1:h):Ir(e,o?p+1:0,o?h:p)}function du(e,t){var s=e;return s instanceof Pe&&(s=s.value()),Ha(t,function(o,h){return h.func.apply(h.thisArg,hi([o],h.args))},s)}function po(e,t,s){var o=e.length;if(o<2)return o?di(e[0]):[];for(var h=-1,p=O(o);++h<o;)for(var m=e[h],_=-1;++_<o;)_!=h&&(p[h]=Ps(p[h]||m,e[_],t,s));return di(Kt(p,1),t,s)}function gu(e,t,s){for(var o=-1,h=e.length,p=t.length,m={};++o<h;){var _=o<p?t[o]:r;s(m,e[o],_)}return m}function go(e){return bt(e)?e:[]}function vo(e){return typeof e=="function"?e:or}function gi(e,t){return ge(e)?e:Po(e,t)?[e]:Vu(qe(e))}var td=be;function vi(e,t,s){var o=e.length;return s=s===r?o:s,!t&&s>=o?e:Ir(e,t,s)}var vu=kf||function(e){return Se.clearTimeout(e)};function yu(e,t){if(t)return e.slice();var s=e.length,o=Mc?Mc(s):new e.constructor(s);return e.copy(o),o}function yo(e){var t=new e.constructor(e.byteLength);return new In(t).set(new In(e)),t}function rd(e,t){var s=t?yo(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function id(e){var t=new e.constructor(e.source,yr.exec(e));return t.lastIndex=e.lastIndex,t}function sd(e){return Is?Ge(Is.call(e)):{}}function mu(e,t){var s=t?yo(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function wu(e,t){if(e!==t){var s=e!==r,o=e===null,h=e===e,p=dr(e),m=t!==r,_=t===null,P=t===t,q=dr(t);if(!_&&!q&&!p&&e>t||p&&m&&P&&!_&&!q||o&&m&&P||!s&&P||!h)return 1;if(!o&&!p&&!q&&e<t||q&&s&&h&&!o&&!p||_&&s&&h||!m&&h||!P)return-1}return 0}function nd(e,t,s){for(var o=-1,h=e.criteria,p=t.criteria,m=h.length,_=s.length;++o<m;){var P=wu(h[o],p[o]);if(P){if(o>=_)return P;var q=s[o];return P*(q=="desc"?-1:1)}}return e.index-t.index}function _u(e,t,s,o){for(var h=-1,p=e.length,m=s.length,_=-1,P=t.length,q=qt(p-m,0),z=O(P+q),H=!o;++_<P;)z[_]=t[_];for(;++h<m;)(H||h<p)&&(z[s[h]]=e[h]);for(;q--;)z[_++]=e[h++];return z}function bu(e,t,s,o){for(var h=-1,p=e.length,m=-1,_=s.length,P=-1,q=t.length,z=qt(p-_,0),H=O(z+q),G=!o;++h<z;)H[h]=e[h];for(var ee=h;++P<q;)H[ee+P]=t[P];for(;++m<_;)(G||h<p)&&(H[ee+s[m]]=e[h++]);return H}function sr(e,t){var s=-1,o=e.length;for(t||(t=O(o));++s<o;)t[s]=e[s];return t}function Ur(e,t,s,o){var h=!s;s||(s={});for(var p=-1,m=t.length;++p<m;){var _=t[p],P=o?o(s[_],e[_],_,s,e):r;P===r&&(P=e[_]),h?Jr(s,_,P):xs(s,_,P)}return s}function ad(e,t){return Ur(e,xo(e),t)}function od(e,t){return Ur(e,Du(e),t)}function Mn(e,t){return function(s,o){var h=ge(s)?ff:Rp,p=t?t():{};return h(s,e,se(o,2),p)}}function ss(e){return be(function(t,s){var o=-1,h=s.length,p=h>1?s[h-1]:r,m=h>2?s[2]:r;for(p=e.length>3&&typeof p=="function"?(h--,p):r,m&&Xt(s[0],s[1],m)&&(p=h<3?r:p,h=1),t=Ge(t);++o<h;){var _=s[o];_&&e(t,_,o,p)}return t})}function Eu(e,t){return function(s,o){if(s==null)return s;if(!nr(s))return e(s,o);for(var h=s.length,p=t?h:-1,m=Ge(s);(t?p--:++p<h)&&o(m[p],p,m)!==!1;);return s}}function Iu(e){return function(t,s,o){for(var h=-1,p=Ge(t),m=o(t),_=m.length;_--;){var P=m[e?_:++h];if(s(p[P],P,p)===!1)break}return t}}function cd(e,t,s){var o=t&re,h=Rs(e);function p(){var m=this&&this!==Se&&this instanceof p?h:e;return m.apply(o?s:this,arguments)}return p}function xu(e){return function(t){t=qe(t);var s=Yi(t)?Rr(t):r,o=s?s[0]:t.charAt(0),h=s?vi(s,1).join(""):t.slice(1);return o[e]()+h}}function ns(e){return function(t){return Ha(Eh(bh(t).replace(vs,"")),e,"")}}function Rs(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var s=is(e.prototype),o=e.apply(s,t);return ct(o)?o:s}}function ud(e,t,s){var o=Rs(e);function h(){for(var p=arguments.length,m=O(p),_=p,P=as(h);_--;)m[_]=arguments[_];var q=p<3&&m[0]!==P&&m[p-1]!==P?[]:li(m,P);if(p-=q.length,p<s)return Ru(e,t,jn,h.placeholder,r,m,q,r,r,s-p);var z=this&&this!==Se&&this instanceof h?o:e;return Mt(z,this,m)}return h}function Pu(e){return function(t,s,o){var h=Ge(t);if(!nr(t)){var p=se(s,3);t=jt(t),s=function(_){return p(h[_],_,h)}}var m=e(t,s,o);return m>-1?h[p?t[m]:m]:r}}function Su(e){return Yr(function(t){var s=t.length,o=s,h=br.prototype.thru;for(e&&t.reverse();o--;){var p=t[o];if(typeof p!="function")throw new _r(d);if(h&&!m&&Kn(p)=="wrapper")var m=new br([],!0)}for(o=m?o:s;++o<s;){p=t[o];var _=Kn(p),P=_=="wrapper"?Eo(p):r;P&&So(P[0])&&P[1]==(k|he|pe|W)&&!P[4].length&&P[9]==1?m=m[Kn(P[0])].apply(m,P[3]):m=p.length==1&&So(p)?m[_]():m.thru(p)}return function(){var q=arguments,z=q[0];if(m&&q.length==1&&ge(z))return m.plant(z).value();for(var H=0,G=s?t[H].apply(this,q):z;++H<s;)G=t[H].call(this,G);return G}})}function jn(e,t,s,o,h,p,m,_,P,q){var z=t&k,H=t&re,G=t&ce,ee=t&(he|fe),ne=t&ve,we=G?r:Rs(e);function ae(){for(var Ie=arguments.length,Ce=O(Ie),gr=Ie;gr--;)Ce[gr]=arguments[gr];if(ee)var Zt=as(ae),vr=bf(Ce,Zt);if(o&&(Ce=_u(Ce,o,h,ee)),p&&(Ce=bu(Ce,p,m,ee)),Ie-=vr,ee&&Ie<q){var Et=li(Ce,Zt);return Ru(e,t,jn,ae.placeholder,s,Ce,Et,_,P,q-Ie)}var Nr=H?s:this,ti=G?Nr[e]:e;return Ie=Ce.length,_?Ce=Rd(Ce,_):ne&&Ie>1&&Ce.reverse(),z&&P<Ie&&(Ce.length=P),this&&this!==Se&&this instanceof ae&&(ti=we||Rs(ti)),ti.apply(Nr,Ce)}return ae}function Cu(e,t){return function(s,o){return zp(s,e,t(o),{})}}function Un(e,t){return function(s,o){var h;if(s===r&&o===r)return t;if(s!==r&&(h=s),o!==r){if(h===r)return o;typeof s=="string"||typeof o=="string"?(s=pr(s),o=pr(o)):(s=fu(s),o=fu(o)),h=e(s,o)}return h}}function mo(e){return Yr(function(t){return t=it(t,fr(se())),be(function(s){var o=this;return e(t,function(h){return Mt(h,o,s)})})})}function Hn(e,t){t=t===r?" ":pr(t);var s=t.length;if(s<2)return s?ho(t,e):t;var o=ho(t,Cn(e/Xi(t)));return Yi(t)?vi(Rr(o),0,e).join(""):o.slice(0,e)}function hd(e,t,s,o){var h=t&re,p=Rs(e);function m(){for(var _=-1,P=arguments.length,q=-1,z=o.length,H=O(z+P),G=this&&this!==Se&&this instanceof m?p:e;++q<z;)H[q]=o[q];for(;P--;)H[q++]=arguments[++_];return Mt(G,h?s:this,H)}return m}function Ou(e){return function(t,s,o){return o&&typeof o!="number"&&Xt(t,s,o)&&(s=o=r),t=ei(t),s===r?(s=t,t=0):s=ei(s),o=o===r?t<s?1:-1:ei(o),Jp(t,s,o,e)}}function kn(e){return function(t,s){return typeof t=="string"&&typeof s=="string"||(t=Pr(t),s=Pr(s)),e(t,s)}}function Ru(e,t,s,o,h,p,m,_,P,q){var z=t&he,H=z?m:r,G=z?r:m,ee=z?p:r,ne=z?r:p;t|=z?pe:$,t&=~(z?$:pe),t&ue||(t&=~(re|ce));var we=[e,t,h,ee,H,ne,G,_,P,q],ae=s.apply(r,we);return So(e)&&Hu(ae,we),ae.placeholder=o,ku(ae,e,t)}function wo(e){var t=Lt[e];return function(s,o){if(s=Pr(s),o=o==null?0:Ft(ye(o),292),o&&kc(s)){var h=(qe(s)+"e").split("e"),p=t(h[0]+"e"+(+h[1]+o));return h=(qe(p)+"e").split("e"),+(h[0]+"e"+(+h[1]-o))}return t(s)}}var ld=ts&&1/yn(new ts([,-0]))[1]==Te?function(e){return new ts(e)}:Ho;function Tu(e){return function(t){var s=Bt(t);return s==me?Wa(t):s==Le?Of(t):_f(t,e(t))}}function Qr(e,t,s,o,h,p,m,_){var P=t&ce;if(!P&&typeof e!="function")throw new _r(d);var q=o?o.length:0;if(q||(t&=~(pe|$),o=h=r),m=m===r?m:qt(ye(m),0),_=_===r?_:ye(_),q-=h?h.length:0,t&$){var z=o,H=h;o=h=r}var G=P?r:Eo(e),ee=[e,t,s,o,h,z,H,p,m,_];if(G&&Sd(ee,G),e=ee[0],t=ee[1],s=ee[2],o=ee[3],h=ee[4],_=ee[9]=ee[9]===r?P?0:e.length:qt(ee[9]-q,0),!_&&t&(he|fe)&&(t&=~(he|fe)),!t||t==re)var ne=cd(e,t,s);else t==he||t==fe?ne=ud(e,t,_):(t==pe||t==(re|pe))&&!h.length?ne=hd(e,t,s,o):ne=jn.apply(r,ee);var we=G?hu:Hu;return ku(we(ne,ee),e,t)}function Au(e,t,s,o){return e===r||Ar(e,es[s])&&!Me.call(o,s)?t:e}function Nu(e,t,s,o,h,p){return ct(e)&&ct(t)&&(p.set(t,e),Ln(e,t,r,Nu,p),p.delete(t)),e}function fd(e){return Ns(e)?r:e}function $u(e,t,s,o,h,p){var m=s&D,_=e.length,P=t.length;if(_!=P&&!(m&&P>_))return!1;var q=p.get(e),z=p.get(t);if(q&&z)return q==t&&z==e;var H=-1,G=!0,ee=s&V?new Ni:r;for(p.set(e,t),p.set(t,e);++H<_;){var ne=e[H],we=t[H];if(o)var ae=m?o(we,ne,H,t,e,p):o(ne,we,H,e,t,p);if(ae!==r){if(ae)continue;G=!1;break}if(ee){if(!ka(t,function(Ie,Ce){if(!ms(ee,Ce)&&(ne===Ie||h(ne,Ie,s,o,p)))return ee.push(Ce)})){G=!1;break}}else if(!(ne===we||h(ne,we,s,o,p))){G=!1;break}}return p.delete(e),p.delete(t),G}function pd(e,t,s,o,h,p,m){switch(s){case Ke:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ne:return!(e.byteLength!=t.byteLength||!p(new In(e),new In(t)));case A:case S:case Ae:return Ar(+e,+t);case b:return e.name==t.name&&e.message==t.message;case nt:case Je:return e==t+"";case me:var _=Wa;case Le:var P=o&D;if(_||(_=yn),e.size!=t.size&&!P)return!1;var q=m.get(e);if(q)return q==t;o|=V,m.set(e,t);var z=$u(_(e),_(t),o,h,p,m);return m.delete(e),z;case Qe:if(Is)return Is.call(e)==Is.call(t)}return!1}function dd(e,t,s,o,h,p){var m=s&D,_=_o(e),P=_.length,q=_o(t),z=q.length;if(P!=z&&!m)return!1;for(var H=P;H--;){var G=_[H];if(!(m?G in t:Me.call(t,G)))return!1}var ee=p.get(e),ne=p.get(t);if(ee&&ne)return ee==t&&ne==e;var we=!0;p.set(e,t),p.set(t,e);for(var ae=m;++H<P;){G=_[H];var Ie=e[G],Ce=t[G];if(o)var gr=m?o(Ce,Ie,G,t,e,p):o(Ie,Ce,G,e,t,p);if(!(gr===r?Ie===Ce||h(Ie,Ce,s,o,p):gr)){we=!1;break}ae||(ae=G=="constructor")}if(we&&!ae){var Zt=e.constructor,vr=t.constructor;Zt!=vr&&"constructor"in e&&"constructor"in t&&!(typeof Zt=="function"&&Zt instanceof Zt&&typeof vr=="function"&&vr instanceof vr)&&(we=!1)}return p.delete(e),p.delete(t),we}function Yr(e){return Oo(ju(e,r,Wu),e+"")}function _o(e){return Zc(e,jt,xo)}function bo(e){return Zc(e,ar,Du)}var Eo=Rn?function(e){return Rn.get(e)}:Ho;function Kn(e){for(var t=e.name+"",s=rs[t],o=Me.call(rs,t)?s.length:0;o--;){var h=s[o],p=h.func;if(p==null||p==e)return h.name}return t}function as(e){var t=Me.call(f,"placeholder")?f:e;return t.placeholder}function se(){var e=f.iteratee||jo;return e=e===jo?ru:e,arguments.length?e(arguments[0],arguments[1]):e}function Vn(e,t){var s=e.__data__;return Ed(t)?s[typeof t=="string"?"string":"hash"]:s.map}function Io(e){for(var t=jt(e),s=t.length;s--;){var o=t[s],h=e[o];t[s]=[o,h,zu(h)]}return t}function Li(e,t){var s=Pf(e,t);return tu(s)?s:r}function gd(e){var t=Me.call(e,Ti),s=e[Ti];try{e[Ti]=r;var o=!0}catch{}var h=bn.call(e);return o&&(t?e[Ti]=s:delete e[Ti]),h}var xo=Qa?function(e){return e==null?[]:(e=Ge(e),ui(Qa(e),function(t){return Uc.call(e,t)}))}:ko,Du=Qa?function(e){for(var t=[];e;)hi(t,xo(e)),e=xn(e);return t}:ko,Bt=Yt;(Ya&&Bt(new Ya(new ArrayBuffer(1)))!=Ke||_s&&Bt(new _s)!=me||Xa&&Bt(Xa.resolve())!=xt||ts&&Bt(new ts)!=Le||bs&&Bt(new bs)!=Ue)&&(Bt=function(e){var t=Yt(e),s=t==xe?e.constructor:r,o=s?qi(s):"";if(o)switch(o){case Yf:return Ke;case Xf:return me;case Zf:return xt;case ep:return Le;case tp:return Ue}return t});function vd(e,t,s){for(var o=-1,h=s.length;++o<h;){var p=s[o],m=p.size;switch(p.type){case"drop":e+=m;break;case"dropRight":t-=m;break;case"take":t=Ft(t,e+m);break;case"takeRight":e=qt(e,t-m);break}}return{start:e,end:t}}function yd(e){var t=e.match(We);return t?t[1].split(Rt):[]}function Lu(e,t,s){t=gi(t,e);for(var o=-1,h=t.length,p=!1;++o<h;){var m=Hr(t[o]);if(!(p=e!=null&&s(e,m)))break;e=e[m]}return p||++o!=h?p:(h=e==null?0:e.length,!!h&&Yn(h)&&Xr(m,h)&&(ge(e)||zi(e)))}function md(e){var t=e.length,s=new e.constructor(t);return t&&typeof e[0]=="string"&&Me.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function qu(e){return typeof e.constructor=="function"&&!Ts(e)?is(xn(e)):{}}function wd(e,t,s){var o=e.constructor;switch(t){case Ne:return yo(e);case A:case S:return new o(+e);case Ke:return rd(e,s);case ht:case ze:case Pt:case Dt:case Ht:case kt:case zt:case Wt:case rr:return mu(e,s);case me:return new o;case Ae:case Je:return new o(e);case nt:return id(e);case Le:return new o;case Qe:return sd(e)}}function _d(e,t){var s=t.length;if(!s)return e;var o=s-1;return t[o]=(s>1?"& ":"")+t[o],t=t.join(s>2?", ":" "),e.replace(vt,`{
/* [wrapped with `+t+`] */
`)}function bd(e){return ge(e)||zi(e)||!!(Hc&&e&&e[Hc])}function Xr(e,t){var s=typeof e;return t=t??J,!!t&&(s=="number"||s!="symbol"&&Sa.test(e))&&e>-1&&e%1==0&&e<t}function Xt(e,t,s){if(!ct(s))return!1;var o=typeof t;return(o=="number"?nr(s)&&Xr(t,s.length):o=="string"&&t in s)?Ar(s[t],e):!1}function Po(e,t){if(ge(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||dr(e)?!0:St.test(e)||!rt.test(e)||t!=null&&e in Ge(t)}function Ed(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function So(e){var t=Kn(e),s=f[t];if(typeof s!="function"||!(t in Pe.prototype))return!1;if(e===s)return!0;var o=Eo(s);return!!o&&e===o[0]}function Id(e){return!!zc&&zc in e}var xd=wn?Zr:Ko;function Ts(e){var t=e&&e.constructor,s=typeof t=="function"&&t.prototype||es;return e===s}function zu(e){return e===e&&!ct(e)}function Mu(e,t){return function(s){return s==null?!1:s[e]===t&&(t!==r||e in Ge(s))}}function Pd(e){var t=Jn(e,function(o){return s.size===v&&s.clear(),o}),s=t.cache;return t}function Sd(e,t){var s=e[1],o=t[1],h=s|o,p=h<(re|ce|k),m=o==k&&s==he||o==k&&s==W&&e[7].length<=t[8]||o==(k|W)&&t[7].length<=t[8]&&s==he;if(!(p||m))return e;o&re&&(e[2]=t[2],h|=s&re?0:ue);var _=t[3];if(_){var P=e[3];e[3]=P?_u(P,_,t[4]):_,e[4]=P?li(e[3],E):t[4]}return _=t[5],_&&(P=e[5],e[5]=P?bu(P,_,t[6]):_,e[6]=P?li(e[5],E):t[6]),_=t[7],_&&(e[7]=_),o&k&&(e[8]=e[8]==null?t[8]:Ft(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=h,e}function Cd(e){var t=[];if(e!=null)for(var s in Ge(e))t.push(s);return t}function Od(e){return bn.call(e)}function ju(e,t,s){return t=qt(t===r?e.length-1:t,0),function(){for(var o=arguments,h=-1,p=qt(o.length-t,0),m=O(p);++h<p;)m[h]=o[t+h];h=-1;for(var _=O(t+1);++h<t;)_[h]=o[h];return _[t]=s(m),Mt(e,this,_)}}function Uu(e,t){return t.length<2?e:Di(e,Ir(t,0,-1))}function Rd(e,t){for(var s=e.length,o=Ft(t.length,s),h=sr(e);o--;){var p=t[o];e[o]=Xr(p,s)?h[p]:r}return e}function Co(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Hu=Ku(hu),As=Vf||function(e,t){return Se.setTimeout(e,t)},Oo=Ku(Xp);function ku(e,t,s){var o=t+"";return Oo(e,_d(o,Td(yd(o),s)))}function Ku(e){var t=0,s=0;return function(){var o=Wf(),h=et-(o-s);if(s=o,h>0){if(++t>=Re)return arguments[0]}else t=0;return e.apply(r,arguments)}}function Fn(e,t){var s=-1,o=e.length,h=o-1;for(t=t===r?o:t;++s<t;){var p=uo(s,h),m=e[p];e[p]=e[s],e[s]=m}return e.length=t,e}var Vu=Pd(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ct,function(s,o,h,p){t.push(h?p.replace(_a,"$1"):o||s)}),t});function Hr(e){if(typeof e=="string"||dr(e))return e;var t=e+"";return t=="0"&&1/e==-Te?"-0":t}function qi(e){if(e!=null){try{return _n.call(e)}catch{}try{return e+""}catch{}}return""}function Td(e,t){return wr(Lr,function(s){var o="_."+s[0];t&s[1]&&!gn(e,o)&&e.push(o)}),e.sort()}function Fu(e){if(e instanceof Pe)return e.clone();var t=new br(e.__wrapped__,e.__chain__);return t.__actions__=sr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Ad(e,t,s){(s?Xt(e,t,s):t===r)?t=1:t=qt(ye(t),0);var o=e==null?0:e.length;if(!o||t<1)return[];for(var h=0,p=0,m=O(Cn(o/t));h<o;)m[p++]=Ir(e,h,h+=t);return m}function Nd(e){for(var t=-1,s=e==null?0:e.length,o=0,h=[];++t<s;){var p=e[t];p&&(h[o++]=p)}return h}function $d(){var e=arguments.length;if(!e)return[];for(var t=O(e-1),s=arguments[0],o=e;o--;)t[o-1]=arguments[o];return hi(ge(s)?sr(s):[s],Kt(t,1))}var Dd=be(function(e,t){return bt(e)?Ps(e,Kt(t,1,bt,!0)):[]}),Ld=be(function(e,t){var s=xr(t);return bt(s)&&(s=r),bt(e)?Ps(e,Kt(t,1,bt,!0),se(s,2)):[]}),qd=be(function(e,t){var s=xr(t);return bt(s)&&(s=r),bt(e)?Ps(e,Kt(t,1,bt,!0),r,s):[]});function zd(e,t,s){var o=e==null?0:e.length;return o?(t=s||t===r?1:ye(t),Ir(e,t<0?0:t,o)):[]}function Md(e,t,s){var o=e==null?0:e.length;return o?(t=s||t===r?1:ye(t),t=o-t,Ir(e,0,t<0?0:t)):[]}function jd(e,t){return e&&e.length?zn(e,se(t,3),!0,!0):[]}function Ud(e,t){return e&&e.length?zn(e,se(t,3),!0):[]}function Hd(e,t,s,o){var h=e==null?0:e.length;return h?(s&&typeof s!="number"&&Xt(e,t,s)&&(s=0,o=h),$p(e,t,s,o)):[]}function Bu(e,t,s){var o=e==null?0:e.length;if(!o)return-1;var h=s==null?0:ye(s);return h<0&&(h=qt(o+h,0)),vn(e,se(t,3),h)}function Gu(e,t,s){var o=e==null?0:e.length;if(!o)return-1;var h=o-1;return s!==r&&(h=ye(s),h=s<0?qt(o+h,0):Ft(h,o-1)),vn(e,se(t,3),h,!0)}function Wu(e){var t=e==null?0:e.length;return t?Kt(e,1):[]}function kd(e){var t=e==null?0:e.length;return t?Kt(e,Te):[]}function Kd(e,t){var s=e==null?0:e.length;return s?(t=t===r?1:ye(t),Kt(e,t)):[]}function Vd(e){for(var t=-1,s=e==null?0:e.length,o={};++t<s;){var h=e[t];o[h[0]]=h[1]}return o}function Ju(e){return e&&e.length?e[0]:r}function Fd(e,t,s){var o=e==null?0:e.length;if(!o)return-1;var h=s==null?0:ye(s);return h<0&&(h=qt(o+h,0)),Qi(e,t,h)}function Bd(e){var t=e==null?0:e.length;return t?Ir(e,0,-1):[]}var Gd=be(function(e){var t=it(e,go);return t.length&&t[0]===e[0]?so(t):[]}),Wd=be(function(e){var t=xr(e),s=it(e,go);return t===xr(s)?t=r:s.pop(),s.length&&s[0]===e[0]?so(s,se(t,2)):[]}),Jd=be(function(e){var t=xr(e),s=it(e,go);return t=typeof t=="function"?t:r,t&&s.pop(),s.length&&s[0]===e[0]?so(s,r,t):[]});function Qd(e,t){return e==null?"":Bf.call(e,t)}function xr(e){var t=e==null?0:e.length;return t?e[t-1]:r}function Yd(e,t,s){var o=e==null?0:e.length;if(!o)return-1;var h=o;return s!==r&&(h=ye(s),h=h<0?qt(o+h,0):Ft(h,o-1)),t===t?Tf(e,t,h):vn(e,Rc,h,!0)}function Xd(e,t){return e&&e.length?au(e,ye(t)):r}var Zd=be(Qu);function Qu(e,t){return e&&e.length&&t&&t.length?co(e,t):e}function eg(e,t,s){return e&&e.length&&t&&t.length?co(e,t,se(s,2)):e}function tg(e,t,s){return e&&e.length&&t&&t.length?co(e,t,r,s):e}var rg=Yr(function(e,t){var s=e==null?0:e.length,o=eo(e,t);return uu(e,it(t,function(h){return Xr(h,s)?+h:h}).sort(wu)),o});function ig(e,t){var s=[];if(!(e&&e.length))return s;var o=-1,h=[],p=e.length;for(t=se(t,3);++o<p;){var m=e[o];t(m,o,e)&&(s.push(m),h.push(o))}return uu(e,h),s}function Ro(e){return e==null?e:Qf.call(e)}function sg(e,t,s){var o=e==null?0:e.length;return o?(s&&typeof s!="number"&&Xt(e,t,s)?(t=0,s=o):(t=t==null?0:ye(t),s=s===r?o:ye(s)),Ir(e,t,s)):[]}function ng(e,t){return qn(e,t)}function ag(e,t,s){return lo(e,t,se(s,2))}function og(e,t){var s=e==null?0:e.length;if(s){var o=qn(e,t);if(o<s&&Ar(e[o],t))return o}return-1}function cg(e,t){return qn(e,t,!0)}function ug(e,t,s){return lo(e,t,se(s,2),!0)}function hg(e,t){var s=e==null?0:e.length;if(s){var o=qn(e,t,!0)-1;if(Ar(e[o],t))return o}return-1}function lg(e){return e&&e.length?lu(e):[]}function fg(e,t){return e&&e.length?lu(e,se(t,2)):[]}function pg(e){var t=e==null?0:e.length;return t?Ir(e,1,t):[]}function dg(e,t,s){return e&&e.length?(t=s||t===r?1:ye(t),Ir(e,0,t<0?0:t)):[]}function gg(e,t,s){var o=e==null?0:e.length;return o?(t=s||t===r?1:ye(t),t=o-t,Ir(e,t<0?0:t,o)):[]}function vg(e,t){return e&&e.length?zn(e,se(t,3),!1,!0):[]}function yg(e,t){return e&&e.length?zn(e,se(t,3)):[]}var mg=be(function(e){return di(Kt(e,1,bt,!0))}),wg=be(function(e){var t=xr(e);return bt(t)&&(t=r),di(Kt(e,1,bt,!0),se(t,2))}),_g=be(function(e){var t=xr(e);return t=typeof t=="function"?t:r,di(Kt(e,1,bt,!0),r,t)});function bg(e){return e&&e.length?di(e):[]}function Eg(e,t){return e&&e.length?di(e,se(t,2)):[]}function Ig(e,t){return t=typeof t=="function"?t:r,e&&e.length?di(e,r,t):[]}function To(e){if(!(e&&e.length))return[];var t=0;return e=ui(e,function(s){if(bt(s))return t=qt(s.length,t),!0}),Ba(t,function(s){return it(e,Ka(s))})}function Yu(e,t){if(!(e&&e.length))return[];var s=To(e);return t==null?s:it(s,function(o){return Mt(t,r,o)})}var xg=be(function(e,t){return bt(e)?Ps(e,t):[]}),Pg=be(function(e){return po(ui(e,bt))}),Sg=be(function(e){var t=xr(e);return bt(t)&&(t=r),po(ui(e,bt),se(t,2))}),Cg=be(function(e){var t=xr(e);return t=typeof t=="function"?t:r,po(ui(e,bt),r,t)}),Og=be(To);function Rg(e,t){return gu(e||[],t||[],xs)}function Tg(e,t){return gu(e||[],t||[],Os)}var Ag=be(function(e){var t=e.length,s=t>1?e[t-1]:r;return s=typeof s=="function"?(e.pop(),s):r,Yu(e,s)});function Xu(e){var t=f(e);return t.__chain__=!0,t}function Ng(e,t){return t(e),e}function Bn(e,t){return t(e)}var $g=Yr(function(e){var t=e.length,s=t?e[0]:0,o=this.__wrapped__,h=function(p){return eo(p,e)};return t>1||this.__actions__.length||!(o instanceof Pe)||!Xr(s)?this.thru(h):(o=o.slice(s,+s+(t?1:0)),o.__actions__.push({func:Bn,args:[h],thisArg:r}),new br(o,this.__chain__).thru(function(p){return t&&!p.length&&p.push(r),p}))});function Dg(){return Xu(this)}function Lg(){return new br(this.value(),this.__chain__)}function qg(){this.__values__===r&&(this.__values__=fh(this.value()));var e=this.__index__>=this.__values__.length,t=e?r:this.__values__[this.__index__++];return{done:e,value:t}}function zg(){return this}function Mg(e){for(var t,s=this;s instanceof An;){var o=Fu(s);o.__index__=0,o.__values__=r,t?h.__wrapped__=o:t=o;var h=o;s=s.__wrapped__}return h.__wrapped__=e,t}function jg(){var e=this.__wrapped__;if(e instanceof Pe){var t=e;return this.__actions__.length&&(t=new Pe(this)),t=t.reverse(),t.__actions__.push({func:Bn,args:[Ro],thisArg:r}),new br(t,this.__chain__)}return this.thru(Ro)}function Ug(){return du(this.__wrapped__,this.__actions__)}var Hg=Mn(function(e,t,s){Me.call(e,s)?++e[s]:Jr(e,s,1)});function kg(e,t,s){var o=ge(e)?Cc:Np;return s&&Xt(e,t,s)&&(t=r),o(e,se(t,3))}function Kg(e,t){var s=ge(e)?ui:Yc;return s(e,se(t,3))}var Vg=Pu(Bu),Fg=Pu(Gu);function Bg(e,t){return Kt(Gn(e,t),1)}function Gg(e,t){return Kt(Gn(e,t),Te)}function Wg(e,t,s){return s=s===r?1:ye(s),Kt(Gn(e,t),s)}function Zu(e,t){var s=ge(e)?wr:pi;return s(e,se(t,3))}function eh(e,t){var s=ge(e)?pf:Qc;return s(e,se(t,3))}var Jg=Mn(function(e,t,s){Me.call(e,s)?e[s].push(t):Jr(e,s,[t])});function Qg(e,t,s,o){e=nr(e)?e:cs(e),s=s&&!o?ye(s):0;var h=e.length;return s<0&&(s=qt(h+s,0)),Xn(e)?s<=h&&e.indexOf(t,s)>-1:!!h&&Qi(e,t,s)>-1}var Yg=be(function(e,t,s){var o=-1,h=typeof t=="function",p=nr(e)?O(e.length):[];return pi(e,function(m){p[++o]=h?Mt(t,m,s):Ss(m,t,s)}),p}),Xg=Mn(function(e,t,s){Jr(e,s,t)});function Gn(e,t){var s=ge(e)?it:iu;return s(e,se(t,3))}function Zg(e,t,s,o){return e==null?[]:(ge(t)||(t=t==null?[]:[t]),s=o?r:s,ge(s)||(s=s==null?[]:[s]),ou(e,t,s))}var ev=Mn(function(e,t,s){e[s?0:1].push(t)},function(){return[[],[]]});function tv(e,t,s){var o=ge(e)?Ha:Ac,h=arguments.length<3;return o(e,se(t,4),s,h,pi)}function rv(e,t,s){var o=ge(e)?df:Ac,h=arguments.length<3;return o(e,se(t,4),s,h,Qc)}function iv(e,t){var s=ge(e)?ui:Yc;return s(e,Qn(se(t,3)))}function sv(e){var t=ge(e)?Bc:Qp;return t(e)}function nv(e,t,s){(s?Xt(e,t,s):t===r)?t=1:t=ye(t);var o=ge(e)?Cp:Yp;return o(e,t)}function av(e){var t=ge(e)?Op:Zp;return t(e)}function ov(e){if(e==null)return 0;if(nr(e))return Xn(e)?Xi(e):e.length;var t=Bt(e);return t==me||t==Le?e.size:ao(e).length}function cv(e,t,s){var o=ge(e)?ka:ed;return s&&Xt(e,t,s)&&(t=r),o(e,se(t,3))}var uv=be(function(e,t){if(e==null)return[];var s=t.length;return s>1&&Xt(e,t[0],t[1])?t=[]:s>2&&Xt(t[0],t[1],t[2])&&(t=[t[0]]),ou(e,Kt(t,1),[])}),Wn=Kf||function(){return Se.Date.now()};function hv(e,t){if(typeof t!="function")throw new _r(d);return e=ye(e),function(){if(--e<1)return t.apply(this,arguments)}}function th(e,t,s){return t=s?r:t,t=e&&t==null?e.length:t,Qr(e,k,r,r,r,r,t)}function rh(e,t){var s;if(typeof t!="function")throw new _r(d);return e=ye(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=r),s}}var Ao=be(function(e,t,s){var o=re;if(s.length){var h=li(s,as(Ao));o|=pe}return Qr(e,o,t,s,h)}),ih=be(function(e,t,s){var o=re|ce;if(s.length){var h=li(s,as(ih));o|=pe}return Qr(t,o,e,s,h)});function sh(e,t,s){t=s?r:t;var o=Qr(e,he,r,r,r,r,r,t);return o.placeholder=sh.placeholder,o}function nh(e,t,s){t=s?r:t;var o=Qr(e,fe,r,r,r,r,r,t);return o.placeholder=nh.placeholder,o}function ah(e,t,s){var o,h,p,m,_,P,q=0,z=!1,H=!1,G=!0;if(typeof e!="function")throw new _r(d);t=Pr(t)||0,ct(s)&&(z=!!s.leading,H="maxWait"in s,p=H?qt(Pr(s.maxWait)||0,t):p,G="trailing"in s?!!s.trailing:G);function ee(Et){var Nr=o,ti=h;return o=h=r,q=Et,m=e.apply(ti,Nr),m}function ne(Et){return q=Et,_=As(Ie,t),z?ee(Et):m}function we(Et){var Nr=Et-P,ti=Et-q,Ph=t-Nr;return H?Ft(Ph,p-ti):Ph}function ae(Et){var Nr=Et-P,ti=Et-q;return P===r||Nr>=t||Nr<0||H&&ti>=p}function Ie(){var Et=Wn();if(ae(Et))return Ce(Et);_=As(Ie,we(Et))}function Ce(Et){return _=r,G&&o?ee(Et):(o=h=r,m)}function gr(){_!==r&&vu(_),q=0,o=P=h=_=r}function Zt(){return _===r?m:Ce(Wn())}function vr(){var Et=Wn(),Nr=ae(Et);if(o=arguments,h=this,P=Et,Nr){if(_===r)return ne(P);if(H)return vu(_),_=As(Ie,t),ee(P)}return _===r&&(_=As(Ie,t)),m}return vr.cancel=gr,vr.flush=Zt,vr}var lv=be(function(e,t){return Jc(e,1,t)}),fv=be(function(e,t,s){return Jc(e,Pr(t)||0,s)});function pv(e){return Qr(e,ve)}function Jn(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new _r(d);var s=function(){var o=arguments,h=t?t.apply(this,o):o[0],p=s.cache;if(p.has(h))return p.get(h);var m=e.apply(this,o);return s.cache=p.set(h,m)||p,m};return s.cache=new(Jn.Cache||Wr),s}Jn.Cache=Wr;function Qn(e){if(typeof e!="function")throw new _r(d);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function dv(e){return rh(2,e)}var gv=td(function(e,t){t=t.length==1&&ge(t[0])?it(t[0],fr(se())):it(Kt(t,1),fr(se()));var s=t.length;return be(function(o){for(var h=-1,p=Ft(o.length,s);++h<p;)o[h]=t[h].call(this,o[h]);return Mt(e,this,o)})}),No=be(function(e,t){var s=li(t,as(No));return Qr(e,pe,r,t,s)}),oh=be(function(e,t){var s=li(t,as(oh));return Qr(e,$,r,t,s)}),vv=Yr(function(e,t){return Qr(e,W,r,r,r,t)});function yv(e,t){if(typeof e!="function")throw new _r(d);return t=t===r?t:ye(t),be(e,t)}function mv(e,t){if(typeof e!="function")throw new _r(d);return t=t==null?0:qt(ye(t),0),be(function(s){var o=s[t],h=vi(s,0,t);return o&&hi(h,o),Mt(e,this,h)})}function wv(e,t,s){var o=!0,h=!0;if(typeof e!="function")throw new _r(d);return ct(s)&&(o="leading"in s?!!s.leading:o,h="trailing"in s?!!s.trailing:h),ah(e,t,{leading:o,maxWait:t,trailing:h})}function _v(e){return th(e,1)}function bv(e,t){return No(vo(t),e)}function Ev(){if(!arguments.length)return[];var e=arguments[0];return ge(e)?e:[e]}function Iv(e){return Er(e,j)}function xv(e,t){return t=typeof t=="function"?t:r,Er(e,j,t)}function Pv(e){return Er(e,C|j)}function Sv(e,t){return t=typeof t=="function"?t:r,Er(e,C|j,t)}function Cv(e,t){return t==null||Wc(e,t,jt(t))}function Ar(e,t){return e===t||e!==e&&t!==t}var Ov=kn(io),Rv=kn(function(e,t){return e>=t}),zi=eu(function(){return arguments}())?eu:function(e){return yt(e)&&Me.call(e,"callee")&&!Uc.call(e,"callee")},ge=O.isArray,Tv=Qt?fr(Qt):Mp;function nr(e){return e!=null&&Yn(e.length)&&!Zr(e)}function bt(e){return yt(e)&&nr(e)}function Av(e){return e===!0||e===!1||yt(e)&&Yt(e)==A}var yi=Ff||Ko,Nv=Or?fr(Or):jp;function $v(e){return yt(e)&&e.nodeType===1&&!Ns(e)}function Dv(e){if(e==null)return!0;if(nr(e)&&(ge(e)||typeof e=="string"||typeof e.splice=="function"||yi(e)||os(e)||zi(e)))return!e.length;var t=Bt(e);if(t==me||t==Le)return!e.size;if(Ts(e))return!ao(e).length;for(var s in e)if(Me.call(e,s))return!1;return!0}function Lv(e,t){return Cs(e,t)}function qv(e,t,s){s=typeof s=="function"?s:r;var o=s?s(e,t):r;return o===r?Cs(e,t,r,s):!!o}function $o(e){if(!yt(e))return!1;var t=Yt(e);return t==b||t==u||typeof e.message=="string"&&typeof e.name=="string"&&!Ns(e)}function zv(e){return typeof e=="number"&&kc(e)}function Zr(e){if(!ct(e))return!1;var t=Yt(e);return t==Z||t==oe||t==N||t==mt}function ch(e){return typeof e=="number"&&e==ye(e)}function Yn(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=J}function ct(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function yt(e){return e!=null&&typeof e=="object"}var uh=mr?fr(mr):Hp;function Mv(e,t){return e===t||no(e,t,Io(t))}function jv(e,t,s){return s=typeof s=="function"?s:r,no(e,t,Io(t),s)}function Uv(e){return hh(e)&&e!=+e}function Hv(e){if(xd(e))throw new le(l);return tu(e)}function kv(e){return e===null}function Kv(e){return e==null}function hh(e){return typeof e=="number"||yt(e)&&Yt(e)==Ae}function Ns(e){if(!yt(e)||Yt(e)!=xe)return!1;var t=xn(e);if(t===null)return!0;var s=Me.call(t,"constructor")&&t.constructor;return typeof s=="function"&&s instanceof s&&_n.call(s)==jf}var Do=Mr?fr(Mr):kp;function Vv(e){return ch(e)&&e>=-J&&e<=J}var lh=ys?fr(ys):Kp;function Xn(e){return typeof e=="string"||!ge(e)&&yt(e)&&Yt(e)==Je}function dr(e){return typeof e=="symbol"||yt(e)&&Yt(e)==Qe}var os=Ri?fr(Ri):Vp;function Fv(e){return e===r}function Bv(e){return yt(e)&&Bt(e)==Ue}function Gv(e){return yt(e)&&Yt(e)==Ye}var Wv=kn(oo),Jv=kn(function(e,t){return e<=t});function fh(e){if(!e)return[];if(nr(e))return Xn(e)?Rr(e):sr(e);if(ws&&e[ws])return Cf(e[ws]());var t=Bt(e),s=t==me?Wa:t==Le?yn:cs;return s(e)}function ei(e){if(!e)return e===0?e:0;if(e=Pr(e),e===Te||e===-Te){var t=e<0?-1:1;return t*F}return e===e?e:0}function ye(e){var t=ei(e),s=t%1;return t===t?s?t-s:t:0}function ph(e){return e?$i(ye(e),0,B):0}function Pr(e){if(typeof e=="number")return e;if(dr(e))return K;if(ct(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ct(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Nc(e);var s=Ia.test(e);return s||Pa.test(e)?de(e.slice(2),s?2:8):Ea.test(e)?K:+e}function dh(e){return Ur(e,ar(e))}function Qv(e){return e?$i(ye(e),-J,J):e===0?e:0}function qe(e){return e==null?"":pr(e)}var Yv=ss(function(e,t){if(Ts(t)||nr(t)){Ur(t,jt(t),e);return}for(var s in t)Me.call(t,s)&&xs(e,s,t[s])}),gh=ss(function(e,t){Ur(t,ar(t),e)}),Zn=ss(function(e,t,s,o){Ur(t,ar(t),e,o)}),Xv=ss(function(e,t,s,o){Ur(t,jt(t),e,o)}),Zv=Yr(eo);function ey(e,t){var s=is(e);return t==null?s:Gc(s,t)}var ty=be(function(e,t){e=Ge(e);var s=-1,o=t.length,h=o>2?t[2]:r;for(h&&Xt(t[0],t[1],h)&&(o=1);++s<o;)for(var p=t[s],m=ar(p),_=-1,P=m.length;++_<P;){var q=m[_],z=e[q];(z===r||Ar(z,es[q])&&!Me.call(e,q))&&(e[q]=p[q])}return e}),ry=be(function(e){return e.push(r,Nu),Mt(vh,r,e)});function iy(e,t){return Oc(e,se(t,3),jr)}function sy(e,t){return Oc(e,se(t,3),ro)}function ny(e,t){return e==null?e:to(e,se(t,3),ar)}function ay(e,t){return e==null?e:Xc(e,se(t,3),ar)}function oy(e,t){return e&&jr(e,se(t,3))}function cy(e,t){return e&&ro(e,se(t,3))}function uy(e){return e==null?[]:Dn(e,jt(e))}function hy(e){return e==null?[]:Dn(e,ar(e))}function Lo(e,t,s){var o=e==null?r:Di(e,t);return o===r?s:o}function ly(e,t){return e!=null&&Lu(e,t,Dp)}function qo(e,t){return e!=null&&Lu(e,t,Lp)}var fy=Cu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=bn.call(t)),e[t]=s},Mo(or)),py=Cu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=bn.call(t)),Me.call(e,t)?e[t].push(s):e[t]=[s]},se),dy=be(Ss);function jt(e){return nr(e)?Fc(e):ao(e)}function ar(e){return nr(e)?Fc(e,!0):Fp(e)}function gy(e,t){var s={};return t=se(t,3),jr(e,function(o,h,p){Jr(s,t(o,h,p),o)}),s}function vy(e,t){var s={};return t=se(t,3),jr(e,function(o,h,p){Jr(s,h,t(o,h,p))}),s}var yy=ss(function(e,t,s){Ln(e,t,s)}),vh=ss(function(e,t,s,o){Ln(e,t,s,o)}),my=Yr(function(e,t){var s={};if(e==null)return s;var o=!1;t=it(t,function(p){return p=gi(p,e),o||(o=p.length>1),p}),Ur(e,bo(e),s),o&&(s=Er(s,C|T|j,fd));for(var h=t.length;h--;)fo(s,t[h]);return s});function wy(e,t){return yh(e,Qn(se(t)))}var _y=Yr(function(e,t){return e==null?{}:Gp(e,t)});function yh(e,t){if(e==null)return{};var s=it(bo(e),function(o){return[o]});return t=se(t),cu(e,s,function(o,h){return t(o,h[0])})}function by(e,t,s){t=gi(t,e);var o=-1,h=t.length;for(h||(h=1,e=r);++o<h;){var p=e==null?r:e[Hr(t[o])];p===r&&(o=h,p=s),e=Zr(p)?p.call(e):p}return e}function Ey(e,t,s){return e==null?e:Os(e,t,s)}function Iy(e,t,s,o){return o=typeof o=="function"?o:r,e==null?e:Os(e,t,s,o)}var mh=Tu(jt),wh=Tu(ar);function xy(e,t,s){var o=ge(e),h=o||yi(e)||os(e);if(t=se(t,4),s==null){var p=e&&e.constructor;h?s=o?new p:[]:ct(e)?s=Zr(p)?is(xn(e)):{}:s={}}return(h?wr:jr)(e,function(m,_,P){return t(s,m,_,P)}),s}function Py(e,t){return e==null?!0:fo(e,t)}function Sy(e,t,s){return e==null?e:pu(e,t,vo(s))}function Cy(e,t,s,o){return o=typeof o=="function"?o:r,e==null?e:pu(e,t,vo(s),o)}function cs(e){return e==null?[]:Ga(e,jt(e))}function Oy(e){return e==null?[]:Ga(e,ar(e))}function Ry(e,t,s){return s===r&&(s=t,t=r),s!==r&&(s=Pr(s),s=s===s?s:0),t!==r&&(t=Pr(t),t=t===t?t:0),$i(Pr(e),t,s)}function Ty(e,t,s){return t=ei(t),s===r?(s=t,t=0):s=ei(s),e=Pr(e),qp(e,t,s)}function Ay(e,t,s){if(s&&typeof s!="boolean"&&Xt(e,t,s)&&(t=s=r),s===r&&(typeof t=="boolean"?(s=t,t=r):typeof e=="boolean"&&(s=e,e=r)),e===r&&t===r?(e=0,t=1):(e=ei(e),t===r?(t=e,e=0):t=ei(t)),e>t){var o=e;e=t,t=o}if(s||e%1||t%1){var h=Kc();return Ft(e+h*(t-e+Fe("1e-"+((h+"").length-1))),t)}return uo(e,t)}var Ny=ns(function(e,t,s){return t=t.toLowerCase(),e+(s?_h(t):t)});function _h(e){return zo(qe(e).toLowerCase())}function bh(e){return e=qe(e),e&&e.replace(Fr,Ef).replace(Ma,"")}function $y(e,t,s){e=qe(e),t=pr(t);var o=e.length;s=s===r?o:$i(ye(s),0,o);var h=s;return s-=t.length,s>=0&&e.slice(s,h)==t}function Dy(e){return e=qe(e),e&&tt.test(e)?e.replace(xi,If):e}function Ly(e){return e=qe(e),e&&Ot.test(e)?e.replace(dt,"\\$&"):e}var qy=ns(function(e,t,s){return e+(s?"-":"")+t.toLowerCase()}),zy=ns(function(e,t,s){return e+(s?" ":"")+t.toLowerCase()}),My=xu("toLowerCase");function jy(e,t,s){e=qe(e),t=ye(t);var o=t?Xi(e):0;if(!t||o>=t)return e;var h=(t-o)/2;return Hn(On(h),s)+e+Hn(Cn(h),s)}function Uy(e,t,s){e=qe(e),t=ye(t);var o=t?Xi(e):0;return t&&o<t?e+Hn(t-o,s):e}function Hy(e,t,s){e=qe(e),t=ye(t);var o=t?Xi(e):0;return t&&o<t?Hn(t-o,s)+e:e}function ky(e,t,s){return s||t==null?t=0:t&&(t=+t),Jf(qe(e).replace(gt,""),t||0)}function Ky(e,t,s){return(s?Xt(e,t,s):t===r)?t=1:t=ye(t),ho(qe(e),t)}function Vy(){var e=arguments,t=qe(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var Fy=ns(function(e,t,s){return e+(s?"_":"")+t.toLowerCase()});function By(e,t,s){return s&&typeof s!="number"&&Xt(e,t,s)&&(t=s=r),s=s===r?B:s>>>0,s?(e=qe(e),e&&(typeof t=="string"||t!=null&&!Do(t))&&(t=pr(t),!t&&Yi(e))?vi(Rr(e),0,s):e.split(t,s)):[]}var Gy=ns(function(e,t,s){return e+(s?" ":"")+zo(t)});function Wy(e,t,s){return e=qe(e),s=s==null?0:$i(ye(s),0,e.length),t=pr(t),e.slice(s,s+t.length)==t}function Jy(e,t,s){var o=f.templateSettings;s&&Xt(e,t,s)&&(t=r),e=qe(e),t=Zn({},t,o,Au);var h=Zn({},t.imports,o.imports,Au),p=jt(h),m=Ga(h,p),_,P,q=0,z=t.interpolate||Ki,H="__p += '",G=Ja((t.escape||Ki).source+"|"+z.source+"|"+(z===ot?ba:Ki).source+"|"+(t.evaluate||Ki).source+"|$","g"),ee="//# sourceURL="+(Me.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ja+"]")+`
`;e.replace(G,function(ae,Ie,Ce,gr,Zt,vr){return Ce||(Ce=gr),H+=e.slice(q,vr).replace(Ca,xf),Ie&&(_=!0,H+=`' +
__e(`+Ie+`) +
'`),Zt&&(P=!0,H+=`';
`+Zt+`;
__p += '`),Ce&&(H+=`' +
((__t = (`+Ce+`)) == null ? '' : __t) +
'`),q=vr+ae.length,ae}),H+=`';
`;var ne=Me.call(t,"variable")&&t.variable;if(!ne)H=`with (obj) {
`+H+`
}
`;else if(wa.test(ne))throw new le(y);H=(P?H.replace(qr,""):H).replace(Jt,"$1").replace(Vr,"$1;"),H="function("+(ne||"obj")+`) {
`+(ne?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(P?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+H+`return __p
}`;var we=Ih(function(){return De(p,ee+"return "+H).apply(r,m)});if(we.source=H,$o(we))throw we;return we}function Qy(e){return qe(e).toLowerCase()}function Yy(e){return qe(e).toUpperCase()}function Xy(e,t,s){if(e=qe(e),e&&(s||t===r))return Nc(e);if(!e||!(t=pr(t)))return e;var o=Rr(e),h=Rr(t),p=$c(o,h),m=Dc(o,h)+1;return vi(o,p,m).join("")}function Zy(e,t,s){if(e=qe(e),e&&(s||t===r))return e.slice(0,qc(e)+1);if(!e||!(t=pr(t)))return e;var o=Rr(e),h=Dc(o,Rr(t))+1;return vi(o,0,h).join("")}function e0(e,t,s){if(e=qe(e),e&&(s||t===r))return e.replace(gt,"");if(!e||!(t=pr(t)))return e;var o=Rr(e),h=$c(o,Rr(t));return vi(o,h).join("")}function t0(e,t){var s=te,o=Ee;if(ct(t)){var h="separator"in t?t.separator:h;s="length"in t?ye(t.length):s,o="omission"in t?pr(t.omission):o}e=qe(e);var p=e.length;if(Yi(e)){var m=Rr(e);p=m.length}if(s>=p)return e;var _=s-Xi(o);if(_<1)return o;var P=m?vi(m,0,_).join(""):e.slice(0,_);if(h===r)return P+o;if(m&&(_+=P.length-_),Do(h)){if(e.slice(_).search(h)){var q,z=P;for(h.global||(h=Ja(h.source,qe(yr.exec(h))+"g")),h.lastIndex=0;q=h.exec(z);)var H=q.index;P=P.slice(0,H===r?_:H)}}else if(e.indexOf(pr(h),_)!=_){var G=P.lastIndexOf(h);G>-1&&(P=P.slice(0,G))}return P+o}function r0(e){return e=qe(e),e&&lt.test(e)?e.replace(oi,Af):e}var i0=ns(function(e,t,s){return e+(s?" ":"")+t.toUpperCase()}),zo=xu("toUpperCase");function Eh(e,t,s){return e=qe(e),t=s?r:t,t===r?Sf(e)?Df(e):yf(e):e.match(t)||[]}var Ih=be(function(e,t){try{return Mt(e,r,t)}catch(s){return $o(s)?s:new le(s)}}),s0=Yr(function(e,t){return wr(t,function(s){s=Hr(s),Jr(e,s,Ao(e[s],e))}),e});function n0(e){var t=e==null?0:e.length,s=se();return e=t?it(e,function(o){if(typeof o[1]!="function")throw new _r(d);return[s(o[0]),o[1]]}):[],be(function(o){for(var h=-1;++h<t;){var p=e[h];if(Mt(p[0],this,o))return Mt(p[1],this,o)}})}function a0(e){return Ap(Er(e,C))}function Mo(e){return function(){return e}}function o0(e,t){return e==null||e!==e?t:e}var c0=Su(),u0=Su(!0);function or(e){return e}function jo(e){return ru(typeof e=="function"?e:Er(e,C))}function h0(e){return su(Er(e,C))}function l0(e,t){return nu(e,Er(t,C))}var f0=be(function(e,t){return function(s){return Ss(s,e,t)}}),p0=be(function(e,t){return function(s){return Ss(e,s,t)}});function Uo(e,t,s){var o=jt(t),h=Dn(t,o);s==null&&!(ct(t)&&(h.length||!o.length))&&(s=t,t=e,e=this,h=Dn(t,jt(t)));var p=!(ct(s)&&"chain"in s)||!!s.chain,m=Zr(e);return wr(h,function(_){var P=t[_];e[_]=P,m&&(e.prototype[_]=function(){var q=this.__chain__;if(p||q){var z=e(this.__wrapped__),H=z.__actions__=sr(this.__actions__);return H.push({func:P,args:arguments,thisArg:e}),z.__chain__=q,z}return P.apply(e,hi([this.value()],arguments))})}),e}function d0(){return Se._===this&&(Se._=Uf),this}function Ho(){}function g0(e){return e=ye(e),be(function(t){return au(t,e)})}var v0=mo(it),y0=mo(Cc),m0=mo(ka);function xh(e){return Po(e)?Ka(Hr(e)):Wp(e)}function w0(e){return function(t){return e==null?r:Di(e,t)}}var _0=Ou(),b0=Ou(!0);function ko(){return[]}function Ko(){return!1}function E0(){return{}}function I0(){return""}function x0(){return!0}function P0(e,t){if(e=ye(e),e<1||e>J)return[];var s=B,o=Ft(e,B);t=se(t),e-=B;for(var h=Ba(o,t);++s<e;)t(s);return h}function S0(e){return ge(e)?it(e,Hr):dr(e)?[e]:sr(Vu(qe(e)))}function C0(e){var t=++Mf;return qe(e)+t}var O0=Un(function(e,t){return e+t},0),R0=wo("ceil"),T0=Un(function(e,t){return e/t},1),A0=wo("floor");function N0(e){return e&&e.length?$n(e,or,io):r}function $0(e,t){return e&&e.length?$n(e,se(t,2),io):r}function D0(e){return Tc(e,or)}function L0(e,t){return Tc(e,se(t,2))}function q0(e){return e&&e.length?$n(e,or,oo):r}function z0(e,t){return e&&e.length?$n(e,se(t,2),oo):r}var M0=Un(function(e,t){return e*t},1),j0=wo("round"),U0=Un(function(e,t){return e-t},0);function H0(e){return e&&e.length?Fa(e,or):0}function k0(e,t){return e&&e.length?Fa(e,se(t,2)):0}return f.after=hv,f.ary=th,f.assign=Yv,f.assignIn=gh,f.assignInWith=Zn,f.assignWith=Xv,f.at=Zv,f.before=rh,f.bind=Ao,f.bindAll=s0,f.bindKey=ih,f.castArray=Ev,f.chain=Xu,f.chunk=Ad,f.compact=Nd,f.concat=$d,f.cond=n0,f.conforms=a0,f.constant=Mo,f.countBy=Hg,f.create=ey,f.curry=sh,f.curryRight=nh,f.debounce=ah,f.defaults=ty,f.defaultsDeep=ry,f.defer=lv,f.delay=fv,f.difference=Dd,f.differenceBy=Ld,f.differenceWith=qd,f.drop=zd,f.dropRight=Md,f.dropRightWhile=jd,f.dropWhile=Ud,f.fill=Hd,f.filter=Kg,f.flatMap=Bg,f.flatMapDeep=Gg,f.flatMapDepth=Wg,f.flatten=Wu,f.flattenDeep=kd,f.flattenDepth=Kd,f.flip=pv,f.flow=c0,f.flowRight=u0,f.fromPairs=Vd,f.functions=uy,f.functionsIn=hy,f.groupBy=Jg,f.initial=Bd,f.intersection=Gd,f.intersectionBy=Wd,f.intersectionWith=Jd,f.invert=fy,f.invertBy=py,f.invokeMap=Yg,f.iteratee=jo,f.keyBy=Xg,f.keys=jt,f.keysIn=ar,f.map=Gn,f.mapKeys=gy,f.mapValues=vy,f.matches=h0,f.matchesProperty=l0,f.memoize=Jn,f.merge=yy,f.mergeWith=vh,f.method=f0,f.methodOf=p0,f.mixin=Uo,f.negate=Qn,f.nthArg=g0,f.omit=my,f.omitBy=wy,f.once=dv,f.orderBy=Zg,f.over=v0,f.overArgs=gv,f.overEvery=y0,f.overSome=m0,f.partial=No,f.partialRight=oh,f.partition=ev,f.pick=_y,f.pickBy=yh,f.property=xh,f.propertyOf=w0,f.pull=Zd,f.pullAll=Qu,f.pullAllBy=eg,f.pullAllWith=tg,f.pullAt=rg,f.range=_0,f.rangeRight=b0,f.rearg=vv,f.reject=iv,f.remove=ig,f.rest=yv,f.reverse=Ro,f.sampleSize=nv,f.set=Ey,f.setWith=Iy,f.shuffle=av,f.slice=sg,f.sortBy=uv,f.sortedUniq=lg,f.sortedUniqBy=fg,f.split=By,f.spread=mv,f.tail=pg,f.take=dg,f.takeRight=gg,f.takeRightWhile=vg,f.takeWhile=yg,f.tap=Ng,f.throttle=wv,f.thru=Bn,f.toArray=fh,f.toPairs=mh,f.toPairsIn=wh,f.toPath=S0,f.toPlainObject=dh,f.transform=xy,f.unary=_v,f.union=mg,f.unionBy=wg,f.unionWith=_g,f.uniq=bg,f.uniqBy=Eg,f.uniqWith=Ig,f.unset=Py,f.unzip=To,f.unzipWith=Yu,f.update=Sy,f.updateWith=Cy,f.values=cs,f.valuesIn=Oy,f.without=xg,f.words=Eh,f.wrap=bv,f.xor=Pg,f.xorBy=Sg,f.xorWith=Cg,f.zip=Og,f.zipObject=Rg,f.zipObjectDeep=Tg,f.zipWith=Ag,f.entries=mh,f.entriesIn=wh,f.extend=gh,f.extendWith=Zn,Uo(f,f),f.add=O0,f.attempt=Ih,f.camelCase=Ny,f.capitalize=_h,f.ceil=R0,f.clamp=Ry,f.clone=Iv,f.cloneDeep=Pv,f.cloneDeepWith=Sv,f.cloneWith=xv,f.conformsTo=Cv,f.deburr=bh,f.defaultTo=o0,f.divide=T0,f.endsWith=$y,f.eq=Ar,f.escape=Dy,f.escapeRegExp=Ly,f.every=kg,f.find=Vg,f.findIndex=Bu,f.findKey=iy,f.findLast=Fg,f.findLastIndex=Gu,f.findLastKey=sy,f.floor=A0,f.forEach=Zu,f.forEachRight=eh,f.forIn=ny,f.forInRight=ay,f.forOwn=oy,f.forOwnRight=cy,f.get=Lo,f.gt=Ov,f.gte=Rv,f.has=ly,f.hasIn=qo,f.head=Ju,f.identity=or,f.includes=Qg,f.indexOf=Fd,f.inRange=Ty,f.invoke=dy,f.isArguments=zi,f.isArray=ge,f.isArrayBuffer=Tv,f.isArrayLike=nr,f.isArrayLikeObject=bt,f.isBoolean=Av,f.isBuffer=yi,f.isDate=Nv,f.isElement=$v,f.isEmpty=Dv,f.isEqual=Lv,f.isEqualWith=qv,f.isError=$o,f.isFinite=zv,f.isFunction=Zr,f.isInteger=ch,f.isLength=Yn,f.isMap=uh,f.isMatch=Mv,f.isMatchWith=jv,f.isNaN=Uv,f.isNative=Hv,f.isNil=Kv,f.isNull=kv,f.isNumber=hh,f.isObject=ct,f.isObjectLike=yt,f.isPlainObject=Ns,f.isRegExp=Do,f.isSafeInteger=Vv,f.isSet=lh,f.isString=Xn,f.isSymbol=dr,f.isTypedArray=os,f.isUndefined=Fv,f.isWeakMap=Bv,f.isWeakSet=Gv,f.join=Qd,f.kebabCase=qy,f.last=xr,f.lastIndexOf=Yd,f.lowerCase=zy,f.lowerFirst=My,f.lt=Wv,f.lte=Jv,f.max=N0,f.maxBy=$0,f.mean=D0,f.meanBy=L0,f.min=q0,f.minBy=z0,f.stubArray=ko,f.stubFalse=Ko,f.stubObject=E0,f.stubString=I0,f.stubTrue=x0,f.multiply=M0,f.nth=Xd,f.noConflict=d0,f.noop=Ho,f.now=Wn,f.pad=jy,f.padEnd=Uy,f.padStart=Hy,f.parseInt=ky,f.random=Ay,f.reduce=tv,f.reduceRight=rv,f.repeat=Ky,f.replace=Vy,f.result=by,f.round=j0,f.runInContext=x,f.sample=sv,f.size=ov,f.snakeCase=Fy,f.some=cv,f.sortedIndex=ng,f.sortedIndexBy=ag,f.sortedIndexOf=og,f.sortedLastIndex=cg,f.sortedLastIndexBy=ug,f.sortedLastIndexOf=hg,f.startCase=Gy,f.startsWith=Wy,f.subtract=U0,f.sum=H0,f.sumBy=k0,f.template=Jy,f.times=P0,f.toFinite=ei,f.toInteger=ye,f.toLength=ph,f.toLower=Qy,f.toNumber=Pr,f.toSafeInteger=Qv,f.toString=qe,f.toUpper=Yy,f.trim=Xy,f.trimEnd=Zy,f.trimStart=e0,f.truncate=t0,f.unescape=r0,f.uniqueId=C0,f.upperCase=i0,f.upperFirst=zo,f.each=Zu,f.eachRight=eh,f.first=Ju,Uo(f,function(){var e={};return jr(f,function(t,s){Me.call(f.prototype,s)||(e[s]=t)}),e}(),{chain:!1}),f.VERSION=n,wr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),wr(["drop","take"],function(e,t){Pe.prototype[e]=function(s){s=s===r?1:qt(ye(s),0);var o=this.__filtered__&&!t?new Pe(this):this.clone();return o.__filtered__?o.__takeCount__=Ft(s,o.__takeCount__):o.__views__.push({size:Ft(s,B),type:e+(o.__dir__<0?"Right":"")}),o},Pe.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),wr(["filter","map","takeWhile"],function(e,t){var s=t+1,o=s==R||s==je;Pe.prototype[e]=function(h){var p=this.clone();return p.__iteratees__.push({iteratee:se(h,3),type:s}),p.__filtered__=p.__filtered__||o,p}}),wr(["head","last"],function(e,t){var s="take"+(t?"Right":"");Pe.prototype[e]=function(){return this[s](1).value()[0]}}),wr(["initial","tail"],function(e,t){var s="drop"+(t?"":"Right");Pe.prototype[e]=function(){return this.__filtered__?new Pe(this):this[s](1)}}),Pe.prototype.compact=function(){return this.filter(or)},Pe.prototype.find=function(e){return this.filter(e).head()},Pe.prototype.findLast=function(e){return this.reverse().find(e)},Pe.prototype.invokeMap=be(function(e,t){return typeof e=="function"?new Pe(this):this.map(function(s){return Ss(s,e,t)})}),Pe.prototype.reject=function(e){return this.filter(Qn(se(e)))},Pe.prototype.slice=function(e,t){e=ye(e);var s=this;return s.__filtered__&&(e>0||t<0)?new Pe(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),t!==r&&(t=ye(t),s=t<0?s.dropRight(-t):s.take(t-e)),s)},Pe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Pe.prototype.toArray=function(){return this.take(B)},jr(Pe.prototype,function(e,t){var s=/^(?:filter|find|map|reject)|While$/.test(t),o=/^(?:head|last)$/.test(t),h=f[o?"take"+(t=="last"?"Right":""):t],p=o||/^find/.test(t);h&&(f.prototype[t]=function(){var m=this.__wrapped__,_=o?[1]:arguments,P=m instanceof Pe,q=_[0],z=P||ge(m),H=function(Ie){var Ce=h.apply(f,hi([Ie],_));return o&&G?Ce[0]:Ce};z&&s&&typeof q=="function"&&q.length!=1&&(P=z=!1);var G=this.__chain__,ee=!!this.__actions__.length,ne=p&&!G,we=P&&!ee;if(!p&&z){m=we?m:new Pe(this);var ae=e.apply(m,_);return ae.__actions__.push({func:Bn,args:[H],thisArg:r}),new br(ae,G)}return ne&&we?e.apply(this,_):(ae=this.thru(H),ne?o?ae.value()[0]:ae.value():ae)})}),wr(["pop","push","shift","sort","splice","unshift"],function(e){var t=mn[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",o=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var h=arguments;if(o&&!this.__chain__){var p=this.value();return t.apply(ge(p)?p:[],h)}return this[s](function(m){return t.apply(ge(m)?m:[],h)})}}),jr(Pe.prototype,function(e,t){var s=f[t];if(s){var o=s.name+"";Me.call(rs,o)||(rs[o]=[]),rs[o].push({name:t,func:s})}}),rs[jn(r,ce).name]=[{name:"wrapper",func:r}],Pe.prototype.clone=rp,Pe.prototype.reverse=ip,Pe.prototype.value=sp,f.prototype.at=$g,f.prototype.chain=Dg,f.prototype.commit=Lg,f.prototype.next=qg,f.prototype.plant=Mg,f.prototype.reverse=jg,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=Ug,f.prototype.first=f.prototype.head,ws&&(f.prototype[ws]=zg),f},Zi=Lf();_t?((_t.exports=Zi)._=Zi,Be._=Zi):Se._=Zi}).call(js)})(fc,fc.exports);var Kb=Object.defineProperty,Vb=Object.defineProperties,Fb=Object.getOwnPropertyDescriptors,wl=Object.getOwnPropertySymbols,Bb=Object.prototype.hasOwnProperty,Gb=Object.prototype.propertyIsEnumerable,_l=(c,i,r)=>i in c?Kb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,na=(c,i)=>{for(var r in i||(i={}))Bb.call(i,r)&&_l(c,r,i[r]);if(wl)for(var r of wl(i))Gb.call(i,r)&&_l(c,r,i[r]);return c},Wb=(c,i)=>Vb(c,Fb(i));function Ei(c,i,r){var n;const a=Rm(c);return((n=i.rpcMap)==null?void 0:n[a.reference])||`${kb}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function ki(c){return c.includes(":")?c.split(":")[1]:c}function hf(c){return c.map(i=>`${i.split(":")[0]}:${i.split(":")[1]}`)}function Jb(c,i){const r=Object.keys(i.namespaces).filter(a=>a.includes(c));if(!r.length)return[];const n=[];return r.forEach(a=>{const l=i.namespaces[a].accounts;n.push(...l)}),n}function Qb(c={},i={}){const r=bl(c),n=bl(i);return fc.exports.merge(r,n)}function bl(c){var i,r,n,a;const l={};if(!ca(c))return l;for(const[d,y]of Object.entries(c)){const w=Dl(d)?[d]:y.chains,v=y.methods||[],E=y.events||[],C=y.rpcMap||{},T=Us(d);l[T]=Wb(na(na({},l[T]),y),{chains:Fo(w,(i=l[T])==null?void 0:i.chains),methods:Fo(v,(r=l[T])==null?void 0:r.methods),events:Fo(E,(n=l[T])==null?void 0:n.events),rpcMap:na(na({},C),(a=l[T])==null?void 0:a.rpcMap)})}return l}function Yb(c){return c.includes(":")?c.split(":")[2]:c}function Xb(c){const i={};for(const[r,n]of Object.entries(c)){const a=n.methods||[],l=n.events||[],d=n.accounts||[],y=Dl(r)?[r]:n.chains?n.chains:hf(n.accounts);i[r]={chains:y,methods:a,events:l,accounts:d}}return i}function ic(c){return typeof c=="number"?c:c.includes("0x")?parseInt(c,16):c.includes(":")?Number(c.split(":")[1]):Number(c)}const lf={},st=c=>lf[c],sc=(c,i)=>{lf[c]=i};class Zb{constructor(i){this.name="polkadot",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getAccounts(){const i=this.namespace.accounts;return i?i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=ki(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class eE{constructor(i){this.name="eip155",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(i){switch(i.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(i);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(i.request.method)?await this.client.request(i):this.getHttpProvider().request(i.request)}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(parseInt(i),r),this.chainId=parseInt(i),this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}createHttpProvider(i,r){const n=r||Ei(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=parseInt(ki(r));i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const i=this.chainId,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}async handleSwitchChain(i){var r,n;let a=i.request.params?(r=i.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const l=parseInt(a,16);if(this.isChainApproved(l))this.setDefaultChain(`${l}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:i.topic,request:{method:i.request.method,params:[{chainId:a}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${l}`);else throw new Error(`Failed to switch to chain 'eip155:${l}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(i){return this.namespace.chains.includes(`${this.name}:${i}`)}}class tE{constructor(i){this.name="solana",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=ki(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class rE{constructor(i){this.name="cosmos",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=ki(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class iE{constructor(i){this.name="cip34",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),a=ki(r);i[a]=this.createHttpProvider(a,n)}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}getCardanoRPCUrl(i){const r=this.namespace.rpcMap;if(r)return r[i]}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||this.getCardanoRPCUrl(i);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class sE{constructor(i){this.name="elrond",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=ki(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class nE{constructor(i){this.name="multiversx",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const a=ki(r);i[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);return new ni(new Ii(n,st("disableProviderPing")))}}class aE{constructor(i){this.name="near",this.namespace=i.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const n=r||Ei(`${this.name}:${i}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.events.emit(ai.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;i[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Ei(i,this.namespace);return typeof n>"u"?void 0:new ni(new Ii(n,st("disableProviderPing")))}}var oE=Object.defineProperty,cE=Object.defineProperties,uE=Object.getOwnPropertyDescriptors,El=Object.getOwnPropertySymbols,hE=Object.prototype.hasOwnProperty,lE=Object.prototype.propertyIsEnumerable,Il=(c,i,r)=>i in c?oE(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,aa=(c,i)=>{for(var r in i||(i={}))hE.call(i,r)&&Il(c,r,i[r]);if(El)for(var r of El(i))lE.call(i,r)&&Il(c,r,i[r]);return c},nc=(c,i)=>cE(c,uE(i));class Pc{constructor(i){this.events=new vc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=i,this.logger=typeof(i==null?void 0:i.logger)<"u"&&typeof(i==null?void 0:i.logger)!="string"?i.logger:Oe.pino(Oe.getDefaultLoggerOptions({level:(i==null?void 0:i.logger)||yl})),this.disableProviderPing=(i==null?void 0:i.disableProviderPing)||!1}static async init(i){const r=new Pc(i);return await r.initialize(),r}async request(i,r){const[n,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:aa({},i),chainId:`${n}:${a}`,topic:this.session.topic})}sendAsync(i,r,n){this.request(i,n).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var i;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(i=this.session)==null?void 0:i.topic,reason:tr("USER_DISCONNECTED")}),await this.cleanup()}async connect(i){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(i),await this.cleanupPendingPairings(),!i.skipPairing)return await this.pair(i.pairingTopic)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}removeListener(i,r){this.events.removeListener(i,r)}off(i,r){this.events.off(i,r)}get isWalletConnect(){return!0}async pair(i){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:a}=await this.client.connect({pairingTopic:i,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await a().then(l=>{this.session=l,this.namespaces||(this.namespaces=Xb(l.namespaces),this.persist("namespaces",this.namespaces))}).catch(l=>{if(l.message!==cf)throw l;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(i,r){try{if(!this.session)return;const[n,a]=this.validateChain(i);this.getProvider(n).setDefaultChain(a,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(i={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(fs(r)){for(const n of r)i.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const i=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[i]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Mb.init({logger:this.providerOpts.logger||yl,relayUrl:this.providerOpts.relayUrl||jb,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const i=[...new Set(Object.keys(this.session.namespaces).map(r=>Us(r)))];sc("client",this.client),sc("events",this.events),sc("disableProviderPing",this.disableProviderPing),i.forEach(r=>{if(!this.session)return;const n=Jb(r,this.session),a=hf(n),l=Qb(this.namespaces,this.optionalNamespaces),d=nc(aa({},l[r]),{accounts:n,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new eE({namespace:d});break;case"solana":this.rpcProviders[r]=new tE({namespace:d});break;case"cosmos":this.rpcProviders[r]=new rE({namespace:d});break;case"polkadot":this.rpcProviders[r]=new Zb({namespace:d});break;case"cip34":this.rpcProviders[r]=new iE({namespace:d});break;case"elrond":this.rpcProviders[r]=new sE({namespace:d});break;case"multiversx":this.rpcProviders[r]=new nE({namespace:d});break;case"near":this.rpcProviders[r]=new aE({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",i=>{this.events.emit("session_ping",i)}),this.client.on("session_event",i=>{const{params:r}=i,{event:n}=r;if(n.name==="accountsChanged"){const a=n.data;a&&fs(a)&&this.events.emit("accountsChanged",a.map(Yb))}else if(n.name==="chainChanged"){const a=r.chainId,l=r.event.data,d=Us(a),y=ic(a)!==ic(l)?`${d}:${ic(l)}`:a;this.onChainChanged(y)}else this.events.emit(n.name,n.data);this.events.emit("session_event",i)}),this.client.on("session_update",({topic:i,params:r})=>{var n;const{namespaces:a}=r,l=(n=this.client)==null?void 0:n.session.get(i);this.session=nc(aa({},l),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:i,params:r})}),this.client.on("session_delete",async i=>{await this.cleanup(),this.events.emit("session_delete",i),this.events.emit("disconnect",nc(aa({},tr("USER_DISCONNECTED")),{data:i.topic}))}),this.on(ai.DEFAULT_CHAIN_CHANGED,i=>{this.onChainChanged(i,!0)})}getProvider(i){if(!this.rpcProviders[i])throw new Error(`Provider not found: ${i}`);return this.rpcProviders[i]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(i=>{var r;this.getProvider(i).updateNamespace((r=this.session)==null?void 0:r.namespaces[i])})}setNamespaces(i){const{namespaces:r,optionalNamespaces:n,sessionProperties:a}=i;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(i){const[r,n]=(i==null?void 0:i.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(d=>Us(d)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const a=Us(Object.keys(this.namespaces)[0]),l=this.rpcProviders[a].getDefaultChain();return[a,l]}async requestAccounts(){const[i]=this.validateChain();return await this.getProvider(i).requestAccounts()}onChainChanged(i,r=!1){var n;if(!this.namespaces)return;const[a,l]=this.validateChain(i);r||this.getProvider(a).setDefaultChain(l),((n=this.namespaces[a])!=null?n:this.namespaces[`${a}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(i,r){this.client.core.storage.setItem(`${ml}/${i}`,r)}async getFromStore(i){return await this.client.core.storage.getItem(`${ml}/${i}`)}}const fE=Pc,pE="wc",dE="ethereum_provider",gE=`${pE}@2:${dE}:`,vE="https://rpc.walletconnect.com/v1/",pc=["eth_sendTransaction","personal_sign"],yE=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],dc=["chainChanged","accountsChanged"],mE=["chainChanged","accountsChanged","message","disconnect","connect"];var wE=Object.defineProperty,_E=Object.defineProperties,bE=Object.getOwnPropertyDescriptors,xl=Object.getOwnPropertySymbols,EE=Object.prototype.hasOwnProperty,IE=Object.prototype.propertyIsEnumerable,Pl=(c,i,r)=>i in c?wE(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,ks=(c,i)=>{for(var r in i||(i={}))EE.call(i,r)&&Pl(c,r,i[r]);if(xl)for(var r of xl(i))IE.call(i,r)&&Pl(c,r,i[r]);return c},Sl=(c,i)=>_E(c,bE(i));function da(c){return Number(c[0].split(":")[1])}function ac(c){return`0x${c.toString(16)}`}function xE(c){const{chains:i,optionalChains:r,methods:n,optionalMethods:a,events:l,optionalEvents:d,rpcMap:y}=c;if(!fs(i))throw new Error("Invalid chains");const w={chains:i,methods:n||pc,events:l||dc,rpcMap:ks({},i.length?{[da(i)]:y[da(i)]}:{})},v=l==null?void 0:l.filter(j=>!dc.includes(j)),E=n==null?void 0:n.filter(j=>!pc.includes(j));if(!r&&!d&&!a&&!(v!=null&&v.length)&&!(E!=null&&E.length))return{required:i.length?w:void 0};const C=(v==null?void 0:v.length)&&(E==null?void 0:E.length)||!r,T={chains:[...new Set(C?w.chains.concat(r||[]):r)],methods:[...new Set(w.methods.concat(a!=null&&a.length?a:yE))],events:[...new Set(w.events.concat(d!=null&&d.length?d:mE))],rpcMap:y};return{required:i.length?w:void 0,optional:r.length?T:void 0}}class Sc{constructor(){this.events=new Kr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=gE,this.on=(i,r)=>(this.events.on(i,r),this),this.once=(i,r)=>(this.events.once(i,r),this),this.removeListener=(i,r)=>(this.events.removeListener(i,r),this),this.off=(i,r)=>(this.events.off(i,r),this),this.parseAccount=i=>this.isCompatibleChainId(i)?this.parseAccountId(i).address:i,this.signer={},this.rpc={}}static async init(i){const r=new Sc;return await r.initialize(i),r}async request(i){return await this.signer.request(i,this.formatChainId(this.chainId))}sendAsync(i,r){this.signer.sendAsync(i,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(i){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(i);const{required:r,optional:n}=xE(this.rpc);try{const a=await new Promise(async(d,y)=>{var w;this.rpc.showQrModal&&((w=this.modal)==null||w.subscribeModal(v=>{!v.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),y(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Sl(ks({namespaces:ks({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:i==null?void 0:i.pairingTopic})).then(v=>{d(v)}).catch(v=>{y(new Error(v.message))})});if(!a)return;const l=Tm(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:l),this.setAccounts(l),this.events.emit("connect",{chainId:ac(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",i=>{const{params:r}=i,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",i)}),this.signer.on("chainChanged",i=>{const r=parseInt(i);this.chainId=r,this.events.emit("chainChanged",ac(this.chainId)),this.persist()}),this.signer.on("session_update",i=>{this.events.emit("session_update",i)}),this.signer.on("session_delete",i=>{this.reset(),this.events.emit("session_delete",i),this.events.emit("disconnect",Sl(ks({},tr("USER_DISCONNECTED")),{data:i.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",i=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:i})),this.events.emit("display_uri",i)})}switchEthereumChain(i){this.request({method:"wallet_switchEthereumChain",params:[{chainId:i.toString(16)}]})}isCompatibleChainId(i){return typeof i=="string"?i.startsWith(`${this.namespace}:`):!1}formatChainId(i){return`${this.namespace}:${i}`}parseChainId(i){return Number(i.split(":")[1])}setChainIds(i){const r=i.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",ac(this.chainId)),this.persist())}setChainId(i){if(this.isCompatibleChainId(i)){const r=this.parseChainId(i);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(i){const[r,n,a]=i.split(":");return{chainId:`${r}:${n}`,address:a}}setAccounts(i){this.accounts=i.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(i){var r,n;const a=(r=i==null?void 0:i.chains)!=null?r:[],l=(n=i==null?void 0:i.optionalChains)!=null?n:[],d=a.concat(l);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const y=a.length?(i==null?void 0:i.methods)||pc:[],w=a.length?(i==null?void 0:i.events)||dc:[],v=(i==null?void 0:i.optionalMethods)||[],E=(i==null?void 0:i.optionalEvents)||[],C=(i==null?void 0:i.rpcMap)||this.buildRpcMap(d,i.projectId),T=(i==null?void 0:i.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(j=>this.formatChainId(j)),optionalChains:l.map(j=>this.formatChainId(j)),methods:y,events:w,optionalMethods:v,optionalEvents:E,rpcMap:C,showQrModal:!!(i!=null&&i.showQrModal),qrModalOptions:T,projectId:i.projectId,metadata:i.metadata}}buildRpcMap(i,r){const n={};return i.forEach(a=>{n[a]=this.getRpcUrl(a,r)}),n}async initialize(i){if(this.rpc=this.getRpcConfig(i),this.chainId=this.rpc.chains.length?da(this.rpc.chains):da(this.rpc.optionalChains),this.signer=await fE.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:i.disableProviderPing,relayUrl:i.relayUrl,storageOptions:i.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await Am(()=>import("./index-3VXKPAHU.js").then(a=>a.i),__vite__mapDeps([0,1,2]));r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(ks({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(i){if(!i)return;const{chains:r,optionalChains:n,rpcMap:a}=i;r&&fs(r)&&(this.rpc.chains=r.map(l=>this.formatChainId(l)),r.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)})),n&&fs(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(l=>this.formatChainId(l)),n.forEach(l=>{this.rpc.rpcMap[l]=(a==null?void 0:a[l])||this.getRpcUrl(l)}))}getRpcUrl(i,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[i])||`${vE}?chainId=eip155:${i}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const i=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${i}`]?this.session.namespaces[`${this.namespace}:${i}`]:this.session.namespaces[this.namespace];this.setChainIds(i?[this.formatChainId(i)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(i){return typeof i=="string"||i instanceof String?[this.parseAccount(i)]:i.map(r=>this.parseAccount(r))}}const zE=Sc;export{zE as EthereumProvider,mE as OPTIONAL_EVENTS,yE as OPTIONAL_METHODS,dc as REQUIRED_EVENTS,pc as REQUIRED_METHODS,Sc as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-3VXKPAHU.js","assets/index-0aC6Xlgc.js","assets/index-bI5pgBhQ.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}